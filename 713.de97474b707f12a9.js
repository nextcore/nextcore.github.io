"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[713],{3713:(Ot,A,c)=>{c.r(A),c.d(A,{IdeModule:()=>Jt});var g=c(6895),H=c(1075),L=c(7832),I=c(9132),e=c(4650),E=c(3546),y=c(5861),W=c(7851),b=c(5423),M=c(6996),d=c(5938),F=c(3885),u=c(4006),x=c(4859),_=c(9549),C=c(4144),S=c(266);function G(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",10)(1,"span",11),e._uU(2),e.TgZ(3,"span",12),e._uU(4,"|"),e.qZA()(),e.TgZ(5,"input",13),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.value=o)}),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("matTooltip",t.description),e.xp6(1),e.hij(" ",t.name," "),e.xp6(3),e.Q6J("ngModel",t.value)}}function B(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",14)(1,"span",15),e._uU(2),e.TgZ(3,"span",12),e._uU(4,"|"),e.qZA()(),e.TgZ(5,"textarea",16),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw().$implicit;return e.KtG(a.value=o)}),e._uU(6,"      "),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("matTooltip",t.description),e.xp6(1),e.hij(" ",t.name," "),e.xp6(3),e.Q6J("ngModel",t.value)}}function K(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,G,6,3,"mat-form-field",8),e.YNc(2,B,7,3,"mat-form-field",9),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf","string"===t.type),e.xp6(1),e.Q6J("ngIf","multi_string"===t.type)}}let N=(()=>{class i{constructor(t,n,o){this.generalService=t,this.dialogRef=n,this.data=o;for(const a of this.data.arguments)!a.value&&a.default&&(a.value=a.default)}differentMacro(){delete this.data.name,this.dialogRef.close(this.data)}execute(){this.canExecute()?this.dialogRef.close(this.data):this.generalService.showFeedback("Please provide the necessary details.","errorMessage")}canExecute(){return 0===this.data.arguments.filter(t=>t.mandatory&&!t.value).length}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(F.m),e.Y36(d.so),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-execute-macro-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"text-muted"],[4,"ngFor","ngForOf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],["class","w-100 prefix-alignment",4,"ngIf"],["class","w-100 prefix-alignment custom-fields",4,"ngIf"],[1,"w-100","prefix-alignment"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2",3,"matTooltip"],[1,"text-muted","ms-1"],["type","text","matInput","","autocomplete","off",3,"ngModel","ngModelChange"],[1,"w-100","prefix-alignment","custom-fields"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2","mt-2",3,"matTooltip"],["matInput","","rows","4","autocomplete","off",3,"ngModel","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"p",2),e._uU(4),e.qZA(),e.YNc(5,K,3,2,"div",3),e.qZA(),e.TgZ(6,"div",4)(7,"button",5),e._uU(8," Close "),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return n.differentMacro()}),e._uU(10," Change macro "),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return n.execute()}),e._uU(12," Execute "),e.qZA()()),2&t&&(e.xp6(1),e.Oqu(n.data.name),e.xp6(3),e.Oqu(n.data.description),e.xp6(1),e.Q6J("ngForOf",n.data.arguments),e.xp6(1),e.Q6J("align","end"))},dependencies:[g.sg,g.O5,u.Fj,u.JJ,u.On,x.lW,_.KE,_.qo,C.Nt,d.ZT,d.uh,d.xY,d.H8,S.gM],styles:[".description[_ngcontent-%COMP%]{color:gray;font-size:1rem;margin-top:.5rem;margin-bottom:2rem;font-style:italic}.half-width[_ngcontent-%COMP%]{width:calc(50% - 1rem);float:left;margin-right:1rem}.fill-width[_ngcontent-%COMP%]{width:calc(100% - 1rem)}  .custom-fields .mat-form-field-flex{align-items:flex-start}"]}),i})();const $=function(){return{unzip:!0}};function z(i,s){1&i&&(e.TgZ(0,"button",5),e._uU(1," Unzip "),e.qZA()),2&i&&e.Q6J("mat-dialog-close",e.DdM(1,$))}const V=function(){return{deleteFile:!0}},X=function(){return{download:!0}};let J=(()=>{class i{constructor(t){this.data=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-incompatible-file-dialog"]],decls:13,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold","mb-4"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close",4,"ngIf"],["mat-flat-button","","color","primary",3,"mat-dialog-close"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"p",2),e._uU(4,"This file cannot be opened. Please choose what to do with this file."),e.qZA()(),e.TgZ(5,"div",3)(6,"button",4),e._uU(7," Cancel "),e.qZA(),e.TgZ(8,"button",5),e._uU(9," Delete "),e.qZA(),e.YNc(10,z,2,2,"button",6),e.TgZ(11,"button",7),e._uU(12," Download "),e.qZA()()),2&t&&(e.xp6(1),e.Oqu(null==n.data?null:n.data.name),e.xp6(4),e.Q6J("align","end"),e.xp6(3),e.Q6J("mat-dialog-close",e.DdM(5,V)),e.xp6(2),e.Q6J("ngIf",null==n.data||null==n.data.name?null:n.data.name.endsWith(".zip")),e.xp6(1),e.Q6J("mat-dialog-close",e.DdM(6,X)))},dependencies:[g.O5,x.lW,d.ZT,d.uh,d.xY,d.H8],encapsulation:2}),i})();var Z=c(9214),T=c(7392),O=c(6709),ee=c(4385),te=c(3238);const ne=["fileName"];function ie(i,s){if(1&i&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function oe(i,s){if(1&i&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&i){const t=s.$implicit,n=e.oxw(2);e.Q6J("value",t),e.xp6(1),e.hij(" ",n.getFileName(t.name)," ")}}function ae(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",2)(1,"span",3)(2,"mat-icon"),e._uU(3,"list"),e.qZA(),e.TgZ(4,"span",4),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"mat-select",14),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.activeTemplate=o)})("selectionChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.templateChanged())}),e.YNc(7,oe,2,2,"mat-option",6),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.activeTemplate),e.xp6(1),e.Q6J("ngForOf",t.getTemplates())}}function re(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-checkbox",15),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.filterTemplates=o)}),e._uU(1," Filter "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("ngModel",t.filterTemplates)}}let se=(()=>{class i{constructor(t,n,o){this.fileService=t,this.generalService=n,this.data=o,this.templates=[],this.activeTemplate=null,this.filterTemplates=!0}ngOnInit(){this.data.isFolder||(this.generalService.showLoading(),this.fileService.listFiles("/misc/ide/templates/").subscribe({next:t=>{this.generalService.hideLoading(),this.templates=t.map(n=>({name:n}))},error:t=>{this.generalService.hideLoading(),this.generalService.showFeedback(t?.error?.message??t,"errorMessage")}}))}getFileName(t){return t.substring(t.lastIndexOf("/")+1)}getTemplates(){if(!this.filterTemplates)return this.templates;{const t=this.data.path.split("/");let n=this.templates.filter(r=>r.name.endsWith(".md"));t.length>=4&&"modules"===t[1]&&0===t.filter(r=>-1!==r.indexOf(".")).length&&(n=n.concat(this.templates.filter(r=>r.name.endsWith(".delete.hl")||r.name.endsWith(".post.hl")||r.name.endsWith(".put.hl")||r.name.endsWith(".get.hl")||r.name.endsWith(".patch.hl")||r.name.endsWith(".socket.hl"))));const a=t.length>=4&&"modules"===t[1]&&0!==t.filter(r=>"magic.startup"===r).length;return a&&0===t.filter(r=>"db-migrations"===r).length&&(n=n.concat(this.templates.filter(r=>r.name.endsWith("/acme.foo.bar.hl"))),n=n.concat(this.templates.filter(r=>r.name.endsWith(".mssql.sql")||r.name.endsWith(".mysql.sql"))),n=n.concat(this.templates.filter(r=>r.name.endsWith("/create-database.hl")))),a&&2===t.filter(r=>"db-migrations"===r||"mysql"===r).length&&(n=n.concat(this.templates.filter(r=>r.name.endsWith("0001-migrate-foo_bar-mysql-database.sql")))),a&&2===t.filter(r=>"db-migrations"===r||"pgsql"===r).length&&(n=n.concat(this.templates.filter(r=>r.name.endsWith("0001-migrate-foo_bar-mysql-database.sql")))),a&&2===t.filter(r=>"db-migrations"===r||"mssql"===r).length&&(n=n.concat(this.templates.filter(r=>r.name.endsWith("0001-migrate-foo_bar-mssql-database.sql")))),n}}templateChanged(){this.fileService.loadFile(this.activeTemplate.name).subscribe({next:t=>{this.data.template=t,this.data.name=this.activeTemplate.name.substring(this.activeTemplate.name.lastIndexOf("/")+1),this.fileName.nativeElement.focus()},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}pathValid(){if(!this.data.name||0===this.data.name.length)return!1;for(const t of this.data.name)if(-1==="abcdefghijklmnopqrstuvwxyz0123456789_-.".indexOf(t.toLowerCase()))return!1;return this.data.isFolder?0===this.data.folders.filter(t=>t.toLowerCase()===this.data.path+this.data.name.toLowerCase()+"/").length:0===this.data.files.filter(t=>t.toLowerCase()===this.data.path+this.data.name.toLowerCase()).length}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.I),e.Y36(F.m),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-new-file-folder-dialog"]],viewQuery:function(t,n){if(1&t&&e.Gf(ne,5),2&t){let o;e.iGM(o=e.CRH())&&(n.fileName=o.first)}},decls:25,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-100","standalone-field"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["name","path","placeholder","Folder name",1,"dark",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","w-100 standalone-field",4,"ngIf"],["type","text","matInput","","autocomplete","off","name","name","cdkFocusInitial","",3,"placeholder","ngModel","ngModelChange"],["fileName",""],["mat-dialog-actions","",3,"align"],["color","primary","name","filterTemplates","matTooltip","Apply 'intelligent' filtering of templates","class","margin-right",3,"ngModel","ngModelChange",4,"ngIf"],["mat-flat-button","","color","primary","type","submit",3,"disabled","mat-dialog-close"],[3,"value"],["name","activeTemplate","placeholder","Template",1,"dark",3,"ngModel","ngModelChange","selectionChange"],["color","primary","name","filterTemplates","matTooltip","Apply 'intelligent' filtering of templates",1,"margin-right",3,"ngModel","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"form")(3,"div",1)(4,"mat-form-field",2)(5,"span",3)(6,"mat-icon"),e._uU(7,"folder"),e.qZA(),e.TgZ(8,"span",4),e._uU(9,"|"),e.qZA()(),e.TgZ(10,"mat-select",5),e.NdJ("ngModelChange",function(a){return n.data.path=a}),e.YNc(11,ie,2,2,"mat-option",6),e.qZA()(),e.YNc(12,ae,8,2,"mat-form-field",7),e.TgZ(13,"mat-form-field",2)(14,"span",3)(15,"mat-icon"),e._uU(16,"edit"),e.qZA(),e.TgZ(17,"span",4),e._uU(18,"|"),e.qZA()(),e.TgZ(19,"input",8,9),e.NdJ("ngModelChange",function(a){return n.data.name=a}),e.qZA()()(),e.TgZ(21,"div",10),e.YNc(22,re,2,1,"mat-checkbox",11),e.TgZ(23,"button",12),e._uU(24," Create "),e.qZA()()()),2&t&&(e.xp6(1),e.hij("New ",null==n.data?null:n.data.type,""),e.xp6(9),e.Q6J("ngModel",n.data.path),e.xp6(1),e.Q6J("ngForOf",n.data.folders),e.xp6(1),e.Q6J("ngIf",n.templates.length>0&&"file"===n.data.type),e.xp6(7),e.Q6J("placeholder","file"===n.data.type?"Filename":"Folder name")("ngModel",n.data.name),e.xp6(2),e.Q6J("align","end"),e.xp6(1),e.Q6J("ngIf","file"===(null==n.data?null:n.data.type)),e.xp6(1),e.Q6J("disabled",!n.pathValid())("mat-dialog-close",n.data))},dependencies:[g.sg,g.O5,u._Y,u.Fj,u.JJ,u.JL,u.On,u.F,T.Hw,x.lW,_.KE,_.qo,C.Nt,O.oG,d.ZT,d.uh,d.xY,d.H8,S.gM,ee.gD,te.ey],styles:[".margin-right[_ngcontent-%COMP%]{margin-right:.5rem}"]}),i})();var q=c(6338);function le(i,s){if(1&i&&(e.TgZ(0,"mat-list-option",7),e._uU(1),e.qZA()),2&i){const t=s.$implicit,n=e.oxw();e.Q6J("value",t),e.xp6(1),e.hij(" ",n.getMacroName(t)," ")}}let U=(()=>{class i{constructor(t,n,o,a){this.fileService=t,this.generalService=n,this.dialogRef=o,this.data=a,this.macros=[]}ngOnInit(){this.fileService.listFiles("/misc/ide/macros/",".hl").subscribe({next:t=>{this.macros=t},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}getMacroName(t){let n=t.substring(t.lastIndexOf("/")+1);for(n=n.substring(0,n.lastIndexOf("."));-1!==n.indexOf("-");)n=n.replace("-"," ");return n.substring(0,1).toUpperCase()+n.substring(1)}selectMacro(t){this.data.name=t,this.dialogRef.close(this.data)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Z.I),e.Y36(F.m),e.Y36(d.so),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-select-macro-dialog"]],decls:9,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["dense","",3,"multiple","selectionChange"],["macro",""],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close","","tabindex","-1"],[3,"value"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"h3",0),e._uU(1,"Select macro"),e.qZA(),e.TgZ(2,"div",1)(3,"mat-selection-list",2,3),e.NdJ("selectionChange",function(){e.CHM(o);const r=e.MAs(4);return e.KtG(n.selectMacro(null==r.selectedOptions.selected[0]?null:r.selectedOptions.selected[0].value))}),e.YNc(5,le,2,2,"mat-list-option",4),e.qZA()(),e.TgZ(6,"div",5)(7,"button",6),e._uU(8," Close "),e.qZA()()}2&t&&(e.xp6(3),e.Q6J("multiple",!1),e.xp6(2),e.Q6J("ngForOf",n.macros),e.xp6(1),e.Q6J("align","end"))},dependencies:[g.sg,x.lW,q.Ub,q.vS,d.ZT,d.uh,d.xY,d.H8],styles:[".macros[_ngcontent-%COMP%]{padding:0}.macros[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;padding:.5rem;cursor:pointer}.macros[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover, .macros[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:active{background-color:#0000001a}"]}),i})();class w{static parentFolder(s){let t=s.path;return s.isFolder&&(t=t.substring(0,s.path.length-1)),t.substring(0,t.lastIndexOf("/")+1)}static parentFolderFromPath(s){return s.endsWith("/")&&(s=s.substring(0,s.length-1)),s.substring(0,s.lastIndexOf("/")+1)}}var Q=c(6463),P=c(8588),D=c(7084);function ce(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",34)(1,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.showRenameInput(o.node))}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.deleteFile(o.node.path))}),e.TgZ(5,"mat-icon"),e._uU(6,"close"),e.qZA()()()}}function de(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-tree-node",29)(1,"div")(2,"button",30),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return r.openFile(a.node),e.KtG(r.currentSelection="file")}),e.TgZ(3,"mat-icon"),e._uU(4,"insert_drive_file"),e.qZA(),e._uU(5),e.qZA()(),e.TgZ(6,"span")(7,"input",31,32),e.NdJ("keyup.enter",function(){const a=e.CHM(t).$implicit,r=e.MAs(8),l=e.oxw();return e.KtG(l.renameFile({file:a.node,newName:null==r?null:r.value}))})("keyup.esc",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRenameBox=null)}),e.qZA()(),e.YNc(9,ce,7,0,"div",33),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("text-danger",t.node.systemFile)("active-file",(null==n.currentFileData?null:n.currentFileData.path)===t.node.path)("d-none",n.filterLeafNode(t,n.searchKey)),e.Q6J("matTreeNodePaddingIndent",10),e.xp6(1),e.Gre("w-100 h-100 flex-nowrap align-items-center d-",n.showRenameBox===t.node?"none":"flex",""),e.xp6(4),e.hij("",t.name," "),e.xp6(1),e.Gre("d-",n.showRenameBox===t.node?"flex":"none"," rename-box"),e.xp6(1),e.Q6J("value",t.name)("id",n.showRenameBox===t.node?"renameFile":""),e.xp6(2),e.Q6J("ngIf",null===n.showRenameBox)}}function pe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",34)(1,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.showRenameInput(o.node))}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw();return e.KtG(a.deleteFolder(o.node.path))}),e.TgZ(5,"mat-icon"),e._uU(6,"close"),e.qZA()()()}}function me(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-tree-node",37)(1,"div")(2,"button",38)(3,"mat-icon",39),e._uU(4),e.qZA(),e.TgZ(5,"mat-icon",39),e._uU(6),e.qZA()(),e.TgZ(7,"button",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return r.selectFolder(a),r.treeControl.expand(a),e.KtG(r.currentSelection="folder")}),e._uU(8),e.qZA()(),e.TgZ(9,"span")(10,"input",31,41),e.NdJ("keyup.enter",function(){const a=e.CHM(t).$implicit,r=e.MAs(11),l=e.oxw();return e.KtG(l.renameFolder({folder:a.node.path,newName:null==r?null:r.value}))})("keyup.esc",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRenameBox=null)}),e.qZA()(),e.YNc(12,pe,7,0,"div",33),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active-folder",n.activeFolder===t.node.path)("text-danger",t.node.systemFile)("d-none",n.filterParentNode(t,n.searchKey)),e.xp6(1),e.Gre("w-100 h-100 flex-nowrap align-items-center d-",n.showRenameBox===t.node?"none":"flex",""),e.xp6(1),e.Q6J("matTooltip",t.node.systemFile?"Do not modify unless you know what you're doing":""),e.xp6(2),e.hij(" ",n.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),e.xp6(2),e.hij(" ",n.treeControl.isExpanded(t)?"folder_open":"folder"," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(1),e.Gre("d-",n.showRenameBox===t.node?"flex":"none"," rename-box"),e.xp6(1),e.Q6J("value",t.name)("id",n.showRenameBox===t.node?"renameFile":""),e.xp6(2),e.Q6J("ngIf",null===n.showRenameBox)}}function ue(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.openFile(a))}),e.TgZ(1,"button",43),e._uU(2),e.qZA(),e.TgZ(3,"button",44),e.NdJ("click",function(){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.closeFile(a.path))}),e.TgZ(4,"mat-icon"),e._uU(5,"close"),e.qZA()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active-file",n.currentFileData.path===t.path),e.Q6J("id",n.currentFileData.name===t.name?"active":"")("title",t.path),e.xp6(2),e.hij(" ",t.name," ")}}function he(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRenameBox=null)}),e.qZA()}}let ge=(()=>{class i{constructor(t,n,o,a,r){this.dialog=t,this.fileService=n,this.generalService=o,this.endpointService=a,this.codemirrorActionsService=r,this.root={name:"",path:"/",isFolder:!0,children:[],level:0,systemFile:!1},this.showEditor=new e.vpe,this.clearEditorHistory=new e.vpe,this.setFocusToActiveEditor=new e.vpe,this.systemFiles=!1,this.treeControl=new W.C2(l=>l.level,l=>l.expandable),this.dataSource=new b.kc(this.treeControl,_e),this.openFiles=[],this.activeFolder="/",this.showRenameBox=null,this.currentSelection=""}ngOnInit(){this.generalService.showLoading(),this.getFilesFromServer().then(t=>{!0===t&&(this.dataSource.data=this.root.children,this.getEndpoints())})}getFilesFromServer(t="/"){return new Promise(n=>{const o=(a,r)=>{for(const l of a){const p=l.split("/").filter(f=>""!==f);let m=this.root,h=1;for(const f of p.slice(0,-1))m=m.children.filter(v=>v.name===f)[0],h+=1;m.children.push({name:p[p.length-1],path:l,isFolder:r,level:h,children:[],systemFile:this.isSystemPath(l)})}};this.fileService.listFoldersRecursively(t,this.systemFiles).subscribe({next:a=>{o(a||[],!0),this.fileService.listFilesRecursively(t,this.systemFiles).subscribe({next:r=>{o(r||[],!1),n(!0)},error:r=>this.generalService.showFeedback(r?.error?.message??r,"errorMessage","Ok",4e3)})},error:a=>{n(!1),this.generalService.showFeedback(a?.error?.message??a,"errorMessage")}})})}selectMacro(){this.dialog.open(U,{width:"550px",data:{name:""}}).afterClosed().subscribe(n=>{n&&this.executeMacro(n.name)})}openFile(t){const n=this.openFiles.filter(o=>o.path===t.path).pop();if(n)this.currentFileData=n,this.showEditor.emit({currentFileData:this.currentFileData});else{const o=this.getCodeMirrorOptions(t.path);if(null===o)return void this.dialog.open(J,{width:"550px",data:{name:t.name}}).afterClosed().subscribe(r=>{r&&r.download?this.downloadActiveFile(t.path):r&&r.deleteFile?this.deleteFile(t.path,!1):r&&r.unzip&&this.fileService.unzip(t.path).subscribe({next:()=>{this.updateFileObject(w.parentFolder(t))},error:l=>this.generalService.showFeedback(l?.error?.message??l,"errorMessage")})});this.fileService.loadFile(t.path).subscribe({next:a=>{this.openFiles.push({name:t.name,path:t.path,folder:t.path.substring(0,t.path.lastIndexOf("/")+1),content:a,options:o}),this.currentFileData=this.openFiles.filter(r=>r.path===t.path)[0],this.showEditor.emit({currentFileData:this.currentFileData}),setTimeout(()=>{this.scrollToLastOpenFile(),this.clearEditorHistory.emit(!0)},1)},error:a=>this.generalService.showFeedback(a?.error?.message??a,"errorMessage")})}this.activeFolder=w.parentFolder(t)}deleteActiveFile(){this.deleteFile(this.currentFileData.path)}deleteFile(t,n=!0){const o=()=>{this.fileService.deleteFile(t).subscribe({next:()=>{this.updateFileObject(w.parentFolderFromPath(t)),this.currentFileData?.path===t&&this.closeFile(t);const a=this.openFiles.findIndex(r=>r.path===t);-1!==a&&this.openFiles.splice(a,1),this.generalService.showFeedback("File was deleted successfully","successMessage")},error:a=>this.generalService.showFeedback(a?.error?.message??a,"errorMessage")})};!1===n?o():this.dialog.open(M.z,{width:"500px",data:{title:"Confirm operation",description_extra:`This operation is permanent, please confirm you wish to delete;<br/><span class="fw-bold">${t}</span>`,action_btn:"Delete",action_btn_color:"warn",bold_description:!0}}).afterClosed().subscribe(a=>{"confirm"===a&&o()})}deleteActiveFolder(){this.deleteFolder(this.activeFolder)}deleteFolder(t){this.isSystemFolder(t)?this.generalService.showFeedback("You cannot delete system folders","errorMessage","Ok",3e3):this.dialog.open(M.z,{width:"500px",data:{title:"Delete entire folder",description_extra:`You are deleting the following folder: <br/> <span class="fw-bold">${t}</span> <br/><br/> Do you want to continue?`,action_btn:"Delete",action_btn_color:"warn",bold_description:!0}}).afterClosed().subscribe(n=>{"confirm"===n&&this.fileService.deleteFolder(t).subscribe({next:()=>{this.updateFileObject(w.parentFolderFromPath(t)),this.activeFolder=w.parentFolderFromPath(t),this.currentFileData?.folder.startsWith(t)&&this.closeFile(this.currentFileData.path),this.dataBindTree(),this.generalService.showFeedback("Folder successfully deleted","successMessage")},error:o=>this.generalService.showFeedback(o?.error?.message??o,"errorMessage")})})}dataBindTree(){const t=[];for(const n of this.treeControl.dataNodes)this.treeControl.isExpanded(n)&&(t.push(n),t.push(this.openFolder));this.dataSource.data=this.root.children;for(const n of this.treeControl.dataNodes)t.filter(o=>o?.node?.path===n.node.path).length>0&&this.treeControl.expand(n)}closeFile(t){this.openFiles=this.openFiles.filter(n=>n.path!==t),this.currentFileData.path===t&&(this.currentFileData=this.openFiles.length>0?this.openFiles[this.openFiles.length-1]:null,this.scrollToLastOpenFile(),this.showEditor.emit({currentFileData:this.currentFileData}),this.setFocusToActiveEditor.emit())}showRenameInput(t){this.showRenameBox=t,setTimeout(()=>{document.querySelector("#renameFile").focus()},10)}renameFile(t){this.nameValidation(t.newName)?this.fileService.rename(t.file.path,t.newName).subscribe({next:()=>{const n=this.findTreeNodeFolder(this.root,t.file.path),o=this.openFiles.filter(r=>r.path==t.file.path).pop(),a=t.file.path.substring(0,t.file.path.lastIndexOf("/")+1)+t.newName;o&&(o.path=a,o.name=t.newName,this.currentFileData?.path===t.file.path&&(this.currentFileData.path=a,this.currentFileData.name=t.newName,this.showEditor.emit({currentFileData:this.currentFileData}))),n.name=t.newName,n.path=a,this.dataBindTree(),this.getEndpoints(),this.showRenameBox=null,this.generalService.showFeedback("File successfully renamed","successMessage")},error:n=>this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}):this.generalService.showFeedback(`${t.newName} is not an aceptable filename`)}renameFolder(t){if(!this.nameValidation(t.newName))return void this.generalService.showFeedback("Invalid characters","errorMessage");const n=w.parentFolderFromPath(t.folder)+t.newName+"/";this.fileService.rename(t.folder,n).subscribe({next:()=>{for(const o of this.openFiles.filter(a=>a.folder.startsWith(t.folder)))o.folder=n+o.folder.substring(t.folder.length),o.path=n+o.path.substring(t.folder.length);this.activeFolder.startsWith(t.folder)&&(this.activeFolder=n+this.activeFolder.substring(t.folder.length)),this.showRenameBox=null,this.updateFileObject(w.parentFolderFromPath(t.folder)),this.generalService.showFeedback("Folder successfully renamed","successMessage")},error:o=>this.generalService.showFeedback(o?.error?.message??o,"errorMessage")})}createNewFileObject(t){const n=this.getFolders(),o=this.getFiles();this.dialog.open(se,{width:"550px",data:{isFolder:"folder"===t,name:"",path:this.activeFolder,folders:n,files:o,type:t}}).afterClosed().subscribe(r=>{if(r){let l=r.path+r.name;"folder"===t?(l+="/",this.fileService.createFolder(l).subscribe({next:()=>{this.generalService.showFeedback("Folder successfully created","successMessage"),this.sort({dialogResult:r,objectPath:l})},error:p=>this.generalService.showFeedback(p?.error?.message??p,"errorMessage")})):this.fileService.saveFile(l,"").subscribe({next:()=>{this.generalService.showFeedback("File successfully created","successMessage"),this.sort({dialogResult:r,objectPath:l})},error:p=>this.generalService.showFeedback(p?.error?.message??p,"errorMessage")})}})}downloadActiveFile(t){!t&&this.currentFileData&&this.fileService.downloadFile(this.currentFileData.path),t&&this.fileService.downloadFile(t)}downloadFolder(){this.activeFolder&&this.fileService.downloadFolder(this.activeFolder)}selectFolder(t){this.activeFolder=t.node.path,this.openFolder=t}uploadFiles(t){this.generalService.showLoading();for(let n=0;n<t.length;n++)this.fileService.uploadFile(this.activeFolder,t.item(n)).subscribe({next:()=>{this.generalService.hideLoading(),this.generalService.showFeedback("File was successfully uploaded","successMessage"),this.fileInput=null,n===t.length-1&&this.updateFileObject(this.activeFolder)},error:o=>{this.generalService.hideLoading(),this.generalService.showFeedback(o?.error?.message??o,"errorMessage")}})}updateFileObject(t){var n=this;let o=t,a=!1;t.endsWith("/")||(o=o.substring(0,o.lastIndexOf("/")+1),a=!0);let r=this.root;const l=o.split("/").filter(p=>""!==p);for(const p of l.slice(0,l.length))r=r.children.filter(m=>m.name===p)[0];r.children=[],this.generalService.showLoading(),this.getFilesFromServer(o).then(p=>{var m;p&&(a?this.fileService.loadFile(t).subscribe({next:(m=(0,y.Z)(function*(h){n.generalService.hideLoading(),null!==n.getCodeMirrorOptions(t)&&(n.openFiles.push({name:t.substring(t.lastIndexOf("/")+1),path:t,folder:t.substring(0,t.lastIndexOf("/")+1),content:h,options:n.getCodeMirrorOptions(t)}),n.currentFileData=n.openFiles.filter(f=>f.path===t)[0],n.showEditor.emit({currentFileData:n.currentFileData}),n.setFocusToActiveEditor.emit()),null!==n.getCodeMirrorOptions(t)||n.dialog.open(J,{width:"550px",data:{name:t.substring(t.lastIndexOf("/")+1)}}).afterClosed().subscribe(function(){var f=(0,y.Z)(function*(v){const k={name:t.substring(t.lastIndexOf("/")+1),path:t,folder:t.substring(0,t.lastIndexOf("/")+1),content:h,options:n.getCodeMirrorOptions(t)};v&&v.download?n.downloadActiveFile(t):v&&v.deleteFile&&n.deleteFile(k,!1)});return function(v){return f.apply(this,arguments)}}())}),function(f){return m.apply(this,arguments)}),error:m=>{this.generalService.hideLoading(),this.generalService.showFeedback(m?.error?.message??m,"errorMessage")}}):(this.dataBindTree(),this.getEndpoints()))})}isExpandable(t,n){return n.expandable}filterLeafNode(t,n){return!!n&&-1===t.node.path.toLowerCase().indexOf(n?.toLowerCase())}filterParentNode(t,n){return!(!n||-1!==t.node.path.toLowerCase().indexOf(n?.toLowerCase())||this.treeControl.getDescendants(t).some(a=>-1!==a.node.path.toLowerCase().indexOf(n?.toLowerCase())))}installModule(t){"zip"===t[0].name.split(".")[1]?(this.generalService.showLoading(),this.fileService.installModule(t.item(0)).subscribe({next:()=>{this.generalService.hideLoading(),this.generalService.showFeedback("File was successfully uploaded","successMessage"),this.zipFileInput=null,this.updateFileObject("/modules/")},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n)}})):this.generalService.showFeedback("Only zip files without . are accepted","errorMessage","Ok",5e3)}getFolders(t=this.root){const n=[];t.isFolder&&n.push(t.path);for(const o of t.children.filter(a=>a.isFolder)){const a=this.getFolders(o);for(const r of a)n.push(r)}return n}getFiles(t=this.root){let n=[];for(const o of t.children.filter(a=>!a.isFolder))n.push(o.path);for(const o of t.children.filter(a=>a.isFolder))n=n.concat(this.getFiles(o));return n}sort(t){const n=this.findTreeNodeFolder(this.root,t.dialogResult.path),o=()=>{n.children.sort((a,r)=>{if(a.isFolder&&!r.isFolder)return-1;if(!a.isFolder&&r.isFolder)return 1;const l=a.path.toLowerCase(),p=r.path.toLowerCase();return l<p?-1:l>p?1:0})};t.dialogResult.isFolder?(n.children.push({name:t.dialogResult.name,path:t.objectPath,isFolder:!0,level:t.dialogResult.path.split("/").filter(a=>""!==a).length+1,children:[],systemFile:this.isSystemPath(t.objectPath)}),o(),this.dataBindTree()):(n.children.push({name:t.dialogResult.name,path:t.objectPath,isFolder:!1,level:t.dialogResult.path.split("/").filter(a=>""!==a).length+1,children:[],systemFile:this.isSystemPath(t.objectPath)}),o(),this.dataBindTree(),this.getEndpoints(),this.updateFileObject(t.objectPath))}findTreeNodeFolder(t,n){if(t.path===n)return t;for(const o of t.children){const a=this.findTreeNodeFolder(o,n);if(a)return a}return null}executeMacro(t){this.generalService.showLoading(),this.fileService.getMacroDefinition(t).subscribe({next:n=>{this.generalService.hideLoading();const o=this.activeFolder.split("/");if(4===o.length&&"modules"===o[1]){const l=n.arguments.filter(p=>"module"===p.name||"database"===p.name);if(l.length>0)for(const p of l)p.value=o[2]}const a=n.arguments.filter(l=>"auth"===l.name);if(a.length>0)for(const l of a)l.value="root";this.dialog.open(N,{width:"500px",data:n}).afterClosed().subscribe(l=>{if(l&&l.name){const p={};for(const m of l.arguments.filter(h=>h.value))p[m.name]=m.value;this.generalService.showLoading(),this.fileService.executeMacro(t,p).subscribe({next:m=>{if(this.generalService.hideLoading(),this.generalService.showFeedback("Macro successfully executed","successMessage"),"folders-changed"===m.result)this.dialog.open(M.z,{width:"500px",data:{title:"Refresh folders",description_extra:"Macro execution changed your file system, do you want to refresh your files and folders?",action_btn:"Refresh",action_btn_color:"primary",bold_description:!0}}).afterClosed().subscribe(f=>{"confirm"===f&&this.getFilesFromServer().then()});else if(m.result.startsWith("folders-changed|")){var h=m.result.split("|")[1];this.updateFileObject(h)}},error:m=>{this.generalService.hideLoading(),this.generalService.showFeedback(m?.error?.message??m,"errorMessage")}})}else l&&this.selectMacro()})},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}})}getEndpoints(){this.generalService.showLoading(),this.endpointService.endpoints().subscribe({next:t=>{this.generalService.hideLoading(),this.endpoints=t},error:t=>{this.generalService.hideLoading(),this.generalService.showFeedback(t?.error?.message??t,"errorMessage")}})}nameValidation(t){if(!t||0===t.length)return!1;for(const n of t)if(-1==="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_-.".indexOf(n.toLowerCase()))return!1;return!0}getCodeMirrorOptions(t){return this.codemirrorActionsService.getActions(t)}scrollToLastOpenFile(){const t=document.getElementById("active");t&&t.scrollIntoView()}isSystemPath(t){return t.startsWith("/system/")||t.startsWith("/misc/")||t.startsWith("/data/")||t.startsWith("/config/")}isSystemFolder(t){return"/"===t||"/system/"===t||"/modules/"===t||"/data/"===t||"/config/"===t||"/etc/"===t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.uw),e.Y36(Z.I),e.Y36(F.m),e.Y36(Q.B),e.Y36(P.C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-ide-tree"]],inputs:{searchKey:"searchKey"},outputs:{showEditor:"showEditor",clearEditorHistory:"clearEditorHistory",setFocusToActiveEditor:"setFocusToActiveEditor"},decls:46,vars:9,consts:[["id","tree",1,"w-100","d-flex","flex-column","h-100"],[1,"max-height","panel-1"],["displayMode","flat","multi","",1,"h-100"],["container",""],["expanded","",1,"mat-elevation-z0"],[1,"ps-0","pe-1"],[1,"d-flex","justify-content-between","align-items-center","w-100"],[1,"my-0","fw-bold","text-nowrap","w-100"],[1,"ps-3","d-flex","justify-content-end","align-items-center","action-menu-general",3,"click"],["mat-icon-button","","color","primary","title","New file...",1,"tree-action-btn",3,"click"],["mat-icon-button","","color","primary","title","New folder...",1,"tree-action-btn",3,"click"],["mat-icon-button","","color","primary",1,"tree-action-btn",3,"title","click"],["mat-icon-button","","color","primary","title","Upload file ...",1,"tree-action-btn",3,"click"],["mat-icon-button","","color","primary","title","Install module ...",1,"tree-action-btn",3,"click"],["mat-icon-button","","color","primary","title","Execute macro ...",1,"tree-action-btn",3,"click"],[3,"dataSource","treeControl"],["matTreeNodePadding","","level","level","class","justify-content-between file-node",3,"matTreeNodePaddingIndent","text-danger","active-file","d-none",4,"matTreeNodeDef"],["level","level","matTreeNodePadding","","matTreeNodePaddingIndent","10",3,"active-folder","text-danger","d-none",4,"matTreeNodeDef","matTreeNodeDefWhen"],[1,"max-height","panel-2"],["displayMode","flat","multi",""],[1,"mat-elevation-z0",3,"expanded"],[1,"d-flex","w-100"],[1,"my-0","fw-bold","text-nowrap"],["class","justify-content-between d-flex w-100 open-files",3,"id","title","active-file","click",4,"ngFor","ngForOf"],["type","file","multiple","",1,"d-none",3,"ngModel","ngModelChange","change"],["file",""],["type","file","accept",".zip",1,"d-none",3,"ngModel","ngModelChange","change"],["zipfile",""],["class","overlay",3,"click",4,"ngIf"],["matTreeNodePadding","","level","level",1,"justify-content-between","file-node",3,"matTreeNodePaddingIndent"],["mat-button","",1,"w-100","file-button","px-1","justify-content-start","d-flex",3,"click"],["type","text",1,"w-100","ms-2",3,"value","id","keyup.enter","keyup.esc"],["fileInput",""],["class","show-on-hover",4,"ngIf"],[1,"show-on-hover"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["level","level","matTreeNodePadding","","matTreeNodePaddingIndent","10"],["mat-button","","matTreeNodeToggle","","matTooltipPosition","after",1,"px-1",3,"matTooltip"],[1,"mat-icon-rtl-mirror"],["mat-button","",1,"px-1","d-flex","justify-content-start","w-100","folder-btn",3,"click"],["folderInput",""],[1,"justify-content-between","d-flex","w-100","open-files",3,"id","title","click"],["mat-button","",1,"justify-content-start","d-flex","w-100"],["mat-icon-button","",3,"click"],[1,"overlay",3,"click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"mat-accordion",2,3)(4,"mat-expansion-panel",4)(5,"mat-expansion-panel-header",5)(6,"mat-panel-title")(7,"div",6)(8,"p",7),e._uU(9,"Files & folders"),e.qZA(),e.TgZ(10,"div",8),e.NdJ("click",function(r){return r.stopPropagation()}),e.TgZ(11,"button",9),e.NdJ("click",function(){return n.createNewFileObject("file")}),e.TgZ(12,"mat-icon"),e._uU(13,"post_add"),e.qZA()(),e.TgZ(14,"button",10),e.NdJ("click",function(){return n.createNewFileObject("folder")}),e.TgZ(15,"mat-icon"),e._uU(16,"create_new_folder"),e.qZA()(),e.TgZ(17,"button",11),e.NdJ("click",function(){return n.currentFileData&&"file"===n.currentSelection?n.downloadActiveFile(n.currentFileData.path):n.downloadFolder()}),e.TgZ(18,"mat-icon"),e._uU(19,"file_download"),e.qZA()(),e.TgZ(20,"button",12),e.NdJ("click",function(){e.CHM(o);const r=e.MAs(42);return e.KtG(r.click())}),e.TgZ(21,"mat-icon"),e._uU(22,"file_upload"),e.qZA()(),e.TgZ(23,"button",13),e.NdJ("click",function(){e.CHM(o);const r=e.MAs(44);return e.KtG(r.click())}),e.TgZ(24,"mat-icon"),e._uU(25,"drive_folder_upload"),e.qZA()(),e.TgZ(26,"button",14),e.NdJ("click",function(){return n.selectMacro()}),e.TgZ(27,"mat-icon"),e._uU(28,"pets"),e.qZA()()()()()(),e.TgZ(29,"mat-tree",15),e.YNc(30,de,10,17,"mat-tree-node",16),e.YNc(31,me,13,19,"mat-tree-node",17),e.qZA()()()(),e.TgZ(32,"div",18)(33,"mat-accordion",19)(34,"mat-expansion-panel",20)(35,"mat-expansion-panel-header",5)(36,"mat-panel-title")(37,"div",21)(38,"p",22),e._uU(39,"Open files"),e.qZA()()()(),e.YNc(40,ue,6,5,"div",23),e.qZA()()()(),e.TgZ(41,"input",24,25),e.NdJ("ngModelChange",function(r){return n.fileInput=r})("change",function(r){return n.uploadFiles(r.target.files)}),e.qZA(),e.TgZ(43,"input",26,27),e.NdJ("ngModelChange",function(r){return n.zipFileInput=r})("change",function(r){return n.installModule(r.target.files)}),e.qZA(),e.YNc(45,he,1,0,"div",28)}2&t&&(e.xp6(17),e.Q6J("title",n.currentFileData&&"file"===n.currentSelection?"Download file...":"Download folder..."),e.xp6(12),e.Q6J("dataSource",n.dataSource)("treeControl",n.treeControl),e.xp6(2),e.Q6J("matTreeNodeDefWhen",n.isExpandable),e.xp6(3),e.Q6J("expanded",n.openFiles&&n.openFiles.length>0),e.xp6(6),e.Q6J("ngForOf",n.openFiles),e.xp6(1),e.Q6J("ngModel",n.fileInput),e.xp6(2),e.Q6J("ngModel",n.zipFileInput),e.xp6(2),e.Q6J("ngIf",null!==n.showRenameBox))},dependencies:[g.sg,g.O5,u.Fj,u.JJ,u.On,T.Hw,x.lW,D.pp,D.ib,D.yz,D.yK,S.gM,b.fQ,b.ah,b.eu,b.gi,b.uo],styles:[".panel-1[_ngcontent-%COMP%]{flex:1 1 auto;overflow:hidden}.panel-1[_ngcontent-%COMP%]   .mat-expansion-panel[_ngcontent-%COMP%]{max-height:100%}.panel-2[_ngcontent-%COMP%]{flex:0 0 auto}.panel-2[_ngcontent-%COMP%]   .mat-expansion-panel[_ngcontent-%COMP%]{max-height:15vh}.rename-box[_ngcontent-%COMP%]{position:absolute;left:4px;width:94%;z-index:2}.overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:1}  #tree .action-menu-general .mat-icon-button{height:25px;width:25px;line-height:25px}  #tree .action-menu-general .mat-icon-button mat-icon{width:18px;height:18px;font-size:18px;line-height:18px}  #tree .mat-accordion{padding:0 0 16px;max-height:100%;overflow:hidden;display:flex}  #tree .mat-accordion .mat-expansion-panel-body{padding:0}  #tree .mat-accordion .mat-expansion-panel-header{height:25px}  #tree .mat-accordion .mat-expansion-panel-header.mat-expanded{height:25px}  #tree .mat-accordion .mat-expansion-panel{overflow:hidden;width:100%}  #tree .mat-accordion .mat-expansion-panel-content{max-height:calc(100% - 25px);height:100%;overflow:auto}  #tree .mat-accordion .mat-expansion-panel-content::-webkit-scrollbar{width:8px;background-color:#f5f5f5}  #tree .mat-accordion .mat-expansion-panel-content::-webkit-scrollbar-thumb{background-color:#bdbdbd;border-radius:10px}  #tree .mat-accordion .mat-expansion-panel-content::-webkit-scrollbar-track{box-shadow:inset 0 0 6px #f5f5f5;-webkit-box-shadow:inset 0 0 6px #f5f5f5;background-color:#f5f5f5}  #tree .mat-accordion .mat-expansion-panel-content::-webkit-scrollbar{height:7px;background-color:#f5f5f5}  #tree .mat-accordion .mat-expansion-panel-content::-webkit-scrollbar-thumb{background-color:#bdbdbd}  #tree .mat-tree-node{min-height:30px;position:relative;overflow:visible;transition:all .3s}  #tree .mat-tree-node:hover{transition:all .3s}  #tree .mat-tree-node.file-node .file-button{margin-left:28px!important}  #tree .mat-tree-node button{font-size:12px;line-height:21px}  #tree .mat-tree-node button mat-icon{font-size:22px;width:22px;height:22px;line-height:22px;margin-right:5px}  #tree .mat-tree-node .folder-btn{margin-left:-9px}  #tree .mat-tree-node .show-on-hover{visibility:hidden;display:flex;align-items:center}  #tree .mat-tree-node .show-on-hover .mat-icon-button{height:25px;width:25px;line-height:25px;background-color:#fffffff2}  #tree .mat-tree-node .show-on-hover mat-icon{font-size:18px;line-height:18px;width:18px;height:18px;margin-right:0}  #tree .mat-tree-node.active-folder,   #tree .mat-tree-node.active-folder:hover{background-color:#bdbdbd40}  #tree .mat-tree-node.active-file,   #tree .mat-tree-node.active-file:hover{background-color:#bdbdbd40}  #tree .mat-tree-node:hover{background-color:#f0f0f040}  #tree .mat-tree-node:hover .show-on-hover{visibility:visible}  #tree .open-files{transition:all .3s}  #tree .open-files button{font-size:12px;line-height:21px;padding-left:5px}  #tree .open-files button.mat-icon-button{height:unset}  #tree .open-files:hover{transition:all .3s}  #tree .open-files.active-file{background-color:#bdbdbd1a}  #tree .open-files:hover{background-color:#f0f0f040}  #tree .open-files mat-icon{font-size:20px;width:20px;height:20px;line-height:20px}"]}),i})();const _e=new b.JZ((i,s)=>({expandable:i.isFolder,name:i.name,level:s,node:i}),i=>i.level,i=>i.expandable,i=>i.children);var xe=c(3231),ve=c(2168),Fe=c(2282);let be=(()=>{class i{constructor(t){this.data=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-preview-file-dialog"]],decls:6,vars:5,consts:[["mat-dialog-content",""],[1,"markdown-preview",3,"innerHTML"],["mat-dialog-actions","",3,"align"],["mat-button","","tabindex","-1",3,"mat-dialog-close"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.ALo(2,"marked"),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e._uU(5," Close "),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,3,n.data),e.oJD),e.xp6(2),e.Q6J("align","end"),e.xp6(1),e.Q6J("mat-dialog-close",n.data))},dependencies:[x.lW,d.ZT,d.xY,d.H8,Fe.r],styles:[".markdown-preview p{word-break:unset;white-space:unset}"]}),i})();function we(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Name is required and cannot contain blank space or special characters"),e.qZA())}function Te(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"New name cannot be the same as the current name"),e.qZA())}function Ce(i,s){if(1&i&&(e.TgZ(0,"mat-hint"),e.YNc(1,we,2,0,"span",7),e.YNc(2,Te,2,0,"span",7),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.pathValid()),e.xp6(1),e.Q6J("ngIf",t.data.name===t.originalName)}}let ye=(()=>{class i{constructor(t,n,o){this.generalService=t,this.dialogRef=n,this.data=o,this.originalName=o.name}ok(){this.pathValid()?this.data.name!==this.originalName?this.dialogRef.close(this.data):this.generalService.showFeedback("New name cannot be the same as the current name","errorMessage","Ok",5e3):this.generalService.showFeedback("Name is required and cannot contain blank space or special characters","errorMessage","Ok",5e3)}pathValid(){if(!this.data.name||0===this.data.name.length)return!1;for(const t of this.data.name)if(-1==="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_-.".indexOf(t.toLowerCase()))return!1;return!0}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(F.m),e.Y36(d.so),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-rename-file-dialog"]],decls:17,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-100","standalone-field"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"mat-icon-rtl-mirror"],[1,"text-muted"],["type","text","matInput","","autocomplete","off","name","-",3,"ngModel","ngModelChange"],[4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary","type","submit",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Rename file"),e.qZA(),e.TgZ(2,"form")(3,"div",1)(4,"mat-form-field",2)(5,"span",3)(6,"mat-icon",4),e._uU(7,"insert_drive_file"),e.qZA(),e.TgZ(8,"span",5),e._uU(9,"|"),e.qZA()(),e.TgZ(10,"input",6),e.NdJ("ngModelChange",function(a){return n.data.name=a}),e.qZA()(),e.YNc(11,Ce,3,2,"mat-hint",7),e.qZA(),e.TgZ(12,"div",8)(13,"button",9),e._uU(14," Close "),e.qZA(),e.TgZ(15,"button",10),e.NdJ("click",function(){return n.ok()}),e._uU(16," Rename "),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("ngModel",n.data.name),e.xp6(1),e.Q6J("ngIf",n.data.name&&!n.pathValid()||n.data.name===n.originalName),e.xp6(1),e.Q6J("align","end"))},dependencies:[g.O5,u._Y,u.Fj,u.JJ,u.JL,u.On,u.F,T.Hw,x.lW,_.KE,_.bx,_.qo,C.Nt,d.ZT,d.uh,d.xY,d.H8],encapsulation:2}),i})();function Me(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Name is required and cannot contain blank space or special characters"),e.qZA())}function Ze(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"New name cannot be the same as the current name"),e.qZA())}function De(i,s){if(1&i&&(e.TgZ(0,"mat-hint"),e.YNc(1,Me,2,0,"span",7),e.YNc(2,Ze,2,0,"span",7),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.pathValid()),e.xp6(1),e.Q6J("ngIf",t.data.name===t.originalName)}}let Se=(()=>{class i{constructor(t,n,o){this.generalService=t,this.dialogRef=n,this.data=o;let a=o.name.substring(0,o.name.length-1);a=a.substring(a.lastIndexOf("/")+1),this.originalName=a,this.newName=a}ok(){this.pathValid()?this.data.name!==this.originalName?(this.data.name=this.newName,this.dialogRef.close(this.newName)):this.generalService.showFeedback("New name cannot be the same as the current name","errorMessage","Ok",5e3):this.generalService.showFeedback("Name is required and cannot contain blank space or special characters.","errorMessage","Ok",5e3)}cancel(){this.dialogRef.close()}pathValid(){if(!this.newName||0===this.newName.length)return!1;for(const t of this.newName)if(-1==="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_-.".indexOf(t.toLowerCase()))return!1;return!0}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(F.m),e.Y36(d.so),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-rename-folder-dialog"]],decls:17,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-100"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"mat-icon-rtl-mirror"],[1,"text-muted"],["type","text","matInput","","autocomplete","off","name","name",3,"ngModel","ngModelChange"],[4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary","type","submit",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Rename folder"),e.qZA(),e.TgZ(2,"form")(3,"div",1)(4,"mat-form-field",2)(5,"span",3)(6,"mat-icon",4),e._uU(7,"folder"),e.qZA(),e.TgZ(8,"span",5),e._uU(9,"|"),e.qZA()(),e.TgZ(10,"input",6),e.NdJ("ngModelChange",function(a){return n.newName=a}),e.qZA(),e.YNc(11,De,3,2,"mat-hint",7),e.qZA()(),e.TgZ(12,"div",8)(13,"button",9),e._uU(14," Close "),e.qZA(),e.TgZ(15,"button",10),e.NdJ("click",function(){return n.ok()}),e._uU(16," Rename "),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("ngModel",n.newName),e.xp6(1),e.Q6J("ngIf",n.data.name&&!n.pathValid()||n.data.name===n.originalName),e.xp6(1),e.Q6J("align","end"))},dependencies:[g.O5,u._Y,u.Fj,u.JJ,u.JL,u.On,u.F,T.Hw,x.lW,_.KE,_.bx,_.qo,C.Nt,d.ZT,d.uh,d.xY,d.H8],encapsulation:2}),i})();const ke=function(){return{save:!1}},Ae=function(){return{save:!0}};let Ie=(()=>{class i{constructor(t){this.data=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-unsaved-changes-dialog"]],decls:12,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"p",2),e._uU(4,"Your changes will be lost if you don't save them."),e.qZA()(),e.TgZ(5,"div",3)(6,"button",4),e._uU(7," Cancel "),e.qZA(),e.TgZ(8,"button",5),e._uU(9," Don't save "),e.qZA(),e.TgZ(10,"button",6),e._uU(11," Save "),e.qZA()()),2&t&&(e.xp6(1),e.hij("Do you want to save the changes you made to ",n.data,"?"),e.xp6(4),e.Q6J("align","end"),e.xp6(3),e.Q6J("mat-dialog-close",e.DdM(4,ke)),e.xp6(2),e.Q6J("mat-dialog-close",e.DdM(5,Ae)))},dependencies:[x.lW,d.ZT,d.uh,d.xY,d.H8],encapsulation:2}),i})();var Y=c(8317),Ee=c(2343),Ne=c(3545),Je=c(1794),Oe=c(1955),qe=c(1935),Ue=c(9331),Qe=c(9669),Pe=c(4425),Ye=c(1481),Re=c(8710),je=c(8531),R=c(1103),He=c(8684),Le=c(6234);const We=["assumptions"];function Ge(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p",13),e._uU(3,"Response content type:"),e.qZA()(),e.TgZ(4,"div",14)(5,"p",15),e._uU(6),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.itemDetails?null:t.itemDetails.produces," ")}}function Be(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p",13),e._uU(3,"Request content type:"),e.qZA()(),e.TgZ(4,"div",14)(5,"p",15),e._uU(6),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.itemDetails?null:t.itemDetails.consumes," ")}}function Ke(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p",13),e._uU(3,"Endpoint type:"),e.qZA()(),e.TgZ(4,"div",14)(5,"p",15),e._uU(6),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.itemDetails?null:t.itemDetails.type," ")}}function $e(i,s){1&i&&(e.ynx(0),e._uU(1,","),e.BQk())}function ze(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,$e,2,0,"ng-container",17),e.qZA()),2&i){const t=s.$implicit,n=s.last;e.xp6(1),e.hij(" ",t,""),e.xp6(1),e.Q6J("ngIf",!n)}}function Ve(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p",13),e._uU(3,"Roles:"),e.qZA()(),e.TgZ(4,"div",14)(5,"p",15),e.YNc(6,ze,3,2,"span",16),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",null==t.itemDetails?null:t.itemDetails.auth)}}function Xe(i,s){if(1&i&&(e.TgZ(0,"div",11)(1,"div",12)(2,"p",13),e._uU(3,"Description:"),e.qZA()(),e.TgZ(4,"div",14)(5,"p",18),e._uU(6),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.itemDetails?null:t.itemDetails.description," ")}}function et(i,s){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"app-query-params",31),e.qZA(),e.TgZ(3,"div",30)(4,"p",32),e._uU(5),e.qZA()()()),2&i){const t=s.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("item",t)("allItems",n.itemDetails.input),e.xp6(3),e.hij(" ",n.getDescription(t)," ")}}function tt(i,s){if(1&i&&(e.TgZ(0,"div",29)(1,"div",30),e._UZ(2,"app-query-params",31),e.qZA(),e.TgZ(3,"div",30)(4,"p",32),e._uU(5),e.qZA()()()),2&i){const t=s.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("item",t)("allItems",n.itemDetails.input),e.xp6(3),e.hij(" ",n.getDescription(t)," ")}}function nt(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24)(3,"h3",25),e._uU(4,"Query parameters"),e.qZA()(),e.TgZ(5,"div",26)(6,"form",27),e.YNc(7,et,6,3,"div",28),e.YNc(8,tt,6,3,"div",28),e.qZA()()(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(6),e.Q6J("formGroup",t.paramsForm),e.xp6(1),e.Q6J("ngForOf",t.getArguments(t.itemDetails.input,!0)),e.xp6(1),e.Q6J("ngForOf",t.getArguments(t.itemDetails.input,!1))}}function it(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.payload=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.payload)("options",t.cm.json)}}function ot(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.payload=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.payload)("options",t.cm.hyperlambda)}}function at(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.payload=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.payload)("options",t.cm.markdown)}}function rt(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",33)(2,"div",34)(3,"h3",25),e._uU(4,"Body"),e.qZA()(),e.YNc(5,it,2,2,"ng-container",17),e.YNc(6,ot,2,2,"ng-container",17),e.YNc(7,at,2,2,"ng-container",17),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf","application/json"===(null==t.itemDetails?null:t.itemDetails.consumes)),e.xp6(1),e.Q6J("ngIf","application/x-hyperlambda"===(null==t.itemDetails?null:t.itemDetails.consumes)),e.xp6(1),e.Q6J("ngIf",null==t.itemDetails||null==t.itemDetails.consumes?null:t.itemDetails.consumes.startsWith("text/"))}}function st(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.result.response=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.result.response)("options",t.cm.json_readonly)}}function lt(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.result.response=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.result.response)("options",t.cm.hyperlambda_readonly)}}function ct(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ngx-codemirror",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.result.response=o)}),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.result.response)("options",t.markdownOptionsReadonly.md)}}function dt(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"img",38),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.result.blob,e.LSH)}}function pt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",36)(1,"div",34)(2,"h3",25),e._uU(3,"Result"),e.qZA(),e.TgZ(4,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.copyResult(o.result.response))}),e.TgZ(5,"mat-icon"),e._uU(6,"content_copy"),e.qZA(),e._uU(7," Copy result "),e.qZA()(),e.TgZ(8,"p")(9,"span"),e._uU(10),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"span"),e._uU(13),e.qZA()(),e.YNc(14,st,2,2,"ng-container",17),e.YNc(15,lt,2,2,"ng-container",17),e.YNc(16,ct,2,2,"ng-container",17),e.YNc(17,dt,2,1,"ng-container",17),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(8),e.ekj("text-danger",!t.isSuccess()),e.xp6(1),e.ekj("text-success",t.isSuccess()),e.xp6(1),e.Oqu(t.result.status),e.xp6(3),e.Oqu(t.result.statusText),e.xp6(1),e.Q6J("ngIf","json"===t.result.responseType),e.xp6(1),e.Q6J("ngIf","hyperlambda"===t.result.responseType),e.xp6(1),e.Q6J("ngIf","text"===t.result.responseType),e.xp6(1),e.Q6J("ngIf","blob"===t.result.responseType)}}function mt(i,s){1&i&&(e.ynx(0),e.TgZ(1,"div",39)(2,"h3"),e._uU(3,"Invoke the endpoint to see the result"),e.qZA()(),e.BQk())}function ut(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,nt,9,3,"ng-container",17),e.YNc(2,rt,8,3,"ng-container",17),e.YNc(3,pt,18,10,"div",19),e.YNc(4,mt,4,0,"ng-container",17),e.TgZ(5,"div",20)(6,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.createTest())}),e._uU(7," Save as test case "),e.qZA(),e.TgZ(8,"button",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.invoke())}),e._uU(9," Try it out! "),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.parameters&&t.parameters.length&&("get"===t.itemDetails.verb||"delete"===t.itemDetails.verb)),e.xp6(1),e.Q6J("ngIf",(null==t.itemDetails?null:t.itemDetails.consumes)&&t.codemirrorIsReady),e.xp6(1),e.Q6J("ngIf",t.result),e.xp6(1),e.Q6J("ngIf",!(t.parameters.length||t.result||null!=t.itemDetails&&t.itemDetails.consumes)),e.xp6(2),e.Q6J("disabled",!t.canCreateAssumption),e.xp6(2),e.Q6J("disabled",t.isExecuting)}}function ht(i,s){1&i&&(e.ynx(0),e.TgZ(1,"div",39)(2,"h3",41),e._uU(3,"This endpoint cannot be executed here"),e.qZA()(),e.BQk())}function gt(i,s){1&i&&(e.TgZ(0,"div",39)(1,"h3"),e._uU(2,"Try something!"),e.qZA()())}function ft(i,s){if(1&i&&(e.YNc(0,ht,4,0,"ng-container",9),e.ALo(1,"keyvalue"),e.YNc(2,gt,3,0,"ng-template",null,40,e.W1O)),2&i){const t=e.MAs(3),n=e.oxw();e.Q6J("ngIf",n.itemDetails&&e.lcZ(1,2,n.itemDetails).length&&!n.canInvoke())("ngIfElse",t)}}let _t=(()=>{class i{constructor(t,n,o,a,r,l,p,m,h,f){this.dialog=t,this.clipboard=n,this.cdr=o,this.sanitizer=a,this.formBuilder=r,this.backendService=l,this.generalService=p,this.endpointService=m,this.assumptionService=h,this.data=f,this.originalPath="",this.itemDetails={},this.parameters=[],this.cm={json:Ee,json_readonly:Oe,hyperlambda:Je,hyperlambda_readonly:Ue,markdown:Ne,markdown_readonly:qe},this.payload=null,this.result=null,this.isExecuting=!1,this.paramsForm=this.formBuilder.group({}),this.codemirrorIsReady=!1,this.canCreateAssumption=!1}ngOnInit(){this.itemDetails=[],this.parameters=[],this.result=null,this.paramsForm=this.formBuilder.group({}),this.prepareData(this.data.itemToBeTried)}getArguments(t,n){return"crud-read"===this.itemDetails.type||"crud-count"===this.itemDetails.type?t.filter(o=>{switch(o.name){case"operator":case"limit":case"offset":case"order":case"direction":case"recaptcha":return n;default:return!n}}):n?[]:t}getDescription(t){if("crud-read"!==this.itemDetails.type&&"crud-count"!==this.itemDetails.type)return`${t.name} equals to`;switch(t.name){case"operator":return"Boolean operator to use for conditions, defaults to 'and'";case"limit":return"Maximum number of items to return, defaults to 25";case"offset":return"Offset from where to return items";case"order":return"Column to sort by";case"direction":return"Direction to sort by, defaults to 'asc'";default:if(-1===t.name.indexOf("."))return t.type;{const n=t.name.substring(t.name.lastIndexOf(".")+1),o=t.name.substring(0,t.name.lastIndexOf("."));switch(n){case"eq":return`'${o}' equal to ${t.type}`;case"neq":return`'${o}' not equal to ${t.type}`;case"mteq":return`'${o}' more than or equal to ${t.type}`;case"lteq":return`'${o}' less than or equal to ${t.type}`;case"lt":return`'${o}' less than ${t.type}`;case"mt":return`'${o}' more than ${t.type}`;case"like":return`'${o}' contains ${t.type}`;default:return""}}}}canInvoke(){return"get"===this.itemDetails?.verb||"delete"===this.itemDetails?.verb||"application/json"===this.itemDetails?.consumes||"application/x-hyperlambda"===this.itemDetails?.consumes||this.itemDetails?.consumes?.startsWith("text/")}invoke(){if(this.itemDetails.path=this.originalPath,Object.values(this.paramsForm.value).length){let n=`${this.itemDetails.path}`;n+="?";for(const o in this.paramsForm.value)this.paramsForm.value[o]&&("date"===this.itemDetails.input.find(r=>r.name===o).type?n+=o+"="+encodeURIComponent(new Date(this.paramsForm.value[o]).toISOString())+"&":n+=o+"="+encodeURIComponent(this.paramsForm.value[o])+"&");this.itemDetails.path=n.substring(0,n.length-1)}this.isExecuting=!0;let t="";t="application/json"===this.itemDetails.produces?"json":"application/x-hyperlambda"===this.itemDetails.produces?"hyperlambda":this.itemDetails.produces.startsWith("text")?"text":"blob";try{let n=null;switch(this.itemDetails.verb){case"get":n=this.endpointService.get(`/${this.itemDetails.path}`,t);break;case"delete":n=this.endpointService.delete(`/${this.itemDetails.path}`,t);break;case"post":{const r="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;n=this.endpointService.post(`/${this.itemDetails.path}`,r,t)}break;case"put":{const r="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;n=this.endpointService.put(`/${this.itemDetails.path}`,r,t)}break;case"patch":{const r="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;n=this.endpointService.patch(`/${this.itemDetails.path}`,r,t)}break;case"socket":const a=(new Y.su).withUrl(this.backendService.active.url+"/sockets",{accessTokenFactory:()=>this.backendService.active.token.token,skipNegotiation:!0,transport:Y.n4.WebSockets}).build();a.start().then(()=>{let r=!0;const l=`/${this.itemDetails.path}`.substring(14);a.invoke("execute",l,this.payload).catch(()=>{this.generalService.showFeedback("Something went wrong as we tried to invoke socket endpoint"),r=!1,this.isExecuting=!1}).then(()=>{a.stop(),r&&(this.isExecuting=!1,this.generalService.showFeedback("Socket invocation was successful"))})})}if(n){const o=new Date;this.generalService.showLoading(),n.subscribe({next:a=>{this.generalService.hideLoading();const l=(new Date).getTime()-o.getTime(),p="json"===t?JSON.stringify(a.body||"{}",null,2):a.body;if(this.result={status:a.status,statusText:a.statusText+" in "+new Intl.NumberFormat("en-us").format(l)+" milliseconds",response:p,blob:null,responseType:t},"blob"===t){const m=URL.createObjectURL(p);this.result.blob=this.sanitizer.bypassSecurityTrustUrl(m)}this.isExecuting=!1,this.canCreateAssumption=!0},error:a=>{this.generalService.hideLoading(),this.isExecuting=!1,this.result={status:a.status,statusText:a.statusText,response:JSON.stringify(a.error||"{}",null,2),blob:null,responseType:t},this.canCreateAssumption=!0}})}}catch(n){this.isExecuting=!1,this.canCreateAssumption=!0,this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}}isSuccess(){return this.result&&this.result.status>=200&&this.result.status<400}inputTypes(t){switch(t){case"bool":case"string":return"text";case"long":case"int":case"uint":case"short":case"ushort":return"number";case"date":return"date"}}createTest(){this.dialog.open(Qe.V,{width:"550px"}).afterClosed().subscribe(n=>{n&&(this.generalService.showLoading(),this.assumptionService.create(n.filename,this.itemDetails.verb,`/${this.itemDetails.path}`,this.result?.status,""!==n.description?n.description:null,""!==this.payload?this.payload:null,n.matchResponse&&!this.result?.blob?this.result?.response:null,this.itemDetails.produces).subscribe({next:()=>{this.generalService.hideLoading(),n.matchResponse&&this.result.blob?this.generalService.showFeedback("Assumption successfully saved. Notice, blob types of invocations cannot assume response equality.","successMessage","Ok",5e3):this.generalService.showFeedback("Assumption successfully saved","successMessage"),this.assumptions.getAssumptions(),this.cdr.detectChanges()},error:o=>{this.generalService.hideLoading(),this.generalService.showFeedback(o?.error?.message??o,"errorMessage")}}))})}copyResult(t){this.clipboard.copy(t),this.generalService.showFeedback("Result can be found on your clipboard")}prepareData(t){if(this.itemDetails=t,this.originalPath=t.path,t.input&&this.setForm(),this.getParams(),"application/json"===this.itemDetails.consumes){let o={};for(var n of this.itemDetails.input??[]){let a=n.type;switch(a){case"long":case"ulong":case"int":case"uint":case"short":case"ushort":a=42;break;case"date":a=(new Date).toISOString();break;case"bool":a=!0;break;case"string":a="foo";break;case"decimal":case"float":case"double":a=5.5}o[n.name]=a}this.payload=JSON.stringify(o,null,2),setTimeout(()=>{document.querySelectorAll(".CodeMirror").forEach(a=>{var l=a.CodeMirror;l.doc.markClean(),l.doc.clearHistory()})},800)}else("application/x-hyperlambda"===this.itemDetails.consumes||this.itemDetails?.consumes?.startsWith("text/"))&&setTimeout(()=>this.payload="",250);setTimeout(()=>{this.codemirrorIsReady=!0},500),this.cdr.detectChanges()}getParams(){this.parameters=this.itemDetails.input?.map(t=>t.name)||[]}setForm(){this.itemDetails.input.forEach(t=>{this.paramsForm.setControl(t.name,new u.NI(""))})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.uw),e.Y36(Pe.TU),e.Y36(e.sBO),e.Y36(Ye.H7),e.Y36(u.qu),e.Y36(Re.v),e.Y36(F.m),e.Y36(Q.B),e.Y36(je.D),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-execute-endpoint-dialog"]],viewQuery:function(t,n){if(1&t&&e.Gf(We,5),2&t){let o;e.iGM(o=e.CRH())&&(n.assumptions=o.first)}},decls:18,vars:12,consts:[[1,"row","h-100","max-height"],[1,"col-lg-5","col-12"],["class","row mb-2",4,"ngIf"],[1,"row","mt-4"],[1,"col-12"],[3,"itemDetails","result","payload"],["assumptions",""],[1,"col-lg-7","col-12"],[1,"d-flex","flex-column","h-100","w-100"],[4,"ngIf","ngIfElse"],["noInvocation",""],[1,"row","mb-2"],[1,"col-xxl-4","col-sm-5","col-12"],[1,"text-muted","my-0"],[1,"col-xxl-8","col-sm-7","col-12"],[1,"my-0"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"my-0","description"],["class","w-100 h-100 endpoint-result",4,"ngIf"],[1,"d-flex","justify-content-end","button-row","mt-3"],["mat-button","","color","primary",1,"px-sm-4",3,"disabled","click"],["mat-flat-button","","color","primary",1,"px-sm-4",3,"disabled","click"],[1,"row","mb-3"],[1,"col-12","mb-3"],[1,"my-0","fw-bold"],[1,"col-12","params-wrapper"],["novalidate","",3,"formGroup"],["class","row align-items-center params-inputs",4,"ngFor","ngForOf"],[1,"row","align-items-center","params-inputs"],[1,"col-sm-6","col-12"],[3,"item","allItems"],[1,"my-0","ms-3"],[1,"w-100","h-100","endpoint-result","mb-3"],[1,"d-flex","justify-content-between","align-items-center","w-100","mb-3"],[1,"h-100",3,"ngModel","options","ngModelChange"],[1,"w-100","h-100","endpoint-result"],["mat-button","","color","primary",1,"copy-btn",3,"click"],["alt","Image resulting from invocation","width","250",1,"d-block","m-auto",3,"src"],[1,"m-auto"],["noEndpointSelected",""],[1,"fw-bold"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ge,7,1,"div",2),e.YNc(3,Be,7,1,"div",2),e.YNc(4,Ke,7,1,"div",2),e.YNc(5,Ve,7,1,"div",2),e.YNc(6,Xe,7,1,"div",2),e.ynx(7),e.TgZ(8,"div",3)(9,"div",4),e._UZ(10,"app-assumptions",5,6),e.qZA()(),e.BQk(),e.qZA(),e.TgZ(12,"div",7)(13,"div",8),e.YNc(14,ut,10,6,"ng-container",9),e.ALo(15,"keyvalue"),e.YNc(16,ft,4,4,"ng-template",null,10,e.W1O),e.qZA()()()),2&t){const o=e.MAs(17);e.xp6(2),e.Q6J("ngIf",null==n.itemDetails?null:n.itemDetails.produces),e.xp6(1),e.Q6J("ngIf",null==n.itemDetails?null:n.itemDetails.consumes),e.xp6(1),e.Q6J("ngIf",null==n.itemDetails?null:n.itemDetails.type),e.xp6(1),e.Q6J("ngIf",null==n.itemDetails?null:n.itemDetails.auth),e.xp6(1),e.Q6J("ngIf",null==n.itemDetails?null:n.itemDetails.description),e.xp6(4),e.Q6J("itemDetails",n.data.itemToBeTried)("result",n.result)("payload",n.payload),e.xp6(4),e.Q6J("ngIf",n.itemDetails&&e.lcZ(15,10,n.itemDetails).length&&n.canInvoke())("ngIfElse",o)}},dependencies:[g.sg,g.O5,T.Hw,x.lW,u._Y,u.JJ,u.JL,u.On,u.sg,R.C,He.$,Le.x,g.Nd],styles:[".endpoint-result{flex:1 1 auto;overflow:hidden}  .endpoint-result .CodeMirror{height:100%;max-height:40vh}.params-inputs[_ngcontent-%COMP%]     .mat-form-field-appearance-outline .mat-form-field-infix{padding-top:3px;padding-bottom:8px}.params-inputs[_ngcontent-%COMP%]     .mat-form-field-prefix{font-size:11px;top:-1px}.params-inputs[_ngcontent-%COMP%]     .min-width{min-width:100px}.params-wrapper[_ngcontent-%COMP%]{max-height:165px;overflow-y:auto}.copy-btn[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px}.h-100[_ngcontent-%COMP%]{max-height:100%;overflow:hidden}.description[_ngcontent-%COMP%]{font-size:12px;line-height:1.5}.max-height[_ngcontent-%COMP%]{max-height:calc(100vh - 60px)}"]}),i})();var xt=c(6808),vt=c(3553),Ft=c(9627),bt=c(7856);function wt(i,s){if(1&i&&(e.TgZ(0,"div",8)(1,"h3",9),e._uU(2,"Edit"),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.hij("\xa0\xa0",null==t.currentFileData?null:t.currentFileData.path," ")}}function Tt(i,s){1&i&&(e.TgZ(0,"div",8)(1,"h3",9),e._uU(2,"Hyper IDE"),e.qZA()())}function Ct(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"ngx-codemirror",10),e.NdJ("ngModelChange",function(o){const r=e.CHM(t).$implicit;return e.KtG(r.content=o)}),e.qZA()(),e.BQk()}if(2&i){const t=s.$implicit,n=s.index,o=e.oxw();e.xp6(1),e.Gre("active-codemirror-editor-",n," editor"),e.ekj("d-none",o.currentFileData.path!==t.path),e.xp6(1),e.Q6J("ngModel",t.content)("options",t.options)}}function yt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"app-openai-prompt",11),e.NdJ("callback",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.insertFromOpenAI(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("fileType",t.fileType())}}function Mt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.closeActiveFile())}),e._uU(1," Close "),e.qZA()}}function Zt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.saveActiveFile())}),e._uU(1," Save "),e.qZA()}}let Dt=(()=>{class i{constructor(t,n,o,a,r,l,p){this.dialog=t,this.fileService=n,this.aiService=o,this.generalService=a,this.evaluatorService=r,this.vocabularyService=l,this.codemirrorActionsService=p,this.codemirrorOptions={},this.activeFolder="",this.updateFileObject=new e.vpe,this.getFilesFromServer=new e.vpe,this.getEndpoints=new e.vpe,this.dataBindTree=new e.vpe,this.closeFile=new e.vpe,this.deleteActiveFolderFromParent=new e.vpe,this.deleteActiveFileFromParent=new e.vpe,this.renameFileFromParent=new e.vpe,this.renameFolderFromParent=new e.vpe,this.createNewFileObjectFromParent=new e.vpe}ngOnInit(){this.watchForActions()}ngOnChanges(t){const n=this.openFiles.findIndex(o=>o.path===this.currentFileData.path);t.currentFileData&&!t.currentFileData.firstChange&&this.currentFileData&&this.currentFileData.options!==this.codemirrorOptions[this.currentFileData.path]&&(this.getCodeMirrorOptions(),setTimeout(()=>{const a=document.querySelector(".active-codemirror-editor-"+n).querySelector(".CodeMirror").CodeMirror;a.doc.isClean(),a.doc.markClean(),a.doc.clearHistory()},100))}clearEditorHistory(){const t=this.openFiles.findIndex(a=>a.path===this.currentFileData.path),o=document.querySelector(".active-codemirror-editor-"+t).querySelector(".CodeMirror").CodeMirror;o.doc.markClean(),o.doc.clearHistory()}fileType(){return this.currentFileData?.path.substring(this.currentFileData?.path.lastIndexOf(".")+1)}insertFromOpenAI(t){this.currentFileData.content=t}setFocusToActiveEditor(){setTimeout(()=>{const t=this.openFiles.findIndex(a=>a.path===this.currentFileData.path),n=document.querySelector(".active-codemirror-editor-"+t);if(n){var o=n.querySelector(".CodeMirror")?.CodeMirror;o&&o.focus()}},1)}openShortkeys(){this.dialog.open(ve.r,{width:"900px",data:{type:["full","prompt"]}})}ngAfterViewInit(){window._vocabulary||this.vocabularyService.vocabulary().subscribe({next:t=>window._vocabulary=t,error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}ngOnDestroy(){this.codemirrorActionSubscription?.unsubscribe()}saveActiveFile(t=!1){this.generalService.showLoading(),this.fileService.saveFile(this.currentFileData.path,this.currentFileData.content).subscribe({next:()=>{this.markEditorClean(!1),this.generalService.showFeedback("File successfully saved","successMessage"),this.getEndpoints.emit(),t&&this.closeActiveFile(!0)},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}})}deleteActiveFile(){this.deleteActiveFileFromParent.emit()}deleteActiveFolder(){this.deleteActiveFolderFromParent.emit(this.currentFileData.folder)}closeActiveFile(t=!1){var n=this;return(0,y.Z)(function*(){!n.currentFileData||(yield n.activeFileIsClean().then(o=>{!0===o?n.closeFile.emit(n.currentFileData.path):n.dialog.open(Ie,{width:"550px",data:n.currentFileData.name}).afterClosed().subscribe(r=>{if(r&&!0===r.save)n.saveActiveFile(!0);else{if(!r||!1!==r.save)return;n.markEditorClean(),n.closeFile.emit(n.currentFileData.path),n.setFocusToActiveEditor()}})}))})()}executeActiveFile(){var t=this;return(0,y.Z)(function*(){0===t.openFiles.length||!t.currentFileData.path.endsWith(".hl")||(null!==(yield t.getEndpointToExecute())?t.dialog.open(_t,{data:{itemToBeTried:yield t.getEndpointToExecute()},minWidth:"80vw",minHeight:"50vh",panelClass:["light"]}):(t.generalService.showLoading(),t.evaluatorService.execute(t.currentFileData.content).subscribe({next:()=>{t.generalService.hideLoading(),t.generalService.showFeedback("File successfully executed","successMessage")},error:n=>{t.generalService.hideLoading(),t.generalService.showFeedback(n?.error?.message??n,"erroorMessage")}})))})()}getEndpointToExecute(){if(this.currentFileData?.path?.startsWith("/modules/")||this.currentFileData?.path?.startsWith("/system/")){const t=this.currentFileData.name.split(".");if(t.length>=3&&"hl"===t[t.length-1])switch(t[t.length-2]){case"get":case"put":case"post":case"patch":case"delete":const n="magic"+this.currentFileData.folder+t[0];let a=JSON.parse(JSON.stringify(this.endpoints)).filter(r=>r.path===n&&r.verb===t[t.length-2]);if(a.length>0)return a[0]}}return null}activeFileIsClean(){return new Promise(t=>{const n=this.openFiles.findIndex(a=>a.path===this.currentFileData.path),o=document.querySelector(".active-codemirror-editor-"+n);if(o){const a=o.querySelector(".CodeMirror")?.CodeMirror;a&&t(a.isClean())}t(!0)})}markEditorClean(t=!0){const n=this.openFiles.findIndex(r=>r.path===this.currentFileData.path),a=document.querySelector(".active-codemirror-editor-"+n).querySelector(".CodeMirror").CodeMirror;a.doc.markClean(),t&&a.doc.clearHistory()}renameFile(){this.currentFileData&&this.dialog.open(ye,{width:"550px",data:{name:this.currentFileData.name}}).afterClosed().subscribe(n=>{n&&this.renameFileFromParent.emit({file:this.currentFileData,newName:n.name})})}renameFolder(){this.currentFileData&&("/"!==this.activeFolder&&"/system/"!==this.activeFolder&&"/modules/"!==this.activeFolder?this.dialog.open(Se,{width:"550px",data:{name:this.activeFolder}}).afterClosed().subscribe(n=>{n&&(this.activeFolder.substring(0,this.activeFolder.lastIndexOf("/")),this.renameFolderFromParent.emit({folder:this.activeFolder,newName:n}),this.activeFolder=this.activeFolder.substring(0,this.activeFolder.substring(0,this.activeFolder.length-1).lastIndexOf("/")+1)+n+"/")}):this.generalService.showFeedback("You cannot rename system folders","errorMessage","Ok",3e3))}createNewFileObject(t){this.createNewFileObjectFromParent.emit(t)}previewActiveFile(){!this.currentFileData.path.endsWith(".md")||0!==this.openFiles.length&&this.dialog.open(be,{data:this.currentFileData.content})}insertSnippet(){this.currentFileData.path.endsWith(".hl")&&0!==this.openFiles.length&&this.dialog.open(xe.U,{width:"550px"}).afterClosed().subscribe(n=>{n&&this.evaluatorService.loadSnippet(n).subscribe({next:o=>this.insertHyperlambda(o),error:o=>this.generalService.showFeedback(o?.error?.message??o,"errorMessage")})})}insertHyperlambda(t){const n=this.openFiles.findIndex(r=>r.path===this.currentFileData.path),o=document.querySelector(".active-codemirror-editor-"+n);if(o){var a=o.querySelector(".CodeMirror")?.CodeMirror;if(a){let r="";const l=a.doc.sel.ranges[0].anchor.ch;if(l%3!=0)return void this.generalService.showFeedback("Indentation must be modulo of 3","errorMessage","Ok",5e3);const p=t.trimEnd().split("\n");let m=!0;for(let j of p)m?(r+=j.trimEnd()+"\r\n",m=!1):r+=" ".repeat(l)+j.trimEnd()+"\r\n";const h=a.getDoc(),f=h.getCursor(),v=h.getLine(f.line);h.replaceRange(r,{line:f.line,ch:v.length})}}}selectMacro(){this.dialog.open(U,{width:"550px",data:{name:""}}).afterClosed().subscribe(n=>{n&&this.executeMacro(n.name)})}executeMacro(t){this.generalService.showLoading(),this.fileService.getMacroDefinition(t).subscribe({next:n=>{this.generalService.hideLoading();const o=this.activeFolder.split("/");if(4===o.length&&"modules"===o[1]){const l=n.arguments.filter(p=>"module"===p.name||"database"===p.name);if(l.length>0)for(const p of l)p.value=o[2]}const a=n.arguments.filter(l=>"auth"===l.name);if(a.length>0)for(const l of a)l.value="root";this.dialog.open(N,{width:"500px",data:n}).afterClosed().subscribe(l=>{if(l&&l.name){const p={};for(const m of l.arguments.filter(h=>h.value))p[m.name]=m.value;this.generalService.showLoading(),this.fileService.executeMacro(t,p).subscribe({next:m=>{if(this.generalService.hideLoading(),this.generalService.showFeedback("Macro successfully executed","successMessage"),"folders-changed"===m.result)this.dialog.open(M.z,{width:"500px",data:{title:"Refresh folders",description_extra:"Macro execution changed your file system, do you want to refresh your files and folders?",action_btn:"Refresh",action_btn_color:"primary",bold_description:!0}}).afterClosed().subscribe(f=>{"confirm"===f&&this.getFilesFromServer.emit()});else if(m.result.startsWith("folders-changed|")){var h=m.result.split("|")[1];this.updateFileObject.emit(h)}},error:m=>{this.generalService.hideLoading(),this.generalService.showFeedback(m?.error?.message??m,"errorMessage")}})}else l&&this.selectMacro()})},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}})}watchForActions(){this.codemirrorActionSubscription=this.codemirrorActionsService.action.subscribe(t=>{switch(t){case"save":this.saveActiveFile();break;case"deleteFile":this.deleteActiveFile();break;case"close":this.closeActiveFile();break;case"renameFile":this.renameFile();break;case"renameFolder":this.renameFolder();break;case"insertSnippet":this.insertSnippet();break;case"macro":this.selectMacro();break;case"newFile":this.createNewFileObject("file");break;case"newFolder":this.createNewFileObject("folder");break;case"deleteFolder":this.deleteActiveFolder();break;case"preview":this.previewActiveFile();break;case"execute":this.executeActiveFile();break;case"prompt":this.prompt()}})}prompt(){const t=this.openFiles.findIndex(r=>r.path===this.currentFileData.path),a=document.querySelector(".active-codemirror-editor-"+t).querySelector(".CodeMirror").CodeMirror.getSelection();a?.length>0&&this.aiService.prompt(a)}getCodeMirrorOptions(){const t=this.codemirrorActionsService.getActions(null,this.currentFileData?.path.split(".").pop());this.codemirrorOptions[this.currentFileData.path]=t,this.currentFileData.options=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.uw),e.Y36(Z.I),e.Y36(xt.p),e.Y36(F.m),e.Y36(vt.a),e.Y36(Ft.c),e.Y36(P.C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-ide-editor"]],inputs:{currentFileData:"currentFileData",activeFolder:"activeFolder",openFiles:"openFiles",endpoints:"endpoints"},outputs:{updateFileObject:"updateFileObject",getFilesFromServer:"getFilesFromServer",getEndpoints:"getEndpoints",dataBindTree:"dataBindTree",closeFile:"closeFile",deleteActiveFolderFromParent:"deleteActiveFolderFromParent",deleteActiveFileFromParent:"deleteActiveFileFromParent",renameFileFromParent:"renameFileFromParent",renameFolderFromParent:"renameFolderFromParent",createNewFileObjectFromParent:"createNewFileObjectFromParent"},features:[e.TTD],decls:12,vars:6,consts:[[1,"d-flex","flex-column","w-100","h-100"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","w-100","mb-0"],["class","d-flex align-items-center",4,"ngIf"],["mat-button","","color","primary",3,"click"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","align-items-center","w-100","mt-2","mb-0"],["callbackText","Use","class","w-100",3,"fileType","callback",4,"ngIf"],["mat-button","","color","primary","class","px-3",3,"click",4,"ngIf"],[1,"d-flex","align-items-center"],[1,"my-0","fw-bold"],[1,"codemirror-container","h-100",3,"ngModel","options","ngModelChange"],["callbackText","Use",1,"w-100",3,"fileType","callback"],["mat-button","","color","primary",1,"px-3",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,wt,4,1,"div",2),e.YNc(3,Tt,3,0,"div",2),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return n.openShortkeys()}),e._uU(6," Shortkeys "),e.qZA()()(),e.YNc(7,Ct,3,7,"ng-container",4),e.TgZ(8,"div",5),e.YNc(9,yt,1,1,"app-openai-prompt",6),e.YNc(10,Mt,2,0,"button",7),e.YNc(11,Zt,2,0,"button",7),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",n.currentFileData),e.xp6(1),e.Q6J("ngIf",!n.currentFileData),e.xp6(4),e.Q6J("ngForOf",n.openFiles),e.xp6(2),e.Q6J("ngIf",n.currentFileData),e.xp6(1),e.Q6J("ngIf",n.currentFileData),e.xp6(1),e.Q6J("ngIf",n.currentFileData))},dependencies:[g.sg,g.O5,bt.j,u.JJ,u.On,x.lW,R.C],styles:[".full-height[_ngcontent-%COMP%]{height:calc(100% - 88px)}  .editor{overflow-y:hidden;height:calc(100% - 85px)}  .editor .CodeMirror{height:100%}"]}),i})();var St=c(1135);function kt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(),a=e.MAs(8);return o.removeSearchTerm(),e.KtG(a.value="")}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}let At=(()=>{class i{constructor(){this._inputValue=new St.X(""),this.filterList=new e.vpe,this.toggleFileSystems=new e.vpe,this.inputValue=this._inputValue.asObservable()}applyFilter(t){this._inputValue.next(t),this.filterList.emit(this._inputValue)}removeSearchTerm(){this._inputValue.next(""),this.filterList.emit(this._inputValue)}toggleFileSystem(){this.toggleFileSystems.emit(this.fileSystem)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-ide-searchbox"]],outputs:{filterList:"filterList",toggleFileSystems:"toggleFileSystems"},decls:13,vars:2,consts:[[1,"d-flex","justify-content-lg-between","align-items-lg-center","align-items-end","flex-lg-row","flex-column","w-100"],[1,"w-100","standalone-field","custom-size"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","placeholder","Filter ...","autocomplete","off",3,"input"],["input",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],[1,"p-lg-2"],["color","primary",1,"mt-lg-0","mt-3",3,"ngModel","ngModelChange","change"],["mat-icon-button","","matSuffix","",3,"click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"span",2)(3,"mat-icon"),e._uU(4,"search"),e.qZA(),e.TgZ(5,"span",3),e._uU(6,"|"),e.qZA()(),e.TgZ(7,"input",4,5),e.NdJ("input",function(){e.CHM(o);const r=e.MAs(8);return e.KtG(n.applyFilter(r.value))}),e.qZA(),e.YNc(9,kt,3,0,"button",6),e.qZA(),e._UZ(10,"div",7),e.TgZ(11,"mat-checkbox",8),e.NdJ("ngModelChange",function(r){return n.fileSystem=r})("change",function(){return n.toggleFileSystem()}),e._uU(12," System files "),e.qZA()()}if(2&t){const o=e.MAs(8);e.xp6(9),e.Q6J("ngIf",""!==o.value),e.xp6(2),e.Q6J("ngModel",n.fileSystem)}},dependencies:[g.O5,u.JJ,u.On,T.Hw,x.lW,_.KE,_.qo,_.R9,C.Nt,O.oG],styles:[".custom-size[_ngcontent-%COMP%]     .mat-form-field-infix{width:100%}"]}),i})();const It=[{path:"",component:(()=>{class i{showEditor(t){this.currentFileData=t.currentFileData}filterList(t){this.searchKey=t.value}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-ide"]],decls:17,vars:5,consts:[[1,"row","fullPage"],[1,"col-xl-3","col-lg-4","col-md-5","col-12","mb-md-0","mb-4"],[1,"h-100","tree-card"],[1,"h-100","max-height-full"],[1,"row"],[1,"col-12"],[3,"toggleFileSystems","filterList"],["search",""],[1,"row","scrollable-row"],[1,"col-12","max-height"],[3,"searchKey","showEditor","clearEditorHistory","setFocusToActiveEditor"],["tree",""],[1,"col-xl-9","col-lg-8","col-md-7","col-12"],[1,"h-100","px-3","py-2"],[1,"h-100","d-block",3,"currentFileData","activeFolder","openFiles","endpoints","updateFileObject","getFilesFromServer","getEndpoints","dataBindTree","deleteActiveFolderFromParent","deleteActiveFileFromParent","renameFileFromParent","renameFolderFromParent","createNewFileObjectFromParent","closeFile"],["editor",""]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-content",3)(4,"div",4)(5,"div",5)(6,"app-ide-searchbox",6,7),e.NdJ("toggleFileSystems",function(r){e.CHM(o);const l=e.MAs(11);return l.systemFiles=r,e.KtG(l.updateFileObject("/"))})("filterList",function(r){return n.filterList(r)}),e.qZA()()(),e.TgZ(8,"div",8)(9,"div",9)(10,"app-ide-tree",10,11),e.NdJ("showEditor",function(r){return n.showEditor(r)})("clearEditorHistory",function(r){e.CHM(o);const l=e.MAs(16);return e.KtG(l.clearEditorHistory(r))})("setFocusToActiveEditor",function(){e.CHM(o);const r=e.MAs(16);return e.KtG(r.setFocusToActiveEditor())}),e.qZA()()()()()(),e.TgZ(12,"div",12)(13,"mat-card",13)(14,"mat-card-content",3)(15,"app-ide-editor",14,15),e.NdJ("updateFileObject",function(r){e.CHM(o);const l=e.MAs(11);return e.KtG(l.updateFileObject(r))})("getFilesFromServer",function(){e.CHM(o);const r=e.MAs(11);return e.KtG(r.getFilesFromServer())})("getEndpoints",function(){e.CHM(o);const r=e.MAs(11);return e.KtG(r.getEndpoints())})("dataBindTree",function(){e.CHM(o);const r=e.MAs(11);return e.KtG(r.dataBindTree())})("deleteActiveFolderFromParent",function(){e.CHM(o);const r=e.MAs(11);return e.KtG(r.deleteActiveFolder())})("deleteActiveFileFromParent",function(){e.CHM(o);const r=e.MAs(11);return e.KtG(r.deleteActiveFile())})("renameFileFromParent",function(r){e.CHM(o);const l=e.MAs(11);return e.KtG(l.renameFile(r))})("renameFolderFromParent",function(r){e.CHM(o);const l=e.MAs(11);return e.KtG(l.renameFolder(r))})("createNewFileObjectFromParent",function(r){e.CHM(o);const l=e.MAs(11);return e.KtG(l.createNewFileObject(r))})("closeFile",function(r){e.CHM(o);const l=e.MAs(11);return e.KtG(l.closeFile(r))}),e.qZA()()()()()}if(2&t){const o=e.MAs(11);e.xp6(10),e.Q6J("searchKey",n.searchKey),e.xp6(5),e.Q6J("currentFileData",n.currentFileData)("activeFolder",o.activeFolder)("openFiles",o.openFiles)("endpoints",o.endpoints)}},dependencies:[E.a8,E.dn,ge,Dt,At],styles:[".scrollable-row[_ngcontent-%COMP%]{height:calc(100% - 42px);overflow:hidden}mat-card.tree-card[_ngcontent-%COMP%]{padding:15px}mat-card.tree-card[_ngcontent-%COMP%]   app-ide-searchbox[_ngcontent-%COMP%]{font-size:11px}.max-height-full[_ngcontent-%COMP%]{max-height:53vh;min-height:100%;overflow:hidden}.max-height[_ngcontent-%COMP%]{max-height:100%}"]}),i})()}];let Et=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[I.Bz.forChild(It),I.Bz]}),i})();var Nt=c(1717);let Jt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,Et,L.K,H.m,Nt.h]}),i})()}}]);