"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[856],{8670:(I,A,n)=>{n.d(A,{n:()=>i});var e=n(4650),p=n(5938),x=n(6147),y=n(3885),m=n(7392),v=n(4859),o=n(9549),g=n(4144),s=n(266),r=n(4006);const c=function(){return{configured:!1}};let i=(()=>{class h{constructor(u,_,b){this.dialogRef=u,this.openAiService=_,this.generalService=b,this.openApiKey=""}ngOnInit(){this.generalService.showLoading(),this.openAiService.key().subscribe({next:u=>{this.openApiKey=u.result||"",this.generalService.hideLoading()},error:u=>{this.generalService.showFeedback(u?.error?.message??u,"errorMessage"),this.generalService.hideLoading()}})}save(){this.openApiKey.length<20?this.generalService.showFeedback("Not a valid API key","errorMessage"):(this.generalService.showLoading(),this.openAiService.setKey(this.openApiKey).subscribe({next:()=>{this.generalService.showFeedback("Your OpenAI API key was saved to your configuration","successMessage"),this.generalService.hideLoading(),this.dialogRef.close({configured:!0,key:this.openApiKey})},error:u=>{this.generalService.showFeedback(u?.error?.message??u,"errorMessage"),this.generalService.hideLoading()}}))}close(){this.dialogRef.close({configured:!1})}}return h.\u0275fac=function(u){return new(u||h)(e.Y36(p.so),e.Y36(x.A),e.Y36(y.m))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-openai-configuration-dialog"]],decls:21,vars:4,consts:[["mat-dialog-title","",1,"mb-1"],[3,"ngSubmit"],["mat-dialog-content",""],[1,"text-muted","mt-0","mb-4"],["href","https://beta.openai.com/account/api-keys","target","_blank"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","OpenAI API key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","cdkFocusInitial","","placeholder","OpenAI API key","name","openApiKey","autocomplete","off",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"mat-dialog-close"],["mat-flat-button","","type","submit"]],template:function(u,_){1&u&&(e.TgZ(0,"h3",0),e._uU(1,"Configure OpenAI"),e.qZA(),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return _.save()}),e.TgZ(3,"div",2)(4,"p",3),e._uU(5," Supply your OpenAI API key. You can get an API key "),e.TgZ(6,"a",4),e._uU(7,"here"),e.qZA(),e._uU(8,". "),e.qZA(),e.TgZ(9,"mat-form-field",5)(10,"span",6)(11,"mat-icon"),e._uU(12,"key"),e.qZA(),e.TgZ(13,"span",7),e._uU(14,"|"),e.qZA()(),e.TgZ(15,"input",8),e.NdJ("ngModelChange",function(O){return _.openApiKey=O}),e.qZA()()(),e.TgZ(16,"div",9)(17,"button",10),e._uU(18," Cancel "),e.qZA(),e.TgZ(19,"button",11),e._uU(20," Save "),e.qZA()()()),2&u&&(e.xp6(15),e.Q6J("ngModel",_.openApiKey),e.xp6(1),e.Q6J("align","end"),e.xp6(1),e.Q6J("mat-dialog-close",e.DdM(3,c)))},dependencies:[m.Hw,v.lW,o.KE,o.qo,g.Nt,p.ZT,p.uh,p.xY,p.H8,s.gM,r._Y,r.Fj,r.JJ,r.JL,r.On,r.F],styles:["a[_ngcontent-%COMP%]{text-decoration:none}"]}),h})()},7856:(I,A,n)=>{n.d(A,{j:()=>E});var e=n(4650),p=n(5938),x=n(3885),y=n(7855),m=n(8588),v=n(4425),o=n(6895),g=n(4859),s=n(4006),r=n(1103);function c(a,f){if(1&a){const t=e.EpF();e.TgZ(0,"ngx-codemirror",8),e.NdJ("ngModelChange",function(d){e.CHM(t);const C=e.oxw();return e.KtG(C.data.snippet=d)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngModel",t.data.snippet)("options",t.options)}}function i(a,f){if(1&a){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.callbackInvoked())}),e._uU(1),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.hij(" ",t.data.callbackText," ")}}let T=(()=>{class a{constructor(t,l,d,C,k){this.data=t,this.generalService=l,this.dialog=d,this.codemirrorActionsService=C,this.clipBoard=k,this.cmReady=!1}ngOnInit(){this.options=this.codemirrorActionsService.getActions(null,this.data.fileType),setTimeout(()=>{this.cmReady=!0},250)}callbackInvoked(){this.data.callback.emit(this.data.snippet),this.dialog.close()}copy(){this.clipBoard.copy(this.data.snippet),this.generalService.showFeedback("Content can be found on your clipboard")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.WI),e.Y36(x.m),e.Y36(y.zj),e.Y36(m.C),e.Y36(v.TU))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-openai-answer-dialog"]],decls:12,vars:4,consts:[["mat-dialog-title","",1,"mb-0"],["mat-dialog-content",""],[1,"text-muted","text-small","mb-3"],["class","codemirror-container h-100",3,"ngModel","options","ngModelChange",4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"],["mat-flat-button","","mat-dialog-close",""],[1,"codemirror-container","h-100",3,"ngModel","options","ngModelChange"]],template:function(t,l){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Your question"),e.qZA(),e.TgZ(2,"div",1)(3,"p",2),e._uU(4),e.qZA(),e.YNc(5,c,1,2,"ngx-codemirror",3),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,i,2,1,"button",5),e.TgZ(8,"button",6),e.NdJ("click",function(){return l.copy()}),e._uU(9," Copy "),e.qZA(),e.TgZ(10,"button",7),e._uU(11," Close "),e.qZA()()),2&t&&(e.xp6(4),e.Oqu(l.data.prompt),e.xp6(1),e.Q6J("ngIf",l.cmReady),e.xp6(1),e.Q6J("align","end"),e.xp6(1),e.Q6J("ngIf",l.data.callback))},dependencies:[o.O5,g.lW,p.ZT,p.uh,p.xY,p.H8,s.JJ,s.On,r.C],styles:[".code[_ngcontent-%COMP%]{white-space:break-spaces}"]}),a})();var u=n(8670),_=n(6147),b=n(7392),O=n(9549),S=n(4144),M=n(266);function Z(a,f){if(1&a){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const d=e.oxw(2);return e.KtG(d.openAiPrompt="")}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function P(a,f){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",5)(1,"span",6)(2,"mat-icon"),e._uU(3,"help_outline"),e.qZA(),e.TgZ(4,"span",7),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"input",8),e.NdJ("ngModelChange",function(d){e.CHM(t);const C=e.oxw();return e.KtG(C.openAiPrompt=d)}),e.qZA(),e.YNc(7,Z,3,0,"button",9),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("matTooltip",t.getTooltip()),e.xp6(5),e.Q6J("disabled",t.waitingForAnswer)("ngModel",t.openAiPrompt),e.xp6(1),e.Q6J("ngIf",""!==t.openAiPrompt)}}function K(a,f){if(1&a&&(e.TgZ(0,"button",11),e._uU(1," Ask "),e.qZA()),2&a){const t=e.oxw();e.Q6J("disabled",t.waitingForAnswer)}}function w(a,f){if(1&a){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.configureOpenAi())}),e._uU(1," Configure AI "),e.qZA()}}let E=(()=>{class a{constructor(t,l,d){this.dialog=t,this.generalService=l,this.openAiService=d,this.callback=new e.vpe,this.callbackText=null,this.openAiEnabled=!1,this.waitingForAnswer=!1,this.openAiPrompt=""}ngOnInit(){this.openAiService.isConfigured().subscribe({next:t=>{this.openAiEnabled=t.result}})}getTooltip(){switch(this.fileType){case"hl":return"Ask the Machine to create some Hyperlambda code for you";case"ts":return"Ask the Machine to create TypeScript code for you";case"js":return"Ask the Machine to create JavaScript code for you";case"html":case"htm":return"Ask the Machine to create HTML for you";case"css":return"Ask the Machine to create CSS for you";case"sql":return"Ask the Machine to create SQL for you";case"md":return"Ask the Machine to create Markdown for you";default:return"Ask the Machine to help you out"}}configureOpenAi(){this.dialog.open(u.n,{width:"80vw",maxWidth:"550px"}).afterClosed().subscribe(l=>{l?.configured&&(this.openAiEnabled=!0,this.generalService.hideLoading())})}askOpenAi(){this.openAiPrompt&&""!==this.openAiPrompt?(this.generalService.showLoading(),this.waitingForAnswer=!0,this.openAiService.query(this.openAiPrompt,this.fileType).subscribe({next:t=>{this.generalService.hideLoading(),this.waitingForAnswer=!1,this.dialog.open(T,{width:"80vw",maxWidth:"1024px",data:{snippet:t.result,prompt:this.openAiPrompt,fileType:this.fileType,callback:this.callback,callbackText:this.callbackText}})},error:t=>{this.generalService.showFeedback(t?.error?.message??t,"errorMessage"),this.generalService.hideLoading(),this.waitingForAnswer=!1}})):this.generalService.showFeedback("No question specified","errorMessage")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.uw),e.Y36(x.m),e.Y36(_.A))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-openai-prompt"]],inputs:{fileType:"fileType",callbackText:"callbackText"},outputs:{callback:"callback"},decls:5,vars:3,consts:[[1,"w-100","d-flex","flex-nowrap","align-items-center","justify-content-between"],[1,"w-100","d-flex","flex-nowrap","align-items-center","justify-content-between",3,"ngSubmit"],["class","w-100 standalone-field prompt",4,"ngIf"],["mat-button","","type","submit","color","primary","class","px-3",3,"disabled",4,"ngIf"],["mat-button","","color","primary","class","px-3",3,"click",4,"ngIf"],[1,"w-100","standalone-field","prompt"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","pe-2",3,"matTooltip"],[1,"text-muted"],["matInput","","placeholder","Where the Machine Creates the Code ...","name","openAiPrompt","autocomplete","off",3,"disabled","ngModel","ngModelChange"],["mat-icon-button","","matSuffix","","tabIndex","-1","type","reset",3,"click",4,"ngIf"],["mat-icon-button","","matSuffix","","tabIndex","-1","type","reset",3,"click"],["mat-button","","type","submit","color","primary",1,"px-3",3,"disabled"],["mat-button","","color","primary",1,"px-3",3,"click"]],template:function(t,l){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e.NdJ("ngSubmit",function(){return l.askOpenAi()}),e.YNc(2,P,8,4,"mat-form-field",2),e.YNc(3,K,2,1,"button",3),e.qZA(),e.YNc(4,w,2,0,"button",4),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",l.openAiEnabled),e.xp6(1),e.Q6J("ngIf",l.openAiEnabled),e.xp6(1),e.Q6J("ngIf",!l.openAiEnabled))},dependencies:[o.O5,b.Hw,g.lW,O.KE,O.qo,O.R9,S.Nt,M.gM,s._Y,s.Fj,s.JJ,s.JL,s.On,s.F],styles:[".prompt[_ngcontent-%COMP%]{font-size:11px}"]}),a})()},8588:(I,A,n)=>{n.d(A,{C:()=>v});var e=n(8266),p=n.n(e),x=n(7579);const y=JSON.parse('[{"extensions":["sql"],"options":{"mode":"text/x-mysql","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["md","txt","log","key"],"options":{"mode":"markdown","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["yml","yaml"],"options":{"mode":"text/x-yaml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["xml","html","htm"],"options":{"mode":"application/xml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["css"],"options":{"mode":"text/css","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["scss"],"options":{"mode":"text/x-scss","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["less"],"options":{"mode":"text/x-less","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["sass"],"options":{"mode":"text/x-sass","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["js","ts"],"options":{"mode":"text/javascript","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["json"],"options":{"mode":"application/ld+json","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["py"],"options":{"mode":"text/x-python","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["rb"],"options":{"mode":"text/x-ruby","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["sh"],"options":{"mode":"application/x-sh","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["hl","config"],"options":{"mode":"hyperlambda","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"tabSize":3,"indentUnit":3,"indentAuto":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore","Ctrl-Space":"autocomplete"}}}]');var m=n(4650);let v=(()=>{class o{constructor(s){this.ngZone=s,this.extensions=y,this.action=new x.x}getActions(s,r){let c=[];if(s){const i=s.substring(s.lastIndexOf(".")+1).toLowerCase();c=this.extensions.filter(h=>-1!==h.extensions.indexOf(i))}else r&&(c=this.extensions.filter(i=>-1!==i.extensions.indexOf(r)));if(0===c.length)return null;{const i=this.clone(c[0]);return i.options.extraKeys&&(i.options.extraKeys["Alt-M"]=h=>{h.setOption("fullScreen",!h.getOption("fullScreen"))},i.options.extraKeys["Alt-S"]=()=>{this.ngZone.run(()=>{this.action.next("save")})},i.options.extraKeys["Alt-D"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFile")})},i.options.extraKeys["Alt-C"]=()=>{this.ngZone.run(()=>{this.action.next("close")})},i.options.extraKeys["Alt-R"]=()=>{this.ngZone.run(()=>{this.action.next("renameFile")})},i.options.extraKeys["Alt-L"]=()=>{this.ngZone.run(()=>{this.action.next("renameFolder")})},i.options.extraKeys["Alt-V"]=()=>{this.ngZone.run(()=>{this.action.next("insertSnippet")})},i.options.extraKeys["Alt-O"]=()=>{this.ngZone.run(()=>{this.action.next("macro")})},i.options.extraKeys["Alt-A"]=()=>{this.ngZone.run(()=>{this.action.next("newFile")})},i.options.extraKeys["Alt-B"]=()=>{this.ngZone.run(()=>{this.action.next("newFolder")})},i.options.extraKeys["Alt-X"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFolder")})},i.options.extraKeys["Alt-P"]=()=>{this.ngZone.run(()=>{this.action.next("preview")})},i.options.extraKeys.F5=()=>{this.ngZone.run(()=>{this.action.next("execute")})},i.options.extraKeys.F1=()=>{this.ngZone.run(()=>{this.action.next("prompt")})},"sql"===r&&(i.options.extraKeys["Ctrl-Space"]=h=>{this.ngZone.run(()=>{h.showHint({hint:p().hint.sql,completeSingle:!1})})})),i.options}}clone(s){var r={};for(var c in s)r[c]="object"==typeof s[c]?this.clone(s[c]):s[c];return r}}return o.\u0275fac=function(s){return new(s||o)(m.LFG(m.R0b))},o.\u0275prov=m.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},6147:(I,A,n)=>{n.d(A,{A:()=>y});var e=n(4650),p=n(9845);let y=(()=>{class m{constructor(o){this.httpService=o}query(o,g,s=!1,r=null,c=null){let i=`/magic/system/openai/${c?.startsWith("gpt-")?"chat":"prompt"}?prompt=`+encodeURIComponent(o)+"&references="+(s?"true":"false")+"&type="+encodeURIComponent(g);return r&&(i+="&session="+encodeURIComponent(r)),this.httpService.get(i)}isConfigured(){return this.httpService.get("/magic/system/openai/is-configured")}key(){return this.httpService.get("/magic/system/openai/key")}setKey(o){return this.httpService.post("/magic/system/openai/key",{key:o})}models(){return this.httpService.get("/magic/system/openai/models")}themes(){return this.httpService.get("/magic/system/openai/themes")}themesSearch(){return this.httpService.get("/magic/system/openai/themes-search")}uploadTrainingFile(o){return this.httpService.post("/magic/system/openai/upload-training-data",o)}start_training(o){return this.httpService.post("/magic/system/openai/train",o)}importUrl(o,g,s,r,c,i){return this.httpService.post("/magic/system/openai/import-url",{url:o,type:g,delay:s,max:r,threshold:c,summarize:i})}importPage(o,g,s){return this.httpService.post("/magic/system/openai/import-page",{url:o,type:g,threshold:s})}vectorise(o){return this.httpService.post("/magic/system/openai/vectorise",{type:o})}vectoriseSnippet(o){return this.httpService.post("/magic/system/openai/vectorise-snippet",{id:o})}createBot(o,g=null){return this.httpService.post("/magic/system/openai/create-bot",{url:o,flavor:g})}}return m.\u0275fac=function(o){return new(o||m)(e.LFG(p.O))},m.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);