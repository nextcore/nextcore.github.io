"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[745],{9554:(M,b,i)=>{i.d(b,{v:()=>c});const c={name:"Name must be minimum 2 characters long",backendname:"Alphanumeric characters between 2 to 20 (no space).",username:"Alphanumeric between 2 and 20 characters (no space)",email:"Email must be a valid email address",confirmEmail:"Email addresses must match",confirmPassword:"Passwords must match",currentPassword:"Your password is incorrect",cloudletName:"Minimum of 5 characters, only lowercase and numbers",phone:"e.g. 1111111111",subject:"2 to 30 letters, without special characters",message:"Message cannot be less than 3 characters",appNames:"Only lowercase alphanumeric characters, dot (.), - or _ please",appNamesWithUppercaseDot:"Only alphanumeric characters, dot (.), - or _ please",appNamesWithDot:"Only lowercase alphanumeric characters, and - or _ please",appNameWithUppercase:"Accepts alphanumeric characters and _",appNameWithUppercaseHyphen:"Accepts alphanumeric characters, - and _",domain:"Domain is not valid",backend:"Backend URL must contain http://",password:"Minimum 12 characters",recaptcha:"Not valid reCAPTCHA secret or key"}},8194:(M,b,i)=>{i.d(b,{g:()=>c});const c={phone:/^[0-9 ]*$/,name:/^[a-z0-9]{2,20}$/,subject:/^.{4,1000}$/,appNames:/^[a-z0-9_.-]+$/,appNamesWithDot:/^[a-z0-9_.-]+$/,appNamesWithUppercaseDot:/^[a-zA-Z0-9_.-]+$/,appNameWithUppercase:/^[a-zA-Z0-9_]+$/,appNameWithUppercaseHyphen:/^[a-zA-Z0-9_-]+$/,domain:/(^https?:\/\/)([\w\-])+\.{1}([a-zA-Z]{2,63})([\/\w-]*)*\/?\??([^#\n\r]*)?#?([^\n\r]*)/,backend:/^https?:\/\/([\w\-.])+(:[0-9]*)?(\.\w+)?$/,email:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,password:/^.{12,}$/,recaptcha:/^([a-zA-Z-_0-9]{20,100})$/}},7832:(M,b,i)=>{i.d(b,{K:()=>u});var c=i(6895),d=i(2278),o=i(4006),x=i(1103),e=i(4650);let u=(()=>{class g{}return g.\u0275fac=function(y){return new(y||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[c.ez,d.q,o.u5,o.UX,x.k]}),g})()},6996:(M,b,i)=>{i.d(b,{z:()=>O});var c=i(4006),d=i(5938),o=i(4650),x=i(3885),e=i(6895),u=i(7392),g=i(4859),p=i(9549),y=i(4144),w=i(266);function v(C,A){if(1&C&&o._UZ(0,"p",8),2&C){const m=o.oxw();o.Q6J("innerHTML",m.data.description_extra,o.oJD)}}function h(C,A){if(1&C&&(o.TgZ(0,"mat-hint",14),o._uU(1),o.qZA()),2&C){const m=o.oxw(2);o.xp6(1),o.hij(" Inserted ",m.data.extra.fieldToBeTypedTitle," doesn't match. ")}}function Z(C,A){if(1&C&&(o.ynx(0),o.TgZ(1,"mat-form-field",9)(2,"span",10)(3,"mat-icon"),o._uU(4),o.qZA(),o.TgZ(5,"span",11),o._uU(6,"|"),o.qZA()(),o._UZ(7,"input",12),o.YNc(8,h,2,1,"mat-hint",13),o.qZA(),o.BQk()),2&C){const m=o.oxw();o.xp6(2),o.MGl("matTooltip","Type in the ",m.data.extra.fieldToBeTypedTitle,""),o.xp6(2),o.Oqu(null==m.data||null==m.data.extra?null:m.data.extra.icon),o.xp6(3),o.MGl("placeholder","Type in the ",m.data.extra.fieldToBeTypedTitle,""),o.Q6J("formControl",m.inputValue),o.xp6(1),o.Q6J("ngIf",""!==m.inputValue.value&&m.data.extra.fieldToBeTypedValue!==m.inputValue.value)}}let O=(()=>{class C{constructor(m,f,k){this.generalService=m,this.dialogRef=f,this.data=k,this.inputValue=new c.NI("")}ngOnInit(){this.data.title=this.data.title??"Please confirm",this.data.description=this.data.description??"Are you sure?",this.data.action_btn_color=this.data.action_btn_color??"primary"}confirm(){!this.data.extra||!this.data.extra.details||this.inputValue.value===this.data.extra.fieldToBeTypedValue&&""!==this.inputValue.value?this.dialogRef.close("confirm"):this.generalService.showFeedback(this.data.extra.fieldToBeTypedTitle+" does not match","errorMessage",null,2e3)}}return C.\u0275fac=function(m){return new(m||C)(o.Y36(x.m),o.Y36(d.so),o.Y36(d.WI))},C.\u0275cmp=o.Xpm({type:C,selectors:[["app-confirmation-dialog"]],decls:13,vars:10,consts:[["mat-dialog-title",""],[3,"ngSubmit"],["mat-dialog-content",""],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-flat-button","",3,"color","click"],[3,"innerHTML"],[1,"w-100"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2",3,"matTooltip"],[1,"text-muted"],["cdkFocusInitial","","matInput","","autocomplete","off",3,"placeholder","formControl"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(m,f){1&m&&(o.TgZ(0,"h3",0),o._uU(1),o.qZA(),o.TgZ(2,"form",1),o.NdJ("ngSubmit",function(){return f.confirm()}),o.TgZ(3,"div",2)(4,"p"),o._uU(5),o.qZA(),o.YNc(6,v,1,1,"p",3),o.YNc(7,Z,9,5,"ng-container",4),o.qZA(),o.TgZ(8,"div",5)(9,"button",6),o._uU(10),o.qZA(),o.TgZ(11,"button",7),o.NdJ("click",function(){return f.confirm()}),o._uU(12),o.qZA()()()),2&m&&(o.xp6(1),o.Oqu(f.data.title),o.xp6(3),o.ekj("fw-bold",f.data.bold_description),o.xp6(1),o.Oqu(f.data.description),o.xp6(1),o.Q6J("ngIf",f.data.description_extra),o.xp6(1),o.Q6J("ngIf",(null==f.data||null==f.data.extra?null:f.data.extra.details)&&"confirmInput"===(null==f.data||null==f.data.extra?null:f.data.extra.action)),o.xp6(1),o.Q6J("align","end"),o.xp6(2),o.hij(" ",f.data.close_btn||"Cancel"," "),o.xp6(1),o.s9C("color",f.data.action_btn_color),o.xp6(1),o.hij(" ",f.data.action_btn," "))},dependencies:[e.O5,u.Hw,g.lW,p.KE,p.bx,p.qo,y.Nt,d.ZT,d.uh,d.xY,d.H8,w.gM,c._Y,c.Fj,c.JJ,c.JL,c.F,c.oH],styles:["p[_ngcontent-%COMP%]{line-height:1.8}"]}),C})()},9311:(M,b,i)=>{i.d(b,{J:()=>e});var c=i(4650),d=i(6895);const o=function(u){return{height:u}};function x(u,g){if(1&u&&(c.TgZ(0,"div"),c._UZ(1,"div",2),c.qZA()),2&u){const p=c.oxw();c.Tol(p.colClass),c.xp6(1),c.ekj("mat-elevation-z1",p.hasShadow),c.Q6J("ngStyle",c.VKq(5,o,p.blockHeight))}}let e=(()=>{class u{constructor(){this.amount=2,this.colClass="col-12",this.blockHeight="375px",this.hasShadow=!0,this.itemsArray=[]}ngOnInit(){for(let p=0;p<this.amount;p++)this.itemsArray.push("item"+p)}}return u.\u0275fac=function(p){return new(p||u)},u.\u0275cmp=c.Xpm({type:u,selectors:[["app-loading-skeleton"]],inputs:{amount:"amount",colClass:"colClass",blockHeight:"blockHeight",hasShadow:"hasShadow"},decls:2,vars:1,consts:[[1,"row"],[3,"class",4,"ngFor","ngForOf"],[1,"block","mb-3",3,"ngStyle"]],template:function(p,y){1&p&&(c.TgZ(0,"div",0),c.YNc(1,x,2,7,"div",1),c.qZA()),2&p&&(c.xp6(1),c.Q6J("ngForOf",y.itemsArray))},dependencies:[d.sg,d.PC],styles:[".block[_ngcontent-%COMP%]{background:#eee;background:linear-gradient(90deg,#ffffff 8%,#f2f2f2 18%,#fafafa 33%);background-size:200% 100%;animation:1s shine linear infinite;border-radius:5px;border:1px solid rgba(217,217,217,.05)}@keyframes shine{to{background-position-x:-200%}}"]}),u})()},8588:(M,b,i)=>{i.d(b,{C:()=>u});var c=i(8266),d=i.n(c),o=i(7579);const x=JSON.parse('[{"extensions":["sql"],"options":{"mode":"text/x-mysql","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["md","txt","log","key"],"options":{"mode":"markdown","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["yml","yaml"],"options":{"mode":"text/x-yaml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["xml","html","htm"],"options":{"mode":"application/xml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["css"],"options":{"mode":"text/css","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["scss"],"options":{"mode":"text/x-scss","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["less"],"options":{"mode":"text/x-less","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["sass"],"options":{"mode":"text/x-sass","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["js","ts"],"options":{"mode":"text/javascript","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["json"],"options":{"mode":"application/ld+json","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["py"],"options":{"mode":"text/x-python","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["rb"],"options":{"mode":"text/x-ruby","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["sh"],"options":{"mode":"application/x-sh","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["hl","config"],"options":{"mode":"hyperlambda","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"tabSize":3,"indentUnit":3,"indentAuto":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore","Ctrl-Space":"autocomplete"}}}]');var e=i(4650);let u=(()=>{class g{constructor(y){this.ngZone=y,this.extensions=x,this.action=new o.x}getActions(y,w){let v=[];if(y){const h=y.substring(y.lastIndexOf(".")+1).toLowerCase();v=this.extensions.filter(Z=>-1!==Z.extensions.indexOf(h))}else w&&(v=this.extensions.filter(h=>-1!==h.extensions.indexOf(w)));if(0===v.length)return null;{const h=this.clone(v[0]);return h.options.extraKeys&&(h.options.extraKeys["Alt-M"]=Z=>{Z.setOption("fullScreen",!Z.getOption("fullScreen"))},h.options.extraKeys["Alt-S"]=()=>{this.ngZone.run(()=>{this.action.next("save")})},h.options.extraKeys["Alt-D"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFile")})},h.options.extraKeys["Alt-C"]=()=>{this.ngZone.run(()=>{this.action.next("close")})},h.options.extraKeys["Alt-R"]=()=>{this.ngZone.run(()=>{this.action.next("renameFile")})},h.options.extraKeys["Alt-L"]=()=>{this.ngZone.run(()=>{this.action.next("renameFolder")})},h.options.extraKeys["Alt-V"]=()=>{this.ngZone.run(()=>{this.action.next("insertSnippet")})},h.options.extraKeys["Alt-O"]=()=>{this.ngZone.run(()=>{this.action.next("macro")})},h.options.extraKeys["Alt-A"]=()=>{this.ngZone.run(()=>{this.action.next("newFile")})},h.options.extraKeys["Alt-B"]=()=>{this.ngZone.run(()=>{this.action.next("newFolder")})},h.options.extraKeys["Alt-X"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFolder")})},h.options.extraKeys["Alt-P"]=()=>{this.ngZone.run(()=>{this.action.next("preview")})},h.options.extraKeys.F5=()=>{this.ngZone.run(()=>{this.action.next("execute")})},h.options.extraKeys.F1=()=>{this.ngZone.run(()=>{this.action.next("prompt")})},"sql"===w&&(h.options.extraKeys["Ctrl-Space"]=Z=>{this.ngZone.run(()=>{Z.showHint({hint:d().hint.sql,completeSingle:!1})})})),h.options}}clone(y){var w={};for(var v in y)w[v]="object"==typeof y[v]?this.clone(y[v]):y[v];return w}}return g.\u0275fac=function(y){return new(y||g)(e.LFG(e.R0b))},g.\u0275prov=e.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},9627:(M,b,i)=>{i.d(b,{c:()=>e});var c=i(9646),d=i(9751),o=i(4650),x=i(9845);let e=(()=>{class u{constructor(p){this.httpService=p,this._vocabulary=[]}get words(){return this._vocabulary}vocabulary(){return this._vocabulary.length>0&&(0,c.of)(this._vocabulary),new d.y(p=>{this.httpService.get("/magic/system/evaluator/vocabulary").subscribe({next:y=>{this._vocabulary=y,p.next(y),p.complete()},error:y=>{p.error(y),p.complete()}})})}}return u.\u0275fac=function(p){return new(p||u)(o.LFG(x.O))},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},6563:(M,b,i)=>{i.r(b),i.d(b,{CryptographyModule:()=>Re});var c=i(6895),d=i(5938),o=i(9554),x=i(8194),e=i(4650),u=i(2729),g=i(2398),p=i(3885),y=i(8710),w=i(7392),v=i(4859),h=i(9549),Z=i(4144),O=i(266),C=i(4385),A=i(3238),m=i(4006);function f(n,r){1&n&&(e.ynx(0),e._uU(1,"Create new server key pair"),e.BQk())}function k(n,r){1&n&&(e.ynx(0),e._uU(1,"Import new key"),e.BQk())}function L(n,r){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.CommonErrorMessages.backend)}}function Y(n,r){if(1&n&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}const P=function(){return{standalone:!0}};function q(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"mat-form-field",5)(2,"span",21)(3,"mat-icon"),e._uU(4,"nest_secure_alarm"),e.qZA(),e.TgZ(5,"span",7),e._uU(6,"|"),e.qZA()(),e.TgZ(7,"mat-select",22),e.NdJ("ngModelChange",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.newKey.strength=s)}),e.YNc(8,Y,2,2,"mat-option",23),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngModel",t.newKey.strength)("ngModelOptions",e.DdM(3,P)),e.xp6(1),e.Q6J("ngForOf",t.strengthArray)}}let j=(()=>{class n{constructor(t,a,s,l,T,K){this.configService=t,this.cryptoService=a,this.generalService=s,this.backendService=l,this.dialogRef=T,this.data=K,this.newKey=new Q,this.isWaiting=!1,this.strengthArray=[1024,2048,4096,8192],this.CommonRegEx=x.g,this.CommonErrorMessages=o.v}ngOnInit(){"create"===this.data.type?(this.getContent(),this.newKey.strength=this.strengthArray[2]):(this.newKey.type="RSA",this.newKey.enabled=!1)}save(){if(""!==this.newKey.subject)if(this.validateEmail())if(this.validateDomain())if("import"===this.data.type){if(""===this.newKey.fingerprint)return void this.generalService.showFeedback("Public key is not valid","errorMessage");this.import()}else{if(""===this.newKey.content)return void this.generalService.showFeedback("Seed is missing","errorMessage");this.create()}else this.generalService.showFeedback("Please provide a valid domain","errorMessage");else this.generalService.showFeedback("Please provide a valid email address","errorMessage");else this.generalService.showFeedback("All fields are required","errorMessage")}validateDomain(){return this.CommonRegEx.backend.test(this.newKey.domain.replace(/\/$/,""))}publicKeyChanged(){"create"!==this.data.type&&this.cryptoService.getFingerprint(this.newKey.content).subscribe({next:t=>{this.newKey.fingerprint=t.result},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}validateEmail(){return this.CommonRegEx.email.test(this.newKey.email)}getContent(){this.configService.getGibberish(100,200).subscribe({next:t=>{this.newKey.content=t.result},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}import(){this.isWaiting=!0;const t={subject:this.newKey.subject,email:this.newKey.email,domain:this.newKey.domain.replace(/\/$/,""),content:this.newKey.content,enabled:this.newKey.enabled,fingerprint:this.newKey.fingerprint,type:this.newKey.type,vocabulary:this.newKey.vocabulary};this.cryptoService.createPublicKey(t).subscribe({next:()=>{this.generalService.showFeedback("Key successfully imported, please edit its vocabulary and enable it.","successMessage","Ok",5e3),this.isWaiting=!1,this.dialogRef.close(!0)},error:a=>{this.isWaiting=!1,this.generalService.showFeedback(a?.error?.message??a,"errorMessage")}})}create(){this.isWaiting=!0,this.cryptoService.generateKeyPair(this.newKey.strength,this.newKey.content,this.newKey.subject,this.newKey.email,this.newKey.domain.replace(/\/$/,""),this.backendService.active.username).subscribe({next:()=>{this.isWaiting=!1,this.generalService.showFeedback("New key pair created successfully and the old key is backed up.","successMessage","Ok",4e3),this.dialogRef.close(!0)},error:t=>{this.isWaiting=!1,this.generalService.showFeedback(t?.error?.message??t,"errorMessage")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.E),e.Y36(g.$),e.Y36(p.m),e.Y36(y.v),e.Y36(d.so),e.Y36(d.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-new-server-key"]],decls:48,vars:24,consts:[["mat-dialog-title",""],[4,"ngIf"],["mat-dialog-content",""],[1,"row"],[1,"col-sm-6","col-12"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Full name of owner",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","placeholder","Full name","type","text","name","name","autocomplete","off",3,"ngModel","ngModelOptions","ngModelChange"],["matPrefix","","matTooltip","Email address of owner",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","Email address","autocomplete","off",3,"ngModel","ngModelOptions","pattern","ngModelChange"],["matPrefix","","matTooltip","Domain associated with owner of key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","https://domain.com","type","url","name","url","autocomplete","off",3,"ngModel","ngModelOptions","pattern","ngModelChange"],["class","col-sm-6 col-12",4,"ngIf"],[1,"col-12"],[1,"w-100","custom-alignment","standalone-field"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2",3,"matTooltip"],["matInput","","spellcheck","false","rows","7",3,"ngModel","ngModelOptions","placeholder","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-button","","color","primary","mat-dialog-close","",1,"me-2"],["mat-flat-button","","type","submit","color","primary",1,"px-3",3,"disabled","click"],["matPrefix","","matTooltip","Strength of key in bits",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Strength",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,a){1&t&&(e.TgZ(0,"h3",0),e.YNc(1,f,2,0,"ng-container",1),e.YNc(2,k,2,0,"ng-container",1),e.qZA(),e.TgZ(3,"form")(4,"div",2)(5,"div",3)(6,"div",4)(7,"mat-form-field",5)(8,"span",6)(9,"mat-icon"),e._uU(10,"edit"),e.qZA(),e.TgZ(11,"span",7),e._uU(12,"|"),e.qZA()(),e.TgZ(13,"input",8),e.NdJ("ngModelChange",function(l){return a.newKey.subject=l}),e.qZA()()(),e.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"span",9)(17,"mat-icon"),e._uU(18,"mail"),e.qZA(),e.TgZ(19,"span",7),e._uU(20,"|"),e.qZA()(),e.TgZ(21,"input",10),e.NdJ("ngModelChange",function(l){return a.newKey.email=l}),e.qZA(),e.TgZ(22,"mat-error"),e._uU(23),e.qZA()()(),e.TgZ(24,"div",4)(25,"mat-form-field",5)(26,"span",11)(27,"mat-icon"),e._uU(28,"language"),e.qZA(),e.TgZ(29,"span",7),e._uU(30,"|"),e.qZA()(),e.TgZ(31,"input",12),e.NdJ("ngModelChange",function(l){return a.newKey.domain=l}),e.qZA(),e.YNc(32,L,2,1,"mat-error",1),e.qZA()(),e.YNc(33,q,9,4,"div",13),e.TgZ(34,"div",14)(35,"mat-form-field",15)(36,"span",16)(37,"mat-icon"),e._uU(38,"key"),e.qZA(),e.TgZ(39,"span",7),e._uU(40,"|"),e.qZA()(),e.TgZ(41,"textarea",17),e.NdJ("ngModelChange",function(l){return a.newKey.content=l})("ngModelChange",function(){return a.publicKeyChanged()}),e._uU(42,"          "),e.qZA()()()()(),e.TgZ(43,"div",18)(44,"button",19),e._uU(45," Cancel "),e.qZA(),e.TgZ(46,"button",20),e.NdJ("click",function(){return a.save()}),e._uU(47),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("ngIf","create"===(null==a.data?null:a.data.type)),e.xp6(1),e.Q6J("ngIf","import"===(null==a.data?null:a.data.type)),e.xp6(11),e.Q6J("ngModel",a.newKey.subject)("ngModelOptions",e.DdM(20,P)),e.xp6(8),e.Q6J("ngModel",a.newKey.email)("ngModelOptions",e.DdM(21,P))("pattern",a.CommonRegEx.email),e.xp6(2),e.Oqu(a.CommonErrorMessages.email),e.xp6(8),e.Q6J("ngModel",a.newKey.domain)("ngModelOptions",e.DdM(22,P))("pattern",a.CommonRegEx.backend),e.xp6(1),e.Q6J("ngIf",!a.validateDomain()),e.xp6(1),e.Q6J("ngIf","create"===a.data.type),e.xp6(3),e.Q6J("matTooltip","create"===(null==a.data?null:a.data.type)?"Seed for new key":"Public key"),e.xp6(5),e.Q6J("ngModel",a.newKey.content)("ngModelOptions",e.DdM(23,P))("placeholder","create"===(null==a.data?null:a.data.type)?"Seed":"Public key"),e.xp6(2),e.Q6J("align","end"),e.xp6(3),e.Q6J("disabled",a.isWaiting),e.xp6(1),e.hij(" ","create"===(null==a.data?null:a.data.type)?"Save":"Import"," "))},dependencies:[c.sg,c.O5,w.Hw,v.lW,h.TO,h.KE,h.qo,Z.Nt,d.ZT,d.uh,d.xY,d.H8,O.gM,C.gD,A.ey,m._Y,m.Fj,m.JJ,m.JL,m.c5,m.On,m.F],encapsulation:2}),n})();class Q{constructor(){this.subject="",this.email="",this.domain="",this.content="",this.vocabulary="/*\n    * This declares which vocabulary cryptographically signed invocations\n    * originating from the key is allowed to use when communicating with\n    * your server. Please edit it as you see fit. This default value only\n    * allows clients to query for which vocabulary to use, and nothing else\n    * really.\n    */\n    add\n    return\n    get-nodes\n    vocabulary\n    slots.vocabulary\n    "}}var U=i(4425),D=i(3848),N=i(3546),E=i(6996),B=i(8588),W=i(2677);function z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",28)(1,"app-codemirror-hyperlambda",29),e.NdJ("modelChange",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.data.key.options=s)}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("model",t.data.key.options)}}const S=function(){return{standalone:!0}};let $=(()=>{class n{constructor(t,a,s,l,T,K,Je){this.dialog=t,this.clipboard=a,this.cryptoService=s,this.generalService=l,this.codemirrorActionsService=T,this.dialogRef=K,this.data=Je,this.username="",this.codemirrorReady=!1,this.waiting=!1}ngOnInit(){this.getUserAssociation(),this.getCodeMirrorOptions()}getUserAssociation(){this.data.key.username||this.cryptoService.getUserAssociation(this.data.key.id).subscribe({next:t=>this.data.key.username=t.result,error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}copyFingerprint(t){this.clipboard.copy(t),this.generalService.showFeedback("Fingerprint can be found on your clipboard")}copyContent(t){this.clipboard.copy(t),this.generalService.showFeedback("Public key can be found on your clipboard")}getCodeMirrorOptions(){const t=this.codemirrorActionsService.getActions(null,"hl"),a={hyperlambda:this.data.key.vocabulary,options:t};a.options.autofocus=!1,this.data.key.options=a,setTimeout(()=>{this.codemirrorReady=!0},300)}save(){this.waiting=!0;const t={identity:"",original_content:this.data.key.original_content,key:{id:this.data.key.id,content:this.data.key.content,domain:this.data.key.domain,email:this.data.key.email,subject:this.data.key.subject,username:this.data.key.username,enabled:this.data.key.enabled,fingerprint:this.data.key.fingerprint,imported:this.data.key.imported,type:this.data.key.type,vocabulary:this.data.key.vocabulary},options:this.data.key.options};t.key.vocabulary=t.options.hyperlambda,this.cryptoService.getFingerprint(t.key.content).subscribe({next:a=>{const s=t.key.fingerprint!==a.result;t.key.fingerprint=a.result,s?this.dialog.open(E.z,{width:"500px",data:{title:`Changing key for ${t.key.subject}`,description:"Warning!",description_extra:"Changing the actual key content will make it impossible to easily verify historic cryptographic invocations. <br/><br/>Are you sure you wish to proceed?",action_btn:"Proceed",action_btn_color:"warn",bold_description:!0}}).afterClosed().subscribe(l=>{if("confirm"===l){let K="";for(var T of t.original_content)K.length%80==0&&0!==K.length&&(K+="\r\n"),K+=T;this.saveKeyImplementation(t)}}):this.saveKeyImplementation(t)},error:a=>{this.waiting=!1,this.generalService.showFeedback("Key content is not valid.","errorMessage")}})}saveKeyImplementation(t,a){this.cryptoService.updatePublicKey(t.key).subscribe({next:()=>{let s="Key was successfully saved";a&&(s+=". "+a),t.identity=t.key.subject+"  <"+t.key.email+">",t.key.username&&""!==t.key.username?this.cryptoService.associateWithUser(t.key.id,t.key.username).subscribe({next:()=>{this.generalService.showFeedback(s,"successMessage"),this.waiting=!1,this.dialogRef.close(!0)},error:l=>{this.waiting=!1,this.generalService.showFeedback(l?.error?.message??l,"errorMessage")}}):this.cryptoService.deleteUserAssociation(t.key.id).subscribe({next:()=>{this.generalService.showFeedback(s,"successMessage"),this.waiting=!1,this.dialogRef.close(!0)},error:l=>{this.waiting=!1,this.generalService.showFeedback(l?.error?.message??l,"errorMessage")}})},error:s=>{this.waiting=!1,this.generalService.showFeedback(s?.error?.message??s,"errorMessage")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.uw),e.Y36(U.TU),e.Y36(g.$),e.Y36(p.m),e.Y36(B.C),e.Y36(d.so),e.Y36(d.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-public-key-details"]],decls:73,vars:22,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"row"],[1,"col-lg-3","col-sm-6","col-12"],[1,"w-100"],["matPrefix","","matTooltip","Full name of owner",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","placeholder","Full name","disabled","",3,"ngModel","ngModelOptions","ngModelChange"],["matPrefix","","matTooltip","Email address of owner",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","Email address","disabled","",3,"ngModel","ngModelOptions","ngModelChange"],["matPrefix","","matTooltip","Domain associated with owner",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","Domain","disabled","",3,"ngModel","ngModelOptions","ngModelChange"],["matPrefix","","matTooltip","Username associated with key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","Associated user","disabled","",3,"ngModel","ngModelOptions","ngModelChange"],[1,"col-lg-6","col-12"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["mat-button","","color","primary","type","button",1,"custom-copy-btn",3,"click"],["matPrefix","","matTooltip","Fingerprint of public key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","placeholder","Fingerprint","disabled","",3,"ngModel","ngModelOptions","ngModelChange"],[1,"w-100","custom-alignment"],["matPrefix","","matTooltip","Public key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","disabled","","spellcheck","false","rows","12","name","-","autocomplete","off","placeholder","Public key",3,"ngModel","ngModelOptions","ngModelChange"],["class","col-lg-6 col-12 modal-custom-codemirror",4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","color","primary","mat-dialog-close","",1,"me-2"],["mat-flat-button","","color","primary",1,"px-3",3,"disabled","click"],[1,"col-lg-6","col-12","modal-custom-codemirror"],[3,"model","modelChange"]],template:function(t,a){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"form")(4,"div",2)(5,"div",3)(6,"mat-form-field",4)(7,"span",5)(8,"mat-icon"),e._uU(9,"edit"),e.qZA(),e.TgZ(10,"span",6),e._uU(11,"|"),e.qZA()(),e.TgZ(12,"input",7),e.NdJ("ngModelChange",function(l){return a.data.key.subject=l}),e.qZA()()(),e.TgZ(13,"div",3)(14,"mat-form-field",4)(15,"span",8)(16,"mat-icon"),e._uU(17,"mail"),e.qZA(),e.TgZ(18,"span",6),e._uU(19,"|"),e.qZA()(),e.TgZ(20,"input",9),e.NdJ("ngModelChange",function(l){return a.data.key.email=l}),e.qZA()()(),e.TgZ(21,"div",3)(22,"mat-form-field",4)(23,"span",10)(24,"mat-icon"),e._uU(25,"language"),e.qZA(),e.TgZ(26,"span",6),e._uU(27,"|"),e.qZA()(),e.TgZ(28,"input",11),e.NdJ("ngModelChange",function(l){return a.data.key.domain=l}),e.qZA()()(),e.TgZ(29,"div",3)(30,"mat-form-field",4)(31,"span",12)(32,"mat-icon"),e._uU(33,"person"),e.qZA(),e.TgZ(34,"span",6),e._uU(35,"|"),e.qZA()(),e.TgZ(36,"input",13),e.NdJ("ngModelChange",function(l){return a.data.key.username=l}),e.qZA()()()(),e.TgZ(37,"div",2)(38,"div",14)(39,"div",2)(40,"div",15)(41,"div",16)(42,"p",17),e._uU(43,"Fingerprint"),e.qZA(),e.TgZ(44,"button",18),e.NdJ("click",function(){return a.copyFingerprint(a.data.key.fingerprint)}),e._uU(45," Copy "),e.qZA()(),e.TgZ(46,"mat-form-field",4)(47,"span",19)(48,"mat-icon"),e._uU(49,"touch_app"),e.qZA(),e.TgZ(50,"span",6),e._uU(51,"|"),e.qZA()(),e.TgZ(52,"input",20),e.NdJ("ngModelChange",function(l){return a.data.key.fingerprint=l}),e.qZA()()(),e.TgZ(53,"div",15)(54,"div",16)(55,"p",17),e._uU(56,"Public key"),e.qZA(),e.TgZ(57,"button",18),e.NdJ("click",function(){return a.copyContent(a.data.key.content)}),e._uU(58," Copy "),e.qZA()(),e.TgZ(59,"mat-form-field",21)(60,"span",22)(61,"mat-icon"),e._uU(62,"key"),e.qZA(),e.TgZ(63,"span",6),e._uU(64,"|"),e.qZA()(),e.TgZ(65,"textarea",23),e.NdJ("ngModelChange",function(l){return a.data.key.content=l}),e._uU(66,"              "),e.qZA()()()()(),e.YNc(67,z,2,1,"div",24),e.qZA()()(),e.TgZ(68,"div",25)(69,"button",26),e._uU(70," Cancel "),e.qZA(),e.TgZ(71,"button",27),e.NdJ("click",function(){return a.save()}),e._uU(72," Save "),e.qZA()()),2&t&&(e.xp6(1),e.hij("Details of ",null==a.data.key?null:a.data.key.subject," key"),e.xp6(11),e.Q6J("ngModel",a.data.key.subject)("ngModelOptions",e.DdM(16,S)),e.xp6(8),e.Q6J("ngModel",a.data.key.email)("ngModelOptions",e.DdM(17,S)),e.xp6(8),e.Q6J("ngModel",a.data.key.domain)("ngModelOptions",e.DdM(18,S)),e.xp6(8),e.Q6J("ngModel",a.data.key.username)("ngModelOptions",e.DdM(19,S)),e.xp6(16),e.Q6J("ngModel",a.data.key.fingerprint)("ngModelOptions",e.DdM(20,S)),e.xp6(13),e.Q6J("ngModel",a.data.key.content)("ngModelOptions",e.DdM(21,S)),e.xp6(2),e.Q6J("ngIf",a.codemirrorReady),e.xp6(1),e.Q6J("align","end"),e.xp6(3),e.Q6J("disabled",a.waiting))},dependencies:[c.O5,w.Hw,v.lW,h.KE,h.qo,Z.Nt,d.ZT,d.uh,d.xY,d.H8,O.gM,m._Y,m.Fj,m.JJ,m.JL,m.On,m.F,W.u],styles:["#custom-input[_ngcontent-%COMP%]     .mat-input-element:disabled{color:#060d16;font-size:11px}.modal-custom-codemirror[_ngcontent-%COMP%]     .cm-s-aista.CodeMirror{padding-top:10px;min-height:94%}.custom-copy-btn[_ngcontent-%COMP%]{font-size:13px;line-height:1.4}"]}),n})();var I=i(9311),H=i(6709),_=i(671),F=i(8739),R=i(7292);function V(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._UZ(2,"app-loading-skeleton",3),e.qZA(),e.BQk())}function G(n,r){1&n&&(e.TgZ(0,"th",20),e._uU(1," Name "),e.qZA())}function X(n,r){if(1&n&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",null==t?null:t.subject," ")}}function ee(n,r){1&n&&(e.TgZ(0,"th",22),e._uU(1," Domain "),e.qZA())}function te(n,r){if(1&n&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",null==t?null:t.domain," ")}}function ne(n,r){1&n&&(e.TgZ(0,"th",22),e._uU(1," Email "),e.qZA())}function ae(n,r){if(1&n&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",null==t?null:t.email," ")}}function oe(n,r){1&n&&(e.TgZ(0,"th",22),e._uU(1," Created "),e.qZA())}function ie(n,r){if(1&n&&(e.TgZ(0,"td",23),e._uU(1),e.ALo(2,"since"),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.imported)," ")}}function se(n,r){1&n&&(e.TgZ(0,"th",22),e._uU(1," Enabled "),e.qZA())}function re(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",23)(1,"mat-checkbox",24),e.NdJ("change",function(s){const T=e.CHM(t).$implicit,K=e.oxw(2);return e.KtG(K.enabledChanged(s,T))}),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("checked",1===(null==t?null:t.enabled)||!0===(null==t?null:t.enabled))}}function le(n,r){1&n&&(e.TgZ(0,"th",22),e._uU(1," Actions "),e.qZA())}function ce(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",23)(1,"div",25)(2,"div")(3,"button",26),e.NdJ("click",function(){const l=e.CHM(t).$implicit,T=e.oxw(2);return e.KtG(T.viewDetails(l))}),e._uU(4," View details "),e.qZA(),e.TgZ(5,"button",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit,T=e.oxw(2);return e.KtG(T.deleteKey(l))}),e._uU(6," Delete "),e.qZA(),e.TgZ(7,"button",26),e.NdJ("click",function(){const l=e.CHM(t).$implicit,T=e.oxw(2);return e.KtG(T.viewReceipts(l))}),e._uU(8," Receipts "),e.qZA()()()()}}function pe(n,r){1&n&&e._UZ(0,"tr",28)}function me(n,r){1&n&&e._UZ(0,"tr",29)}function de(n,r){1&n&&(e.TgZ(0,"tr",30)(1,"td",31),e._uU(2," You have no public keys "),e.qZA()())}function ue(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-paginator",32),e.NdJ("page",function(s){e.CHM(t);const l=e.oxw(2);return e.KtG(l.changePage(s))}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("length",t.totalItems)("pageSize",t.pageSize)("pageIndex",t.pageIndex)}}function ge(n,r){if(1&n&&(e.TgZ(0,"div",4)(1,"table",5),e.ynx(2,6),e.YNc(3,G,2,0,"th",7),e.YNc(4,X,2,1,"td",8),e.BQk(),e.ynx(5,9),e.YNc(6,ee,2,0,"th",10),e.YNc(7,te,2,1,"td",11),e.BQk(),e.ynx(8,12),e.YNc(9,ne,2,0,"th",10),e.YNc(10,ae,2,1,"td",11),e.BQk(),e.ynx(11,13),e.YNc(12,oe,2,0,"th",10),e.YNc(13,ie,3,3,"td",11),e.BQk(),e.ynx(14,14),e.YNc(15,se,2,0,"th",10),e.YNc(16,re,2,1,"td",11),e.BQk(),e.ynx(17,15),e.YNc(18,le,2,0,"th",10),e.YNc(19,ce,9,0,"td",11),e.BQk(),e.YNc(20,pe,1,0,"tr",16),e.YNc(21,me,1,0,"tr",17),e.YNc(22,de,3,0,"tr",18),e.qZA()(),e.YNc(23,ue,1,3,"mat-paginator",19)),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(19),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(2),e.Q6J("ngIf",t.totalItems>t.pageSize)}}let he=(()=>{class n{constructor(t,a,s){this.dialog=t,this.cryptoService=a,this.generalService=s,this.invokeViewReceipts=new e.vpe,this.isLoading=!0,this.dataSource=[],this.pageIndex=0,this.pageSize=5,this.totalItems=0,this.displayedColumns=["name","domain","email","created","enabled","actions"]}ngOnInit(){this.getKeys()}deleteKey(t){this.dialog.open(E.z,{width:"500px",data:{title:`Delete ${t.subject}`,description_extra:`You are deleting the public key belonging to <br/><span class="fw-bold">${t.subject} - ${t.email}</span> <br/><br/> Do you want to continue?`,action_btn:"Delete",action_btn_color:"warn",bold_description:!0}}).afterClosed().subscribe(a=>{"confirm"===a&&this.cryptoService.deletePublicKey(t.id).subscribe({next:()=>{this.generalService.showFeedback("Public key successfully deleted","successMessage"),this.getKeys(),this.getCount()},error:s=>this.generalService.showFeedback(s?.error?.message??s,"errorMessage")})})}enabledChanged(t,a){this.cryptoService.setEnabled(a.id,t.checked).subscribe({next:()=>{this.generalService.showFeedback("Key was successfully "+(t.checked?"enabled":"disabled"),"successMessage"),this.getKeys()},error:s=>this.generalService.showFeedback(s?.error?.message??s,"errorMessage")})}viewDetails(t){const a={...t};a.original_content=t.content,this.dialog.open($,{width:"80vw",panelClass:["light"],data:{key:a}}).afterClosed().subscribe(s=>{!0===s&&this.getKeys()})}viewReceipts(t){this.invokeViewReceipts.emit({key:t,index:1})}changePage(t){this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.getKeys(!1)}getKeys(t=!0){this.generalService.showLoading(),this.cryptoService.publicKeys({filter:"",offset:this.pageIndex*this.pageSize,limit:this.pageSize}).subscribe({next:a=>{if(this.dataSource=a||[],!t)return this.generalService.hideLoading(),void(this.isLoading=!1);this.getCount()},error:a=>{this.generalService.hideLoading(),this.generalService.showFeedback(a?.error?.message??a,"errorMessage")}})}getCount(){this.cryptoService.countPublicKeys({filter:""}).subscribe({next:a=>{this.generalService.hideLoading(),this.totalItems=a.count,this.isLoading=!1},error:a=>{this.generalService.hideLoading(),this.generalService.showFeedback(a?.error?.message??a,"errorMessage")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.uw),e.Y36(g.$),e.Y36(p.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-cryptography-public-keys"]],outputs:{invokeViewReceipts:"invokeViewReceipts"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loaded",""],[1,"px-2","py-4"],["amount","5","blockHeight","40px","hasShadow","false"],[1,"table-responsive","mt-1"],["mat-table","",1,"w-100","borderless","hoverable",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","class","text-truncate px-sm-3",4,"matHeaderCellDef"],["mat-cell","","class","text-truncate px-sm-3",4,"matCellDef"],["matColumnDef","domain"],["mat-header-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","created"],["matColumnDef","enabled"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"length","pageSize","pageIndex","page",4,"ngIf"],["mat-header-cell","",1,"text-truncate","px-sm-3"],["mat-cell","",1,"text-truncate","px-sm-3"],["mat-header-cell","",1,"text-nowrap","px-sm-3","small-table-column"],["mat-cell","",1,"text-nowrap","px-sm-3","small-table-column"],["color","primary",3,"checked","change"],[1,"d-flex","justify-content-between","align-items-center"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","6",1,"mat-cell"],[3,"length","pageSize","pageIndex","page"]],template:function(t,a){if(1&t&&(e.YNc(0,V,3,0,"ng-container",0),e.YNc(1,ge,24,4,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",a.isLoading)("ngIfElse",s)}},dependencies:[c.O5,I.J,v.lW,H.oG,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,_.Ee,F.NW,R.$]}),n})();function ye(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",2),e._UZ(2,"app-loading-skeleton",3),e.qZA(),e.BQk())}function _e(n,r){1&n&&(e.TgZ(0,"th",17),e._uU(1," Request "),e.qZA())}function fe(n,r){if(1&n&&(e.TgZ(0,"td",18)(1,"pre",19),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.request)}}function be(n,r){1&n&&(e.TgZ(0,"th",20),e._uU(1," Response "),e.qZA())}function ve(n,r){if(1&n&&(e.TgZ(0,"td",21)(1,"pre",19),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.response)}}function Ce(n,r){1&n&&(e.TgZ(0,"th",20),e._uU(1," Created "),e.qZA())}function xe(n,r){if(1&n&&(e.TgZ(0,"td",21),e._uU(1),e.ALo(2,"since"),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.created)," ")}}function Te(n,r){1&n&&e._UZ(0,"tr",22)}function we(n,r){1&n&&e._UZ(0,"tr",23)}function Ze(n,r){1&n&&(e.TgZ(0,"tr",24)(1,"td",25),e._uU(2," No receipts "),e.qZA()())}function Ke(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"table",5),e.ynx(2,6),e.YNc(3,_e,2,0,"th",7),e.YNc(4,fe,3,1,"td",8),e.BQk(),e.ynx(5,9),e.YNc(6,be,2,0,"th",10),e.YNc(7,ve,3,1,"td",11),e.BQk(),e.ynx(8,12),e.YNc(9,Ce,2,0,"th",10),e.YNc(10,xe,3,3,"td",11),e.BQk(),e.YNc(11,Te,1,0,"tr",13),e.YNc(12,we,1,0,"tr",14),e.YNc(13,Ze,3,0,"tr",15),e.qZA()(),e.TgZ(14,"mat-paginator",16),e.NdJ("page",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.changePage(s))}),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(10),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(2),e.Q6J("length",t.totalItems)("pageSize",t.pageSize)}}let Me=(()=>{class n{constructor(t,a){this.cryptoService=t,this.generalService=a,this.dataSource=[],this.isLoading=!0,this.pageIndex=0,this.pageSize=5,this.totalItems=0,this.displayedColumns=["request","response","created"]}ngOnInit(){this.getInvocations()}changePage(t){this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.getInvocations(!1)}getInvocations(t=!0){this.generalService.showLoading();const a={};this.selectedServerKey&&(a.crypto_key=this.selectedServerKey.id),this.cryptoService.invocations({filter:a,offset:this.pageIndex*this.pageSize,limit:this.pageSize}).subscribe({next:s=>{this.dataSource=s||[],t?this.getCount():this.generalService.hideLoading()},error:s=>{this.generalService.hideLoading(),this.generalService.showFeedback(s?.error?.message??s,"errorMessage")}})}getCount(){const t={};this.selectedServerKey&&(t.crypto_key=this.selectedServerKey.id),this.cryptoService.countInvocations({filter:t}).subscribe({next:a=>{this.generalService.hideLoading(),this.isLoading=!1,this.totalItems=a.count},error:a=>{this.generalService.hideLoading(),this.generalService.showFeedback(a?.error?.message??a,"errorMessage")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.$),e.Y36(p.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-cryptography-receipts"]],inputs:{selectedServerKey:"selectedServerKey"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loaded",""],[1,"px-2","py-4"],["amount","5","blockHeight","40px","hasShadow","false"],[1,"table-responsive","mt-1"],["mat-table","",1,"w-100","borderless","hoverable",3,"dataSource"],["matColumnDef","request"],["mat-header-cell","","class","text-truncate px-sm-3",4,"matHeaderCellDef"],["mat-cell","","class","text-truncate px-sm-3",4,"matCellDef"],["matColumnDef","response"],["mat-header-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matCellDef"],["matColumnDef","created"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"length","pageSize","page"],["mat-header-cell","",1,"text-truncate","px-sm-3"],["mat-cell","",1,"text-truncate","px-sm-3"],[1,"text-muted"],["mat-header-cell","",1,"text-nowrap","px-sm-3","small-table-column"],["mat-cell","",1,"text-nowrap","px-sm-3","small-table-column"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell","text-muted"]],template:function(t,a){if(1&t&&(e.YNc(0,ye,3,0,"ng-container",0),e.YNc(1,Ke,15,5,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",a.isLoading)("ngIfElse",s)}},dependencies:[c.O5,I.J,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,_.Ee,F.NW,R.$],encapsulation:2}),n})();const Ae=["tableComponent"];function Se(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-cryptography-public-keys",21,22),e.NdJ("invokeViewReceipts",function(s){e.CHM(t);const l=e.oxw();return e.KtG(l.invokeViewReceipts(s))}),e.qZA()}}function ke(n,r){if(1&n&&e._UZ(0,"app-cryptography-receipts",23),2&n){const t=e.oxw();e.Q6J("selectedServerKey",t.selectedServerKey)}}let Pe=(()=>{class n{constructor(t,a,s,l){this.dialog=t,this.clipboard=a,this.cryptoService=s,this.generalService=l,this.publicKeyFull=null,this.selectedTabIndex=0}ngOnInit(){this.getServerPublicKey()}copy(t){this.clipboard.copy(t),this.generalService.showFeedback("Public key can be found on your clipboard","successMessage")}tabChanged(t){this.selectedTabIndex=t,0===this.selectedTabIndex&&(this.selectedServerKey=null)}invokeViewReceipts(t){this.selectedServerKey=t.key,this.selectedTabIndex=t.index}newKey(t){this.dialog.open(j,{width:"800px",data:{type:t}}).afterClosed().subscribe(a=>{!0===a&&(this.tableComponent.getKeys(),"create"===t&&this.getServerPublicKey())})}getServerPublicKey(){this.generalService.showLoading(),this.cryptoService.serverPublicKey().subscribe({next:t=>{"FAILURE"!==t.result?this.publicKeyFull=t:this.generalService.showFeedback("No server key pair found, please create one","errorMessage")},error:t=>{this.generalService.hideLoading(),this.generalService.showFeedback(t?.error?.message??t,"errorMessage")}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.uw),e.Y36(U.TU),e.Y36(g.$),e.Y36(p.m))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-cryptography"]],viewQuery:function(t,a){if(1&t&&e.Gf(Ae,5),2&t){let s;e.iGM(s=e.CRH())&&(a.tableComponent=s.first)}},decls:53,vars:6,consts:[[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","flex-sm-row","flex-column","align-items-sm-center","mb-4"],[1,"my-0","fw-bold"],[1,"ms-auto"],["mat-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"col-lg-6","col-12"],[1,"col-12","py-2"],[1,"fw-bold"],[1,"mat-caption","text-muted"],[1,"col-sm-4","col-12"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"fw-bold","my-0"],[1,"mat-caption","text-muted","word-break"],[1,"row","mt-4"],[1,"pb-2"],["mat-stretch-tabs","","dynamicHeight","","animationDuration","0ms",3,"selectedIndex","selectedIndexChange"],["label","Keys"],["matTabContent",""],["label","Receipts"],[3,"invokeViewReceipts"],["tableComponent",""],[3,"selectedServerKey"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card")(3,"mat-card-content")(4,"div",0)(5,"div",1)(6,"div",2)(7,"h3",3),e._uU(8,"Server key"),e.qZA(),e.TgZ(9,"div",4)(10,"button",5),e.NdJ("click",function(){return a.newKey("import")}),e._uU(11," Import key "),e.qZA(),e.TgZ(12,"button",6),e.NdJ("click",function(){return a.newKey("create")}),e._uU(13," New key "),e.qZA()()()(),e.TgZ(14,"div",7)(15,"div",0)(16,"div",8)(17,"p",9),e._uU(18,"Fingerprint"),e.qZA(),e.TgZ(19,"p",10),e._uU(20),e.qZA()(),e.TgZ(21,"div",11)(22,"p",9),e._uU(23,"Fingerprint format"),e.qZA(),e.TgZ(24,"p",10),e._uU(25),e.qZA()(),e.TgZ(26,"div",11)(27,"p",9),e._uU(28,"Key format"),e.qZA(),e.TgZ(29,"p",10),e._uU(30),e.qZA()(),e.TgZ(31,"div",11)(32,"p",9),e._uU(33,"Key type"),e.qZA(),e.TgZ(34,"p",10),e._uU(35),e.qZA()()()(),e.TgZ(36,"div",7)(37,"div",12)(38,"p",13),e._uU(39,"Public key"),e.qZA(),e.TgZ(40,"button",5),e.NdJ("click",function(){return a.copy(null==a.publicKeyFull?null:a.publicKeyFull.publicKey)}),e._uU(41," Copy key "),e.qZA()(),e.TgZ(42,"p",14),e._uU(43),e.qZA()()()()()()(),e.TgZ(44,"div",15)(45,"div",1)(46,"mat-card",16)(47,"mat-card-content")(48,"mat-tab-group",17),e.NdJ("selectedIndexChange",function(l){return a.tabChanged(l)}),e.TgZ(49,"mat-tab",18),e.YNc(50,Se,2,0,"ng-template",19),e.qZA(),e.TgZ(51,"mat-tab",20),e.YNc(52,ke,1,1,"ng-template",19),e.qZA()()()()()()),2&t&&(e.xp6(20),e.Oqu(null==a.publicKeyFull?null:a.publicKeyFull.fingerprint),e.xp6(5),e.Oqu(null==a.publicKeyFull?null:a.publicKeyFull.fingerprintFormat),e.xp6(5),e.Oqu(null==a.publicKeyFull?null:a.publicKeyFull.keyFormat),e.xp6(5),e.Oqu(null==a.publicKeyFull?null:a.publicKeyFull.keyType),e.xp6(8),e.Oqu(null==a.publicKeyFull?null:a.publicKeyFull.publicKey),e.xp6(5),e.Q6J("selectedIndex",a.selectedTabIndex))},dependencies:[v.lW,D.SP,D.uX,D.Vc,N.a8,N.dn,he,Me],styles:[".word-break[_ngcontent-%COMP%]{line-height:1}"]}),n})();var J=i(9132);const Oe=[{path:"",component:Pe}];let De=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[J.Bz.forChild(Oe),J.Bz]}),n})();var Ue=i(7832),Ne=i(2278),Ee=i(1075),Ie=i(1717),Fe=i(1103);let Re=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,De,Ue.K,Ne.q,Ee.m,m.u5,Ie.h,Fe.k]}),n})()},1717:(M,b,i)=>{i.d(b,{h:()=>e});var c=i(6895),d=i(4006),o=i(1103),x=i(4650);let e=(()=>{class u{}return u.\u0275fac=function(p){return new(p||u)},u.\u0275mod=x.oAB({type:u}),u.\u0275inj=x.cJS({imports:[c.ez,o.k,d.u5]}),u})()}}]);