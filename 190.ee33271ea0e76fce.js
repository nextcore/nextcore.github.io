"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[190],{9311:(D,g,r)=>{r.d(g,{J:()=>b});var c=r(4650),u=r(6895);const _=function(m){return{height:m}};function v(m,h){if(1&m&&(c.TgZ(0,"div"),c._UZ(1,"div",2),c.qZA()),2&m){const d=c.oxw();c.Tol(d.colClass),c.xp6(1),c.ekj("mat-elevation-z1",d.hasShadow),c.Q6J("ngStyle",c.VKq(5,_,d.blockHeight))}}let b=(()=>{class m{constructor(){this.amount=2,this.colClass="col-12",this.blockHeight="375px",this.hasShadow=!0,this.itemsArray=[]}ngOnInit(){for(let d=0;d<this.amount;d++)this.itemsArray.push("item"+d)}}return m.\u0275fac=function(d){return new(d||m)},m.\u0275cmp=c.Xpm({type:m,selectors:[["app-loading-skeleton"]],inputs:{amount:"amount",colClass:"colClass",blockHeight:"blockHeight",hasShadow:"hasShadow"},decls:2,vars:1,consts:[[1,"row"],[3,"class",4,"ngFor","ngForOf"],[1,"block","mb-3",3,"ngStyle"]],template:function(d,t){1&d&&(c.TgZ(0,"div",0),c.YNc(1,v,2,7,"div",1),c.qZA()),2&d&&(c.xp6(1),c.Q6J("ngForOf",t.itemsArray))},dependencies:[u.sg,u.PC],styles:[".block[_ngcontent-%COMP%]{background:#eee;background:linear-gradient(90deg,#ffffff 8%,#f2f2f2 18%,#fafafa 33%);background-size:200% 100%;animation:1s shine linear infinite;border-radius:5px;border:1px solid rgba(217,217,217,.05)}@keyframes shine{to{background-position-x:-200%}}"]}),m})()},4190:(D,g,r)=>{r.r(g),r.d(g,{EndpointsModule:()=>Zt});var c=r(6895),u=r(4006),_=r(1103),v=r(2278),b=r(1075),m=r(7832),h=r(9132),d=r(1135),t=r(4650),y=r(3885),k=r(6463),T=r(4859),E=r(3546),L=r(316),J=r(6996),Z=r(4425),S=r(5938),Q=r(9214),A=r(8710),M=r(7392),f=r(7084),C=r(9328),F=r(9311),I=r(6234);const N=["assumptions"];function R(n,a){1&n&&(t.TgZ(0,"span",25),t._uU(1," \xa0-Syntax error"),t.qZA())}function U(n,a){if(1&n&&(t.TgZ(0,"div",22)(1,"div",26)(2,"p",27),t._uU(3,"Response content type:"),t.qZA()(),t.TgZ(4,"div",28)(5,"p",29),t._uU(6),t.qZA()()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.hij(" ",null==e?null:e.produces," ")}}function j(n,a){if(1&n&&(t.TgZ(0,"div",22)(1,"div",26)(2,"p",27),t._uU(3,"Request content type:"),t.qZA()(),t.TgZ(4,"div",28)(5,"p",29),t._uU(6),t.qZA()()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.hij(" ",null==e?null:e.consumes," ")}}function P(n,a){if(1&n&&(t.TgZ(0,"div",22)(1,"div",26)(2,"p",27),t._uU(3,"Endpoint type:"),t.qZA()(),t.TgZ(4,"div",28)(5,"p",29),t._uU(6),t.qZA()()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.hij(" ",null==e?null:e.type," ")}}function Y(n,a){1&n&&(t.ynx(0),t._uU(1,","),t.BQk())}function B(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,Y,2,0,"ng-container",3),t.qZA()),2&n){const e=a.$implicit,i=a.last;t.xp6(1),t.hij(" ",e,""),t.xp6(1),t.Q6J("ngIf",!i)}}function $(n,a){if(1&n&&(t.TgZ(0,"div",22)(1,"div",26)(2,"p",27),t._uU(3,"Roles:"),t.qZA()(),t.TgZ(4,"div",28)(5,"p",29),t.YNc(6,B,3,2,"span",30),t.qZA()()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.Q6J("ngForOf",null==e?null:e.auth)}}function q(n,a){if(1&n&&(t.TgZ(0,"div",22)(1,"div",26)(2,"p",27),t._uU(3,"Description:"),t.qZA()(),t.TgZ(4,"div",28)(5,"p",29),t._uU(6),t.qZA()()()),2&n){const e=t.oxw().$implicit;t.xp6(6),t.hij(" ",null==e?null:e.description," ")}}function H(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-expansion-panel",9),t.NdJ("opened",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.panelExpanded(s))}),t.TgZ(1,"mat-expansion-panel-header",10,11)(3,"mat-panel-title")(4,"div",12)(5,"div",13)(6,"span"),t._uU(7),t.qZA(),t._uU(8),t.YNc(9,R,2,0,"span",14),t.qZA(),t.TgZ(10,"div")(11,"button",15),t.NdJ("click",function(o){const l=t.CHM(e).$implicit;return t.oxw(2).requestEditor(l),t.KtG(o.stopPropagation())}),t.TgZ(12,"mat-icon"),t._uU(13,"start"),t.qZA()(),t.TgZ(14,"button",15),t.NdJ("click",function(o){const l=t.CHM(e).$implicit;return t.oxw(2).copyUrl(l.path),t.KtG(o.stopPropagation())}),t.TgZ(15,"mat-icon"),t._uU(16,"content_copy"),t.qZA()()()()()(),t.TgZ(17,"div",16),t.YNc(18,U,7,1,"div",17),t.YNc(19,j,7,1,"div",17),t.YNc(20,P,7,1,"div",17),t.YNc(21,$,7,1,"div",17),t.YNc(22,q,7,1,"div",17),t.ynx(23),t.TgZ(24,"div",18)(25,"div",19),t._UZ(26,"app-assumptions",20,21),t.qZA()(),t.BQk(),t.TgZ(28,"div",22)(29,"div",23)(30,"button",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.deleteEndpoint(s))}),t._uU(31," Delete "),t.qZA()()()()()}if(2&n){const e=a.$implicit,i=t.oxw(2);t.xp6(6),t.Gre("span me-3 methods ",null==e?null:e.verb,""),t.xp6(1),t.Oqu("delete"===(null==e?null:e.verb)?"del":e.verb),t.xp6(1),t.hij(" /",i.getPath(null==e?null:e.path)," "),t.xp6(1),t.Q6J("ngIf",null==e?null:e.error),t.xp6(9),t.Q6J("ngIf",null==e?null:e.produces),t.xp6(1),t.Q6J("ngIf",null==e?null:e.consumes),t.xp6(1),t.Q6J("ngIf",null==e?null:e.type),t.xp6(1),t.Q6J("ngIf",null==e?null:e.auth),t.xp6(1),t.Q6J("ngIf",null==e?null:e.description),t.xp6(4),t.Q6J("itemDetails",e)("result",i.result)("payload",i.payload)}}function z(n,a){if(1&n&&(t.TgZ(0,"mat-expansion-panel",4)(1,"mat-expansion-panel-header",5)(2,"mat-panel-title",6),t._uU(3),t.qZA()(),t.TgZ(4,"mat-accordion",7),t.YNc(5,H,32,14,"mat-expansion-panel",8),t.qZA()()),2&n){const e=a.$implicit;t.ekj("d-none",0===e.value.length),t.xp6(3),t.hij(" ",e.key," "),t.xp6(2),t.Q6J("ngForOf",e.value)}}function K(n,a){1&n&&(t.ynx(0),t._UZ(1,"app-loading-skeleton",31)(2,"app-loading-skeleton",32),t.BQk())}let G=(()=>{class n{constructor(e,i,o,s,l){this.clipboard=e,this.dialog=i,this.generalService=o,this.fileService=s,this.backendService=l,this.endpoints=[],this.defaultListToShow="system",this.changeEditor=new t.vpe,this.reload=new t.vpe}panelExpanded(e){e.expanded=!0}deleteEndpoint(e){const i=e.path.substring(e.path.lastIndexOf("/")+1);this.dialog.open(J.z,{width:"500px",data:{title:`Delete endpoint ${i}`,description_extra:`This action cannot be undone and will be permanent.<br/><br/>Please type in <span class="fw-bold">${i}</span> below.`,action_btn:"Delete endpoint",action_btn_color:"warn",bold_description:!0,extra:{details:e,action:"confirmInput",fieldToBeTypedTitle:"path",fieldToBeTypedValue:i,icon:"delete"}}}).afterClosed().subscribe(o=>{"confirm"===o&&(this.generalService.showLoading(),this.fileService.deleteFile(e.path.substring(5)+"."+e.verb+".hl").subscribe({next:()=>{this.generalService.hideLoading(),this.generalService.showFeedback("Endpoint successfully deleted"),this.reload.emit({})},error:s=>{this.generalService.hideLoading(),this.generalService.showFeedback(s?.error?.message??s,"errorMessage")}}))})}getPath(e){return e.split("?")[0]}requestEditor(e){e.path=e.path.split("?")[0],this.selectedItem=e,this.changeEditor.emit(e)}copyUrl(e){this.clipboard.copy(this.backendService.active.url+"/"+e),this.generalService.showFeedback("URL is copied to your clipboard")}trackFilterList(e){return e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.TU),t.Y36(S.uw),t.Y36(y.m),t.Y36(Q.I),t.Y36(A.v))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-endpoints-list"]],viewQuery:function(e,i){if(1&e&&t.Gf(N,5),2&e){let o;t.iGM(o=t.CRH())&&(i.assumptions=o.first)}},inputs:{endpoints:"endpoints",defaultListToShow:"defaultListToShow",result:"result",payload:"payload",isLoading:"isLoading"},outputs:{changeEditor:"changeEditor",reload:"reload"},decls:8,vars:14,consts:[["displayMode","flat","multi","",1,"endpoints-list"],["appendOnly","","itemSize","5",1,"virtual-viewport",3,"maxBufferPx"],["class","mat-elevation-z0",3,"d-none",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[4,"ngIf"],[1,"mat-elevation-z0"],[1,"ps-0","pe-3"],[1,"text-muted","px-2"],["multi",""],["class","mat-elevation-z1 mb-3","id","inner-panel",3,"opened",4,"ngFor","ngForOf"],["id","inner-panel",1,"mat-elevation-z1","mb-3",3,"opened"],[1,"px-3","py-2"],["header",""],[1,"d-flex","justify-content-between","align-items-center","w-100"],[1,"d-flex","justify-content-between","align-items-center","word-break"],["class","text-danger mat-caption",4,"ngIf"],["mat-icon-button","","color","primary",1,"copy-btn",3,"click"],[1,"container","box-sizing","mt-4"],["class","row mb-2",4,"ngIf"],[1,"row","mt-4"],[1,"col-12"],[3,"itemDetails","result","payload"],["assumptions",""],[1,"row","mb-2"],[1,"col-col-12","d-flex","justify-content-end","px-0"],["mat-button","","color","warn",3,"click"],[1,"text-danger","mat-caption"],[1,"col-xxl-4","col-sm-5","col-12"],[1,"text-muted","my-0"],[1,"col-xxl-8","col-sm-7","col-12"],[1,"my-0"],[4,"ngFor","ngForOf"],["amount","1","colClass","col-12","blockHeight","64px"],["amount","5","colClass","col-12","blockHeight","56px"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-accordion",0),t.ALo(1,"async"),t.TgZ(2,"cdk-virtual-scroll-viewport",1),t.ALo(3,"keyvalue"),t.YNc(4,z,6,4,"mat-expansion-panel",2),t.ALo(5,"keyvalue"),t.qZA()(),t.YNc(6,K,3,0,"ng-container",3),t.ALo(7,"async")),2&e){let o;t.ekj("d-none",t.lcZ(1,6,i.isLoading)),t.xp6(2),t.Q6J("maxBufferPx",1e3*(null==(o=t.lcZ(3,8,i.endpoints[i.defaultListToShow]))?null:o.length)||200),t.xp6(2),t.Q6J("cdkVirtualForOf",t.lcZ(5,10,i.endpoints[i.defaultListToShow]))("cdkVirtualForTrackBy",i.trackFilterList),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,12,i.isLoading))}},dependencies:[c.sg,c.O5,M.Hw,T.lW,f.pp,f.ib,f.yz,f.yK,C.xd,C.x0,C.N7,F.J,I.x,c.Ov,c.Nd],styles:[".endpoints-list .mat-expansion-panel-body{padding-left:0;padding-right:0;margin-left:3px;margin-right:3px}  .endpoints-list .mat-content{overflow:visible}  .endpoints-list #inner-panel{border-radius:10px}  .endpoints-list #inner-panel .mat-content{font-size:14px}  .endpoints-list #inner-panel .mat-expansion-panel-header{height:unset;min-height:40px}.methods[_ngcontent-%COMP%]{min-width:50px;min-height:20px;width:50px;height:20px;font-size:10px;border-radius:45px;display:inline-flex;align-items:center;justify-content:center;text-transform:uppercase;color:#fff}.methods.get[_ngcontent-%COMP%]{background-color:#2f80ed}.methods.post[_ngcontent-%COMP%], .methods.socket[_ngcontent-%COMP%]{background-color:#27ae60}.methods.put[_ngcontent-%COMP%], .methods.patch[_ngcontent-%COMP%]{background-color:#e2b93b}.methods.delete[_ngcontent-%COMP%]{background-color:#eb5757}.box-sizing[_ngcontent-%COMP%]{box-sizing:border-box}.copy-btn[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}  .cdk-drag-preview{box-sizing:border-box;border-radius:4px;background-color:#fff;display:flex;align-items:center;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}  .cdk-drag-placeholder{opacity:0}  .cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}  .hoverable-table.cdk-drop-list-dragging .mat-header-cell:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.virtual-viewport[_ngcontent-%COMP%]{height:53vh}.virtual-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-spacer{max-height:100%}.virtual-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 6px transparent;-webkit-box-shadow:inset 0 0 6px transparent;background-color:transparent}.virtual-viewport[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px;background-color:transparent}.virtual-viewport[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:transparent;border-radius:10px}.virtual-viewport[_ngcontent-%COMP%]:hover::-webkit-scrollbar-track{box-shadow:inset 0 0 6px #f5f5f5;-webkit-box-shadow:inset 0 0 6px #f5f5f5;background-color:#f5f5f5}.virtual-viewport[_ngcontent-%COMP%]:hover::-webkit-scrollbar{width:7px;background-color:#f5f5f5}.virtual-viewport[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{background-color:#bdbdbd;border-radius:10px}"]}),n})();var O=r(8317),W=r(2343),V=r(3545),X=r(1794),tt=r(1955),et=r(1935),nt=r(9331),it=r(9669),ot=r(1481),st=r(8531),at=r(8684);function rt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"div",15),t._UZ(2,"app-query-params",16),t.qZA(),t.TgZ(3,"div",15)(4,"p",17),t._uU(5),t.qZA()()()),2&n){const e=a.$implicit,i=t.oxw(3);t.xp6(2),t.Q6J("item",e)("allItems",i.itemDetails.input),t.xp6(3),t.hij(" ",i.getDescription(e)," ")}}function lt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"div",15),t._UZ(2,"app-query-params",16),t.qZA(),t.TgZ(3,"div",15)(4,"p",17),t._uU(5),t.qZA()()()),2&n){const e=a.$implicit,i=t.oxw(3);t.xp6(2),t.Q6J("item",e)("allItems",i.itemDetails.input),t.xp6(3),t.hij(" ",i.getDescription(e)," ")}}function ct(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",8)(2,"div",9)(3,"h3",10),t._uU(4,"Query parameters"),t.qZA()(),t.TgZ(5,"div",11)(6,"form",12),t.YNc(7,rt,6,3,"div",13),t.YNc(8,lt,6,3,"div",13),t.qZA()()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(6),t.Q6J("formGroup",e.paramsForm),t.xp6(1),t.Q6J("ngForOf",e.getArguments(e.itemDetails.input,!0)),t.xp6(1),t.Q6J("ngForOf",e.getArguments(e.itemDetails.input,!1))}}function pt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.payload=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.payload)("options",e.cmOptions.json)}}function dt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.payload=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.payload)("options",e.cmOptionsHyperlambda.json)}}function ut(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.payload=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.payload)("options",e.cmOptionsMarkdown.json)}}function mt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",18)(2,"div",19)(3,"h3",10),t._uU(4,"Body"),t.qZA()(),t.YNc(5,pt,2,2,"ng-container",3),t.YNc(6,dt,2,2,"ng-container",3),t.YNc(7,ut,2,2,"ng-container",3),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf","application/json"===(null==e.itemDetails?null:e.itemDetails.consumes)),t.xp6(1),t.Q6J("ngIf","application/x-hyperlambda"===(null==e.itemDetails?null:e.itemDetails.consumes)),t.xp6(1),t.Q6J("ngIf",null==e.itemDetails||null==e.itemDetails.consumes?null:e.itemDetails.consumes.startsWith("text/"))}}function ht(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.result.response=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.result.response)("options",e.cmOptionsReadonly.json)}}function gt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.result.response=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.result.response)("options",e.cmHlOptionsReadonly.hl)}}function _t(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"ngx-codemirror",20),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.result.response=o)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngModel",e.result.response)("options",e.markdownOptionsReadonly.md)}}function ft(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"img",23),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("src",e.result.blob,t.LSH)}}function xt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",21)(1,"div",19)(2,"h3",10),t._uU(3,"Result"),t.qZA(),t.TgZ(4,"button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.copyResult(o.result.response))}),t.TgZ(5,"mat-icon"),t._uU(6,"content_copy"),t.qZA(),t._uU(7," Copy result "),t.qZA()(),t.TgZ(8,"p")(9,"span"),t._uU(10),t.qZA(),t._uU(11,"\xa0 "),t.TgZ(12,"span"),t._uU(13),t.qZA()(),t.YNc(14,ht,2,2,"ng-container",3),t.YNc(15,gt,2,2,"ng-container",3),t.YNc(16,_t,2,2,"ng-container",3),t.YNc(17,ft,2,1,"ng-container",3),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(8),t.ekj("text-danger",!e.isSuccess()),t.xp6(1),t.ekj("text-success",e.isSuccess()),t.xp6(1),t.Oqu(e.result.status),t.xp6(3),t.Oqu(e.result.statusText),t.xp6(1),t.Q6J("ngIf","json"===e.result.responseType),t.xp6(1),t.Q6J("ngIf","hyperlambda"===e.result.responseType),t.xp6(1),t.Q6J("ngIf","text"===e.result.responseType),t.xp6(1),t.Q6J("ngIf","blob"===e.result.responseType)}}function vt(n,a){1&n&&(t.ynx(0),t.TgZ(1,"div",24)(2,"h3"),t._uU(3,"Invoke the endpoint to see the result."),t.qZA()(),t.BQk())}function bt(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.YNc(1,ct,9,3,"ng-container",3),t.YNc(2,mt,8,3,"ng-container",3),t.YNc(3,xt,18,10,"div",4),t.YNc(4,vt,4,0,"ng-container",3),t.TgZ(5,"div",5)(6,"button",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.createTest())}),t._uU(7," Save as test case "),t.qZA(),t.TgZ(8,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.invoke())}),t._uU(9," Try it out! "),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.parameters&&e.parameters.length&&("get"===e.itemDetails.verb||"delete"===e.itemDetails.verb)),t.xp6(1),t.Q6J("ngIf",null==e.itemDetails?null:e.itemDetails.consumes),t.xp6(1),t.Q6J("ngIf",e.result),t.xp6(1),t.Q6J("ngIf",!(e.parameters.length||e.result||null!=e.itemDetails&&e.itemDetails.consumes)),t.xp6(2),t.Q6J("disabled",!e.canCreateAssumption),t.xp6(2),t.Q6J("disabled",e.isExecuting)}}function yt(n,a){1&n&&(t.ynx(0),t.TgZ(1,"div",24)(2,"h3",26),t._uU(3,"This endpoint cannot be executed here."),t.qZA()(),t.BQk())}function Tt(n,a){1&n&&(t.TgZ(0,"div",24)(1,"h3"),t._uU(2,"Try something!"),t.qZA()())}function Ct(n,a){if(1&n&&(t.YNc(0,yt,4,0,"ng-container",1),t.ALo(1,"keyvalue"),t.YNc(2,Tt,3,0,"ng-template",null,25,t.W1O)),2&n){const e=t.MAs(3),i=t.oxw();t.Q6J("ngIf",i.itemDetails&&t.lcZ(1,2,i.itemDetails).length&&!i.canInvoke())("ngIfElse",e)}}let wt=(()=>{class n{constructor(e,i,o,s,l,p,x,w,St){this.dialog=e,this.clipboard=i,this.cdr=o,this.sanitizer=s,this.formBuilder=l,this.backendService=p,this.generalService=x,this.endpointService=w,this.assumptionService=St,this.originalPath="",this.refetchAssumptions=new t.vpe,this.itemDetails={},this.parameters=[],this.payload=null,this.result=null,this.isExecuting=!1,this.paramsForm=this.formBuilder.group({}),this.canCreateAssumption=!1,this.cmOptions={json:W},this.cmOptionsHyperlambda={json:X},this.cmOptionsMarkdown={json:V},this.cmOptionsReadonly={json:tt},this.cmHlOptionsReadonly={hl:nt},this.markdownOptionsReadonly={md:et}}ngOnInit(){this.getItemDetails()}getArguments(e,i){return"crud-read"===this.itemDetails.type||"crud-count"===this.itemDetails.type?e.filter(o=>{switch(o.name){case"operator":case"limit":case"offset":case"order":case"direction":case"recaptcha":return i;default:return!i}}):i?[]:e}getDescription(e){if("crud-read"!==this.itemDetails.type&&"crud-count"!==this.itemDetails.type)return`${e.name} equals to`;switch(e.name){case"operator":return"Boolean operator to use for conditions, defaults to 'and'";case"limit":return"Maximum number of items to return, defaults to 25";case"offset":return"Offset from where to return items";case"order":return"Column to sort by";case"direction":return"Direction to sort by, defaults to 'asc'";default:if(-1===e.name.indexOf("."))return e.type;{const i=e.name.substring(e.name.lastIndexOf(".")+1),o=e.name.substring(0,e.name.lastIndexOf("."));switch(i){case"eq":return`'${o}' equal to ${e.type}`;case"neq":return`'${o}' not equal to ${e.type}`;case"mteq":return`'${o}' more than or equal to ${e.type}`;case"lteq":return`'${o}' less than or equal to ${e.type}`;case"lt":return`'${o}' less than ${e.type}`;case"mt":return`'${o}' more than ${e.type}`;case"like":return`'${o}' contains ${e.type}`;default:return""}}}}canInvoke(){return"get"===this.itemDetails?.verb||"delete"===this.itemDetails?.verb||"application/json"===this.itemDetails?.consumes||"application/x-hyperlambda"===this.itemDetails?.consumes||this.itemDetails?.consumes?.startsWith("text/")}invoke(){if(this.itemDetails.path=this.originalPath,Object.values(this.paramsForm.value).length){let i=`${this.itemDetails.path}`;i+="?";for(const o in this.paramsForm.value)this.paramsForm.value[o]&&("date"===this.itemDetails.input.find(l=>l.name===o).type?i+=o+"="+encodeURIComponent(new Date(this.paramsForm.value[o]).toISOString())+"&":i+=o+"="+encodeURIComponent(this.paramsForm.value[o])+"&");this.itemDetails.path=i.substring(0,i.length-1)}this.isExecuting=!0;let e="";e="application/json"===this.itemDetails.produces?"json":"application/x-hyperlambda"===this.itemDetails.produces?"hyperlambda":this.itemDetails.produces.startsWith("text")?"text":"blob";try{let i=null;switch(this.itemDetails.verb){case"get":i=this.endpointService.get(`/${this.itemDetails.path}`,e);break;case"delete":i=this.endpointService.delete(`/${this.itemDetails.path}`,e);break;case"post":{const l="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;i=this.endpointService.post(`/${this.itemDetails.path}`,l,e)}break;case"put":{const l="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;i=this.endpointService.put(`/${this.itemDetails.path}`,l,e)}break;case"patch":{const l="application/json"===this.itemDetails.consumes?JSON.parse(this.payload):this.payload;i=this.endpointService.patch(`/${this.itemDetails.path}`,l,e)}break;case"socket":const s=(new O.su).withUrl(this.backendService.active.url+"/sockets",{accessTokenFactory:()=>this.backendService.active.token.token,skipNegotiation:!0,transport:O.n4.WebSockets}).build();s.start().then(()=>{let l=!0;const p=`/${this.itemDetails.path}`.substring(14);s.invoke("execute",p,this.payload).catch(()=>{this.generalService.showFeedback("Something went wrong as we tried to invoke socket endpoint"),l=!1,this.isExecuting=!1}).then(()=>{s.stop(),l&&(this.isExecuting=!1,this.generalService.showFeedback("Socket invocation was successful"))})})}if(i){const o=new Date;this.generalService.showLoading(),i.subscribe({next:s=>{const p=(new Date).getTime()-o.getTime(),x="json"===e?JSON.stringify(s.body||"{}",null,2):s.body;if(this.result={status:s.status,statusText:s.statusText+" in "+new Intl.NumberFormat("en-us").format(p)+" milliseconds",response:x,blob:null,responseType:e},"blob"===e){const w=URL.createObjectURL(x);this.result.blob=this.sanitizer.bypassSecurityTrustUrl(w)}this.isExecuting=!1,this.canCreateAssumption=!0,this.generalService.hideLoading()},error:s=>{this.isExecuting=!1,this.canCreateAssumption=!0,this.result={status:s.status,statusText:s.statusText,response:JSON.stringify(s.error||"{}",null,2),blob:null,responseType:e},this.generalService.hideLoading()}})}}catch(i){this.isExecuting=!1,this.canCreateAssumption=!0,this.generalService.showFeedback(i?.error?.message??i,"errorMessage")}}isSuccess(){return this.result&&this.result.status>=200&&this.result.status<400}inputTypes(e){switch(e){case"bool":case"string":return"text";case"long":case"int":case"uint":case"short":case"ushort":return"number";case"date":return"date"}}copyResult(e){this.clipboard.copy(e),this.generalService.showFeedback("Result can be found on your clipboard")}createTest(){this.dialog.open(it.V,{width:"550px"}).afterClosed().subscribe(i=>{i&&this.assumptionService.create(i.filename,this.itemDetails.verb,`/${this.itemDetails.path}`,this.result?.status,""!==i.description?i.description:null,""!==this.payload?this.payload:null,i.matchResponse&&!this.result?.blob?this.result?.response:null,this.itemDetails.produces).subscribe({next:()=>{this.generalService.showLoading(),i.matchResponse&&this.result.blob?this.generalService.showFeedback("Assumption successfully saved. Notice, blob types of invocations cannot assume response equality.","successMessage","Ok",5e3):this.generalService.showFeedback("Assumption successfully saved","successMessage"),this.refetchAssumptions.emit()},error:o=>{this.generalService.hideLoading(),this.generalService.showFeedback(o?.error?.message??o,"errorMessage")}})})}getItemDetails(){this.itemToBeTried.subscribe(e=>{this.canCreateAssumption=!1,e&&Object.keys(e).length&&(this.itemDetails=[],this.parameters=[],this.result=null,this.paramsForm=this.formBuilder.group({}),this.prepareData(e))})}prepareData(e){if(this.itemDetails=e,this.originalPath=e.path,e.input&&this.setForm(),this.getParams(),"application/json"===this.itemDetails.consumes){let o={};for(var i of this.itemDetails.input??[]){let s=i.type;switch(s){case"long":case"ulong":case"int":case"uint":case"short":case"ushort":s=42;break;case"date":s=(new Date).toISOString();break;case"bool":s=!0;break;case"string":s="foo";break;case"decimal":case"float":case"double":s=5.5}o[i.name]=s}setTimeout(()=>this.payload=JSON.stringify(o,null,2),250),setTimeout(()=>{document.querySelectorAll(".CodeMirror").forEach(s=>{var p=s.CodeMirror;p.doc.markClean(),p.doc.clearHistory()})},800)}else("application/x-hyperlambda"===this.itemDetails.consumes||this.itemDetails?.consumes?.startsWith("text/"))&&setTimeout(()=>this.payload="",250);this.cdr.detectChanges()}getParams(){this.parameters=this.itemDetails.input?.map(e=>e.name)||[]}setForm(){this.itemDetails.input.forEach(e=>{this.paramsForm.setControl(e.name,new u.NI(""))}),this.cdr.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S.uw),t.Y36(Z.TU),t.Y36(t.sBO),t.Y36(ot.H7),t.Y36(u.qu),t.Y36(A.v),t.Y36(y.m),t.Y36(k.B),t.Y36(st.D))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-endpoints-result"]],inputs:{itemToBeTried:"itemToBeTried"},outputs:{refetchAssumptions:"refetchAssumptions"},decls:5,vars:4,consts:[[1,"d-flex","flex-column","h-100","w-100"],[4,"ngIf","ngIfElse"],["noInvocation",""],[4,"ngIf"],["class","d-flex flex-column w-100 h-100 endpoint-result",4,"ngIf"],[1,"d-flex","justify-content-end","button-row","mt-3"],["mat-button","","color","primary",1,"px-sm-4",3,"disabled","click"],["mat-flat-button","","color","primary",1,"px-sm-4",3,"disabled","click"],[1,"row","mb-3"],[1,"col-12","mb-3"],[1,"my-0","fw-bold"],[1,"col-12","params-wrapper"],["novalidate","",3,"formGroup"],["class","row align-items-center params-inputs",4,"ngFor","ngForOf"],[1,"row","align-items-center","params-inputs"],[1,"col-sm-6","col-12"],[3,"item","allItems"],[1,"my-0","ms-3"],[1,"d-flex","flex-column","w-100","h-100","endpoint-result","mb-3"],[1,"d-flex","justify-content-between","align-items-center","w-100","mb-3"],[1,"h-100",3,"ngModel","options","ngModelChange"],[1,"d-flex","flex-column","w-100","h-100","endpoint-result"],["mat-button","","color","primary",1,"copy-btn",3,"click"],["alt","Image resulting from invocation","width","250",1,"d-block","m-auto",3,"src"],[1,"m-auto"],["noEndpointSelected",""],[1,"fw-bold"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,bt,10,6,"ng-container",1),t.ALo(2,"keyvalue"),t.YNc(3,Ct,4,4,"ng-template",null,2,t.W1O),t.qZA()),2&e){const o=t.MAs(4);t.xp6(1),t.Q6J("ngIf",i.itemDetails&&t.lcZ(2,2,i.itemDetails).length&&i.canInvoke())("ngIfElse",o)}},dependencies:[c.sg,c.O5,u._Y,u.JJ,u.JL,u.On,u.sg,M.Hw,T.lW,_.C,at.$,c.Nd],styles:[".endpoint-result .CodeMirror{height:100%}.params-inputs[_ngcontent-%COMP%]     .mat-form-field-appearance-outline .mat-form-field-infix{padding-top:3px;padding-bottom:8px}.params-inputs[_ngcontent-%COMP%]     .mat-form-field-prefix{font-size:11px;top:-1px}.params-inputs[_ngcontent-%COMP%]     .min-width{min-width:100px}.params-wrapper[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.copy-btn[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;line-height:20px}.h-100[_ngcontent-%COMP%]{max-height:100%;overflow:hidden}"]}),n})();const kt=[{path:"",component:(()=>{class n{constructor(e,i){this.generalService=e,this.endpointsService=i,this.selectedDb="Magic",this.endpoints=[],this.originalEndpoints=[],this.defaultListToShow="",this.searchKey="",this.itemToBeTried=new d.X({}),this.isLoading=new d.X(!0)}ngOnInit(){this.getEndpoints()}getEndpoints(){this.endpointsService.endpoints().subscribe({next:e=>{if(e){let i=[];i.other=e.reduce((o,s)=>{if("internal"!==s.type&&!s.path.startsWith("magic/system/magic/")){let l=s.path.split("/");l.splice(0,1),l.splice(2);const p=l.join("/");o[p]=o[p]||[],o[p].push(s)}return o},Object.create(null)),i.system=e.reduce((o,s)=>{let l=s.path.split("/");l.splice(0,1),l.splice(2);const p=l.join("/");return o[p]=o[p]||[],o[p].push(s),o},Object.create(null)),this.defaultListToShow=i.other&&Object.keys(i.other).length?"other":"system",this.originalEndpoints=i,this.endpoints={...this.originalEndpoints},this.isLoading.next(!1)}},error:e=>this.generalService.showFeedback(e?.error?.message??e,"errorMessage")})}reloadEndpoints(e){this.getEndpoints()}filterList(e){this.defaultListToShow=e.checked?"system":"other";let i={...this.originalEndpoints[this.defaultListToShow]};e.searchKey&&Object.keys(i).map(o=>{i[o]=i[o].filter(s=>s.path.indexOf(e.searchKey)>-1)}),this.endpoints[this.defaultListToShow]=i}changeEditor(e){this.itemToBeTried.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.m),t.Y36(k.B))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-endpoints"]],decls:21,vars:6,consts:[[1,"row"],[1,"col-lg-6","col-md-5","col-12"],[1,"d-flex","justify-content-between","align-items-center","flex-lg-row","flex-column"],[1,"my-0","fw-bold"],["mat-flat-button","","color","primary","routerLink","/endpoint-generator",1,"mt-lg-0","mt-3"],[1,"row","mt-3"],[1,"col-12"],["checkBoxText","System endpoints",3,"filterList"],[1,"row","mt-3","scrollable-row"],[3,"defaultListToShow","endpoints","result","payload","isLoading","reload","changeEditor"],["listPanel",""],[1,"col-lg-6","col-md-7","col-12","mt-md-0","mt-4"],[1,"h-100"],[1,"h-100","max-height-full"],[1,"h-100","d-block",3,"itemToBeTried","refetchAssumptions"],["resultPanel",""]],template:function(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"mat-card")(3,"mat-card-content")(4,"div",2)(5,"h3",3),t._uU(6," Endpoints "),t.qZA(),t.TgZ(7,"a",4),t._uU(8,"Generate endpoints"),t.qZA()(),t.TgZ(9,"div",5)(10,"div",6)(11,"app-searchbox",7),t.NdJ("filterList",function(l){return i.filterList(l)}),t.qZA()()(),t.TgZ(12,"div",8)(13,"div",6)(14,"app-endpoints-list",9,10),t.NdJ("reload",function(l){return i.reloadEndpoints(l)})("changeEditor",function(l){return i.changeEditor(l)}),t.qZA()()()()()(),t.TgZ(16,"div",11)(17,"mat-card",12)(18,"mat-card-content",13)(19,"app-endpoints-result",14,15),t.NdJ("refetchAssumptions",function(){t.CHM(o);const l=t.MAs(15);return t.KtG(l.refetchAssumptions())}),t.qZA()()()()()}if(2&e){const o=t.MAs(20);t.xp6(14),t.Q6J("defaultListToShow",i.defaultListToShow)("endpoints",i.endpoints)("result",o.result)("payload",o.payload)("isLoading",i.isLoading),t.xp6(5),t.Q6J("itemToBeTried",i.itemToBeTried)}},dependencies:[T.zs,E.a8,E.dn,L.E,h.yS,G,wt],styles:[".max-height-full[_ngcontent-%COMP%]{max-height:53vh;min-height:100%;overflow:hidden}"]}),n})()}];let Et=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(kt),h.Bz]}),n})(),Zt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.ez,u.u5,u.UX,v.q,_.k,m.K,Et,b.m]}),n})()}}]);