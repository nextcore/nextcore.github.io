"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[558],{6996:(L,b,o)=>{o.d(b,{z:()=>e});var a=o(4006),h=o(5938),n=o(4650),S=o(3885),O=o(6895),c=o(7392),_=o(4859),s=o(9549),d=o(4144),v=o(266);function T(x,M){if(1&x&&n._UZ(0,"p",8),2&x){const C=n.oxw();n.Q6J("innerHTML",C.data.description_extra,n.oJD)}}function l(x,M){if(1&x&&(n.TgZ(0,"mat-hint",14),n._uU(1),n.qZA()),2&x){const C=n.oxw(2);n.xp6(1),n.hij(" Inserted ",C.data.extra.fieldToBeTypedTitle," doesn't match. ")}}function p(x,M){if(1&x&&(n.ynx(0),n.TgZ(1,"mat-form-field",9)(2,"span",10)(3,"mat-icon"),n._uU(4),n.qZA(),n.TgZ(5,"span",11),n._uU(6,"|"),n.qZA()(),n._UZ(7,"input",12),n.YNc(8,l,2,1,"mat-hint",13),n.qZA(),n.BQk()),2&x){const C=n.oxw();n.xp6(2),n.MGl("matTooltip","Type in the ",C.data.extra.fieldToBeTypedTitle,""),n.xp6(2),n.Oqu(null==C.data||null==C.data.extra?null:C.data.extra.icon),n.xp6(3),n.MGl("placeholder","Type in the ",C.data.extra.fieldToBeTypedTitle,""),n.Q6J("formControl",C.inputValue),n.xp6(1),n.Q6J("ngIf",""!==C.inputValue.value&&C.data.extra.fieldToBeTypedValue!==C.inputValue.value)}}let e=(()=>{class x{constructor(C,y,P){this.generalService=C,this.dialogRef=y,this.data=P,this.inputValue=new a.NI("")}ngOnInit(){this.data.title=this.data.title??"Please confirm",this.data.description=this.data.description??"Are you sure?",this.data.action_btn_color=this.data.action_btn_color??"primary"}confirm(){!this.data.extra||!this.data.extra.details||this.inputValue.value===this.data.extra.fieldToBeTypedValue&&""!==this.inputValue.value?this.dialogRef.close("confirm"):this.generalService.showFeedback(this.data.extra.fieldToBeTypedTitle+" does not match","errorMessage",null,2e3)}}return x.\u0275fac=function(C){return new(C||x)(n.Y36(S.m),n.Y36(h.so),n.Y36(h.WI))},x.\u0275cmp=n.Xpm({type:x,selectors:[["app-confirmation-dialog"]],decls:13,vars:10,consts:[["mat-dialog-title",""],[3,"ngSubmit"],["mat-dialog-content",""],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-flat-button","",3,"color","click"],[3,"innerHTML"],[1,"w-100"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2",3,"matTooltip"],[1,"text-muted"],["cdkFocusInitial","","matInput","","autocomplete","off",3,"placeholder","formControl"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(C,y){1&C&&(n.TgZ(0,"h3",0),n._uU(1),n.qZA(),n.TgZ(2,"form",1),n.NdJ("ngSubmit",function(){return y.confirm()}),n.TgZ(3,"div",2)(4,"p"),n._uU(5),n.qZA(),n.YNc(6,T,1,1,"p",3),n.YNc(7,p,9,5,"ng-container",4),n.qZA(),n.TgZ(8,"div",5)(9,"button",6),n._uU(10),n.qZA(),n.TgZ(11,"button",7),n.NdJ("click",function(){return y.confirm()}),n._uU(12),n.qZA()()()),2&C&&(n.xp6(1),n.Oqu(y.data.title),n.xp6(3),n.ekj("fw-bold",y.data.bold_description),n.xp6(1),n.Oqu(y.data.description),n.xp6(1),n.Q6J("ngIf",y.data.description_extra),n.xp6(1),n.Q6J("ngIf",(null==y.data||null==y.data.extra?null:y.data.extra.details)&&"confirmInput"===(null==y.data||null==y.data.extra?null:y.data.extra.action)),n.xp6(1),n.Q6J("align","end"),n.xp6(2),n.hij(" ",y.data.close_btn||"Cancel"," "),n.xp6(1),n.s9C("color",y.data.action_btn_color),n.xp6(1),n.hij(" ",y.data.action_btn," "))},dependencies:[O.O5,c.Hw,_.lW,s.KE,s.bx,s.qo,d.Nt,h.ZT,h.uh,h.xY,h.H8,v.gM,a._Y,a.Fj,a.JJ,a.JL,a.F,a.oH],styles:["p[_ngcontent-%COMP%]{line-height:1.8}"]}),x})()},3231:(L,b,o)=>{o.d(b,{U:()=>d});var a=o(4650),h=o(5938),n=o(3553),S=o(3885),O=o(6895),c=o(6338),_=o(316);function s(v,T){if(1&v){const l=a.EpF();a.TgZ(0,"mat-list-option",5),a.NdJ("click",function(){const x=a.CHM(l).$implicit,M=a.oxw();return a.KtG(M.select(x))}),a._uU(1),a.qZA()}if(2&v){const l=T.$implicit,p=a.oxw();a.ekj("d-none",p.filter&&-1===l.toLowerCase().indexOf(null==p.filter?null:p.filter.toLowerCase())),a.xp6(1),a.hij(" ",p.getFilename(l)," ")}}let d=(()=>{class v{constructor(l,p,e){this.dialogRef=l,this.evaluatorService=p,this.generalService=e,this.files=[],this.filter=null}ngOnInit(){this.evaluatorService.snippets().subscribe({next:l=>{this.files=l.filter(p=>p.endsWith(".hl"))},error:l=>this.generalService.showFeedback(l?.error?.message??l,"errorMessage")})}filterList(l){this.filter=l.searchKey}getFiles(){return this.filter?this.files.filter(l=>-1!==this.getFilename(l).indexOf(this.filter)):this.files}getFilename(l){const p=l.substring(l.lastIndexOf("/")+1);return p.substring(0,p.lastIndexOf("."))}select(l){this.dialogRef.close(this.getFilename(l))}}return v.\u0275fac=function(l){return new(l||v)(a.Y36(h.so),a.Y36(n.a),a.Y36(S.m))},v.\u0275cmp=a.Xpm({type:v,selectors:[["app-load-snippet-dialog"]],decls:6,vars:2,consts:[["mat-dialog-title","",1,"mb-3"],["mat-dialog-content",""],[3,"filterList"],["dense","",3,"multiple"],[3,"d-none","click",4,"ngFor","ngForOf"],[3,"click"]],template:function(l,p){1&l&&(a.TgZ(0,"h3",0),a._uU(1,"Load Hyperlambda snippet"),a.qZA(),a.TgZ(2,"div",1)(3,"app-searchbox",2),a.NdJ("filterList",function(x){return p.filterList(x)}),a.qZA(),a.TgZ(4,"mat-selection-list",3),a.YNc(5,s,2,3,"mat-list-option",4),a.qZA()()),2&l&&(a.xp6(4),a.Q6J("multiple",!1),a.xp6(1),a.Q6J("ngForOf",p.files))},dependencies:[O.sg,c.Ub,c.vS,h.uh,h.xY,_.E],styles:[".mat-list-option[_ngcontent-%COMP%]{height:40px}.mat-dialog-title[_ngcontent-%COMP%]{font:inherit;margin-bottom:0}.file-content[_ngcontent-%COMP%]   .mat-list-base[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]   .mat-list-item-content-reverse[_ngcontent-%COMP%], .file-content[_ngcontent-%COMP%]   .mat-list-base[_ngcontent-%COMP%]   .mat-list-option[_ngcontent-%COMP%]   .mat-list-item-content-reverse[_ngcontent-%COMP%]{word-break:break-all;height:unset;min-height:40px;font-size:14px}"]}),v})()},9311:(L,b,o)=>{o.d(b,{J:()=>O});var a=o(4650),h=o(6895);const n=function(c){return{height:c}};function S(c,_){if(1&c&&(a.TgZ(0,"div"),a._UZ(1,"div",2),a.qZA()),2&c){const s=a.oxw();a.Tol(s.colClass),a.xp6(1),a.ekj("mat-elevation-z1",s.hasShadow),a.Q6J("ngStyle",a.VKq(5,n,s.blockHeight))}}let O=(()=>{class c{constructor(){this.amount=2,this.colClass="col-12",this.blockHeight="375px",this.hasShadow=!0,this.itemsArray=[]}ngOnInit(){for(let s=0;s<this.amount;s++)this.itemsArray.push("item"+s)}}return c.\u0275fac=function(s){return new(s||c)},c.\u0275cmp=a.Xpm({type:c,selectors:[["app-loading-skeleton"]],inputs:{amount:"amount",colClass:"colClass",blockHeight:"blockHeight",hasShadow:"hasShadow"},decls:2,vars:1,consts:[[1,"row"],[3,"class",4,"ngFor","ngForOf"],[1,"block","mb-3",3,"ngStyle"]],template:function(s,d){1&s&&(a.TgZ(0,"div",0),a.YNc(1,S,2,7,"div",1),a.qZA()),2&s&&(a.xp6(1),a.Q6J("ngForOf",d.itemsArray))},dependencies:[h.sg,h.PC],styles:[".block[_ngcontent-%COMP%]{background:#eee;background:linear-gradient(90deg,#ffffff 8%,#f2f2f2 18%,#fafafa 33%);background-size:200% 100%;animation:1s shine linear infinite;border-radius:5px;border:1px solid rgba(217,217,217,.05)}@keyframes shine{to{background-position-x:-200%}}"]}),c})()},8531:(L,b,o)=>{o.d(b,{D:()=>O});var a=o(2843),h=o(4650),n=o(9845),S=o(8710);let O=(()=>{class c{constructor(s,d){this.httpService=s,this.backendService=d}list(s=null,d=null){return this.httpService.get(s?"/magic/system/assumptions/query?endpoint="+encodeURIComponent(s)+"&verb="+encodeURIComponent(d):"/magic/system/assumptions/list")}create(s,d,v,T,l=null,p=null,e=null,x="application/json"){if(-1!==s.indexOf("/"))return(0,a._)(()=>new Error("Not a valid filename"));(s="/etc/tests/"+s).endsWith(".hl")||(s+=".hl");const M={filename:s,verb:d,url:v,status:T};return l&&(M.description=l),p&&(M.payload=p),e&&(M.response=e),x&&(M.produces=x),this.httpService.post("/magic/system/assumptions/create",M)}execute(s){return this.httpService.get("/magic/system/assumptions/execute?root_url="+encodeURIComponent(this.backendService.active.url)+"&test_file="+encodeURIComponent(s))}}return c.\u0275fac=function(s){return new(s||c)(h.LFG(n.O),h.LFG(S.v))},c.\u0275prov=h.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},8588:(L,b,o)=>{o.d(b,{C:()=>c});var a=o(8266),h=o.n(a),n=o(7579);const S=JSON.parse('[{"extensions":["sql"],"options":{"mode":"text/x-mysql","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["md","txt","log","key"],"options":{"mode":"markdown","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["yml","yaml"],"options":{"mode":"text/x-yaml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["xml","html","htm"],"options":{"mode":"application/xml","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["css"],"options":{"mode":"text/css","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["scss"],"options":{"mode":"text/x-scss","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["less"],"options":{"mode":"text/x-less","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["sass"],"options":{"mode":"text/x-sass","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["js","ts"],"options":{"mode":"text/javascript","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["json"],"options":{"mode":"application/ld+json","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["py"],"options":{"mode":"text/x-python","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["rb"],"options":{"mode":"text/x-ruby","lineNumbers":true,"readOnly":false,"tabSize":4,"indentUnit":4,"indentAuto":true,"matchBrackets":true,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore"}}},{"extensions":["sh"],"options":{"mode":"application/x-sh","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"extraKeys":{}}},{"extensions":["hl","config"],"options":{"mode":"hyperlambda","lineNumbers":true,"readOnly":false,"theme":"aista","autofocus":true,"styleActiveLine":true,"tabSize":3,"indentUnit":3,"indentAuto":true,"extraKeys":{"Shift-Tab":"indentLess","Tab":"indentMore","Ctrl-Space":"autocomplete"}}}]');var O=o(4650);let c=(()=>{class _{constructor(d){this.ngZone=d,this.extensions=S,this.action=new n.x}getActions(d,v){let T=[];if(d){const l=d.substring(d.lastIndexOf(".")+1).toLowerCase();T=this.extensions.filter(p=>-1!==p.extensions.indexOf(l))}else v&&(T=this.extensions.filter(l=>-1!==l.extensions.indexOf(v)));if(0===T.length)return null;{const l=this.clone(T[0]);return l.options.extraKeys&&(l.options.extraKeys["Alt-M"]=p=>{p.setOption("fullScreen",!p.getOption("fullScreen"))},l.options.extraKeys["Alt-S"]=()=>{this.ngZone.run(()=>{this.action.next("save")})},l.options.extraKeys["Alt-D"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFile")})},l.options.extraKeys["Alt-C"]=()=>{this.ngZone.run(()=>{this.action.next("close")})},l.options.extraKeys["Alt-R"]=()=>{this.ngZone.run(()=>{this.action.next("renameFile")})},l.options.extraKeys["Alt-L"]=()=>{this.ngZone.run(()=>{this.action.next("renameFolder")})},l.options.extraKeys["Alt-V"]=()=>{this.ngZone.run(()=>{this.action.next("insertSnippet")})},l.options.extraKeys["Alt-O"]=()=>{this.ngZone.run(()=>{this.action.next("macro")})},l.options.extraKeys["Alt-A"]=()=>{this.ngZone.run(()=>{this.action.next("newFile")})},l.options.extraKeys["Alt-B"]=()=>{this.ngZone.run(()=>{this.action.next("newFolder")})},l.options.extraKeys["Alt-X"]=()=>{this.ngZone.run(()=>{this.action.next("deleteFolder")})},l.options.extraKeys["Alt-P"]=()=>{this.ngZone.run(()=>{this.action.next("preview")})},l.options.extraKeys.F5=()=>{this.ngZone.run(()=>{this.action.next("execute")})},l.options.extraKeys.F1=()=>{this.ngZone.run(()=>{this.action.next("prompt")})},"sql"===v&&(l.options.extraKeys["Ctrl-Space"]=p=>{this.ngZone.run(()=>{p.showHint({hint:h().hint.sql,completeSingle:!1})})})),l.options}}clone(d){var v={};for(var T in d)v[T]="object"==typeof d[T]?this.clone(d[T]):d[T];return v}}return _.\u0275fac=function(d){return new(d||_)(O.LFG(O.R0b))},_.\u0275prov=O.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},3553:(L,b,o)=>{o.d(b,{a:()=>O});var a=o(2843),h=o(4650),n=o(9845),S=o(9214);let O=(()=>{class c{constructor(s,d){this.httpService=s,this.fileService=d}execute(s){return this.httpService.post("/magic/system/evaluator/evaluate",{hyperlambda:s})}snippets(){return this.fileService.listFiles("/etc/snippets/")}loadSnippet(s){return-1!==s.indexOf("/")?(0,a._)(()=>new Error("Not a valid filename")):((s="/etc/snippets/"+s).endsWith(".hl")||(s+=".hl"),this.fileService.loadFile(s))}saveSnippet(s,d){return-1!==s.indexOf("/")?(0,a._)(()=>new Error("Not a valid filename")):((s="/etc/snippets/"+s).endsWith(".hl")||(s+=".hl"),this.fileService.saveFile(s,d))}}return c.\u0275fac=function(s){return new(s||c)(h.LFG(n.O),h.LFG(S.I))},c.\u0275prov=h.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},9627:(L,b,o)=>{o.d(b,{c:()=>O});var a=o(9646),h=o(9751),n=o(4650),S=o(9845);let O=(()=>{class c{constructor(s){this.httpService=s,this._vocabulary=[]}get words(){return this._vocabulary}vocabulary(){return this._vocabulary.length>0&&(0,a.of)(this._vocabulary),new h.y(s=>{this.httpService.get("/magic/system/evaluator/vocabulary").subscribe({next:d=>{this._vocabulary=d,s.next(d),s.complete()},error:d=>{s.error(d),s.complete()}})})}}return c.\u0275fac=function(s){return new(s||c)(n.LFG(S.O))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5482:(L,b,o)=>{o.r(b),o.d(b,{HealthCheckModule:()=>re});var a=o(6895),h=o(9132),n=o(2076),S=o(4482),O=o(5403),c=o(8737),s=o(4351),d=o(4128),v=o(1794),T=o(6996),l=o(5938),p=o(3231),e=o(4650),x=o(9214),M=o(3885),C=o(3553),y=o(8531),P=o(8588),k=o(4859),I=o(2677);function R(i,m){if(1&i){const t=e.EpF();e.TgZ(0,"app-codemirror-hyperlambda",7),e.NdJ("modelChange",function(u){e.CHM(t);const g=e.oxw();return e.KtG(g.data.content=u)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("model",t.data.content)}}let H=(()=>{class i{constructor(t,r,u,g,f,A,D,Z){this.dialog=t,this.fileService=r,this.generalService=u,this.evaluatorService=g,this.assumptionService=f,this.data=A,this.dialogRef=D,this.codemirrorActionsService=Z,this.codemirrorOptionsReady=!1}ngOnInit(){this.getCodeMirrorOptions(),this.watchForActions()}getCodeMirrorOptions(){const t=this.codemirrorActionsService.getActions(null,"hl");this.data.content.options=t,setTimeout(()=>{this.codemirrorOptionsReady=!0},100)}watchForActions(){this.codemirrorActionSubscription=this.codemirrorActionsService.action.subscribe(t=>{switch(t){case"save":this.saveTest();break;case"insertSnippet":this.load();break;case"execute":this.executeTest()}})}load(){this.dialog.open(p.U,{width:"550px"}).afterClosed().subscribe(r=>{r&&this.evaluatorService.loadSnippet(r).subscribe({next:u=>{this.data.content.hyperlambda=u},error:u=>this.generalService.showFeedback(u?.error?.message??u,"errorMessage")})})}saveTest(){this.fileService.saveFile(this.data.filename,this.data.content.hyperlambda).subscribe({next:()=>{this.generalService.showFeedback("Assumption successfully saved","successMessage","Ok",3e3),this.dialogRef.close()},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}executeTest(){this.assumptionService.execute(this.data.filename).subscribe({next:t=>{this.data.success="success"===t.result,this.data.status="success"===t.result?"Passed":"Failed","success"===t.result?this.generalService.showFeedback("Assumption succeeded","successMessage"):this.generalService.showFeedback("Assumption failed, please check the logs.","errorMessage","Ok",5e3)},error:t=>{this.data.success=!1,this.data.status="Failed",this.generalService.showFeedback(t?.error?.message??t,"errorMessage")}})}ngOnDestroy(){this.codemirrorActionSubscription&&this.codemirrorActionSubscription.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.uw),e.Y36(x.I),e.Y36(M.m),e.Y36(C.a),e.Y36(y.D),e.Y36(l.WI),e.Y36(l.so),e.Y36(P.C))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-test-health-content-dialog"]],decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","full-height d-block",3,"model","modelChange",4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","color","primary","mat-dialog-close",""],["mat-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"full-height","d-block",3,"model","modelChange"]],template:function(t,r){1&t&&(e.TgZ(0,"h3",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,R,1,1,"app-codemirror-hyperlambda",2),e.qZA(),e.TgZ(4,"div",3)(5,"button",4),e._uU(6," Close "),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return r.saveTest()}),e._uU(8," Save & close "),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return r.executeTest()}),e._uU(10," Run test "),e.qZA()()),2&t&&(e.xp6(1),e.hij("Test for ",r.data.name,""),e.xp6(2),e.Q6J("ngIf",r.codemirrorOptionsReady),e.xp6(1),e.Q6J("align","end"))},dependencies:[a.O5,k.lW,l.ZT,l.uh,l.xY,l.H8,I.u],encapsulation:2}),i})();var w=o(8710),N=o(9311),B=o(316),E=o(671),F=o(3546),K=o(6308);function Y(i,m){1&i&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",10),e.BQk()),2&i&&(e.xp6(1),e.Q6J("amount",1)("colClass","col-12")("blockHeight","41px")("hasShadow",!1))}function W(i,m){if(1&i){const t=e.EpF();e.TgZ(0,"app-searchbox",11),e.NdJ("buttonClick",function(){e.CHM(t);const u=e.oxw();return e.KtG(u.testAll())})("filterList",function(u){e.CHM(t);const g=e.oxw();return e.KtG(g.filterList(u))}),e.qZA()}}function J(i,m){1&i&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",10),e.BQk()),2&i&&(e.xp6(1),e.Q6J("amount",6)("colClass","col-12")("blockHeight","40px")("hasShadow",!1))}function Q(i,m){1&i&&(e.TgZ(0,"th",24),e._uU(1,"Name"),e.qZA())}function j(i,m){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=m.$implicit;e.xp6(1),e.Oqu(t.name)}}function G(i,m){1&i&&(e.TgZ(0,"th",26),e._uU(1,"Status"),e.qZA())}function z(i,m){if(1&i&&(e.TgZ(0,"td",27),e._UZ(1,"span"),e.qZA()),2&i){const t=m.$implicit;e.xp6(1),e.Gre("status ",t.status," me-1")}}function V(i,m){1&i&&(e.TgZ(0,"th",28),e._uU(1,"Actions"),e.qZA())}function $(i,m){if(1&i){const t=e.EpF();e.TgZ(0,"td",27)(1,"div",29)(2,"button",30),e.NdJ("click",function(){const g=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.ensureTestContent(g))}),e._uU(3," View details "),e.qZA(),e._UZ(4,"div",31),e.TgZ(5,"button",32),e.NdJ("click",function(){const g=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.deleteTest(g))}),e._uU(6," Delete "),e.qZA(),e._UZ(7,"div",31),e.TgZ(8,"button",30),e.NdJ("click",function(){const g=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.executeTest(g))}),e._uU(9," Run test "),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("disabled",t.isRunning),e.xp6(3),e.Q6J("disabled",t.isRunning),e.xp6(3),e.Q6J("disabled",t.isRunning)}}function X(i,m){1&i&&e._UZ(0,"tr",33)}function q(i,m){1&i&&e._UZ(0,"tr",34)}function ee(i,m){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"table",13),e.NdJ("matSortChange",function(u){e.CHM(t);const g=e.oxw();return e.KtG(g.sortData(u))}),e.ynx(2,14),e.YNc(3,Q,2,0,"th",15),e.YNc(4,j,2,1,"td",16),e.BQk(),e.ynx(5,17),e.YNc(6,G,2,0,"th",18),e.YNc(7,z,2,3,"td",19),e.BQk(),e.ynx(8,20),e.YNc(9,V,2,0,"th",21),e.YNc(10,$,10,3,"td",19),e.BQk(),e.YNc(11,X,1,0,"tr",22),e.YNc(12,q,1,0,"tr",23),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(10),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}function U(i,m,t){return(i<m?-1:1)*(t?1:-1)}const ne=[{path:"",component:(()=>{class i{constructor(t,r,u,g,f,A){this.dialog=t,this.cdr=r,this.fileService=u,this.backendService=g,this.generalService=f,this.assumptionService=A,this.originalDataSource=[],this.dataSource=[],this.displayedColumns=["name","status","action"],this.isLoading=!0,this.isRunning=!1}ngOnInit(){this.getList()}ensureTestContent(t){t.content?this.openContent(t):this.fileService.loadFile(t.filename).subscribe({next:r=>{t.content={hyperlambda:r,options:v},this.openContent(t)},error:r=>this.generalService.showFeedback(r?.error?.message??r,"errorMessage")})}executeTest(t){this.isRunning=!0,this.assumptionService.execute(t.filename).subscribe({next:r=>{this.isRunning=!1,t.success="success"===r.result,t.status="success"===r.result?"Passed":"Failed","success"===r.result?this.generalService.showFeedback("Assumption succeeded","successMessage"):this.generalService.showFeedback("Assumption failed, please check the logs.","errorMessage","Ok",5e3)},error:r=>{this.isRunning=!1,t.success=!1,t.status="Failed",this.generalService.showFeedback(r?.error?.message??r,"errorMessage")}})}deleteTest(t){this.dialog.open(T.z,{width:"500px",data:{title:`Delete ${t.filename}`,description_extra:"You are deleting the selected test case. Do you want to continue?",action_btn:"Delete",action_btn_color:"warn",bold_description:!0}}).afterClosed().subscribe(r=>{r&&"confirm"===r&&this.fileService.deleteFile(t.filename).subscribe({next:()=>{this.generalService.showFeedback("Assumption successfully deleted","successMessage"),this.dataSource=this.dataSource.filter(u=>u.filename!==t.filename),this.originalDataSource=this.originalDataSource.filter(u=>u.filename!==t.filename),this.cdr.detectChanges()},error:u=>this.generalService.showFeedback(u?.error?.message??u,"errorMessage")})})}testAll(){let r=0;const u=new Date;let g=null;this.generalService.showLoading(),this.isRunning=!0,(0,n.D)(this.dataSource.map(f=>this.assumptionService.execute(f.filename))).pipe(function _(i,m=null){return m=m??i,(0,S.e)((t,r)=>{let u=[],g=0;t.subscribe((0,O.x)(r,f=>{let A=null;g++%m==0&&u.push([]);for(const D of u)D.push(f),i<=D.length&&(A=A??[],A.push(D));if(A)for(const D of A)(0,c.P)(u,D),r.next(D)},()=>{for(const f of u)r.next(f);r.complete()},void 0,()=>{u=null}))})}(2),(0,s.b)(f=>(0,d.D)(f))).subscribe({next:f=>{g=(new Date).getTime()-u.getTime();const D=this.dataSource;for(let Z of f)D[r].success="success"===Z.result,D[r].status="success"===Z.result?"Passed":"Failed",r++},error:f=>{this.generalService.showFeedback(f?.error?.message??f,"errorMessage"),this.filterTests()},complete:()=>{this.generalService.hideLoading(),this.filterTests(g),this.isRunning=!1}})}filterList(t){this.dataSource=t.searchKey?this.originalDataSource.filter(r=>r.name.indexOf(t.searchKey)>-1):this.originalDataSource}sortData(t){const r=this.originalDataSource.slice();this.dataSource=t.active&&""!==t.direction?r.sort((u,g)=>{const f="asc"===t.direction;switch(t.active){case"name":return U(u.name,g.name,f);case"status":return U(u.status,g.status,f);default:return 0}}):r}getList(){this.assumptionService.list().subscribe({next:t=>{let r;r=t.filter(u=>u.endsWith(".hl")).map(u=>{const g=u.substring(u.lastIndexOf("/")+1);return{status:"Untested",name:g.substring(0,g.length-3),filename:u,success:null,content:null}}),this.originalDataSource=[...r],this.dataSource=r,this.isLoading=!1},error:t=>this.generalService.showFeedback(t?.error?.message??t,"errorMessage")})}filterTests(t=null){0===this.dataSource.filter(r=>!0!==r.success).length?this.generalService.showFeedback("All tests succeeded"+(null!==t?" in "+new Intl.NumberFormat("en-us").format(t)+" milliseconds":""),"successMessage","Ok",5e3):(this.generalService.hideLoading(),this.generalService.showFeedback("One or more tests failed!","errorMessage","Ok",5e3))}openContent(t){this.dialog.open(H,{width:"900px",data:t,panelClass:["light"]})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.uw),e.Y36(e.sBO),e.Y36(x.I),e.Y36(w.v),e.Y36(M.m),e.Y36(y.D))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-health-check"]],decls:15,vars:4,consts:[[1,"row","fullPage"],[1,"col-12"],[1,"h-100"],[1,"row","align-items-center"],[1,"col-xxl-8","col-xl-7","col-lg-6","col-12","mb-lg-0","mb-2"],[1,"my-0","fw-bold"],[1,"col-xxl-4","col-xl-5","col-lg-6","col-12"],[4,"ngIf","ngIfElse"],["loaded",""],["dataReady",""],[3,"amount","colClass","blockHeight","hasShadow"],["buttonText","Run",3,"buttonClick","filterList"],[1,"table-responsive","mt-4"],["mat-table","","matSort","",1,"w-100","borderless","hoverable",3,"dataSource","matSortChange"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","text-truncate px-sm-3",4,"matHeaderCellDef"],["mat-cell","","class","text-truncate px-sm-3",4,"matCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","","class","text-nowrap px-sm-3 small-table-column",4,"matHeaderCellDef"],["mat-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matCellDef"],["matColumnDef","action"],["mat-header-cell","","class","text-nowrap px-sm-3 small-table-column",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",1,"text-truncate","px-sm-3"],["mat-cell","",1,"text-truncate","px-sm-3"],["mat-header-cell","","mat-sort-header","",1,"text-nowrap","px-sm-3","small-table-column"],["mat-cell","",1,"text-nowrap","px-sm-3","small-table-column"],["mat-header-cell","",1,"text-nowrap","px-sm-3","small-table-column"],[1,"d-flex"],["mat-button","","color","primary",3,"disabled","click"],[1,"pe-1"],["mat-button","","color","warn",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,r){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-content",2)(4,"div",3)(5,"div",4)(6,"h3",5),e._uU(7,"Health check"),e.qZA()(),e.TgZ(8,"div",6),e.YNc(9,Y,2,4,"ng-container",7),e.YNc(10,W,1,0,"ng-template",null,8,e.W1O),e.qZA()(),e.YNc(12,J,2,4,"ng-container",7),e.YNc(13,ee,13,4,"ng-template",null,9,e.W1O),e.qZA()()()()),2&t){const u=e.MAs(11),g=e.MAs(14);e.xp6(9),e.Q6J("ngIf",r.isLoading)("ngIfElse",u),e.xp6(3),e.Q6J("ngIf",r.isLoading)("ngIfElse",g)}},dependencies:[a.O5,N.J,B.E,k.lW,E.BZ,E.fO,E.as,E.w1,E.Dz,E.nj,E.ge,E.ev,E.XQ,E.Gk,F.a8,F.dn,K.YE,K.nU],styles:[".status[_ngcontent-%COMP%]{min-width:7px;min-height:7px;width:7px;height:7px;border-radius:50%;background-color:#828282;display:inline-block}.status.Untested[_ngcontent-%COMP%]{background-color:#828282}.status.Passed[_ngcontent-%COMP%]{background-color:#27ae60}.status.Failed[_ngcontent-%COMP%]{background-color:#eb5757}"]}),i})()}];let oe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.Bz.forChild(ne),h.Bz]}),i})();var se=o(1103),ae=o(1717),ie=o(2278),le=o(7832);let re=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[a.ez,oe,le.K,ie.q,ae.h,se.k]}),i})()},1717:(L,b,o)=>{o.d(b,{h:()=>O});var a=o(6895),h=o(4006),n=o(1103),S=o(4650);let O=(()=>{class c{}return c.\u0275fac=function(s){return new(s||c)},c.\u0275mod=S.oAB({type:c}),c.\u0275inj=S.cJS({imports:[a.ez,n.k,h.u5]}),c})()}}]);