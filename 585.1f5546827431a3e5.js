"use strict";(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[585],{9554:(f,l,t)=>{t.d(l,{v:()=>i});const i={name:"Name must be minimum 2 characters long",backendname:"Alphanumeric characters between 2 to 20 (no space).",username:"Alphanumeric between 2 and 20 characters (no space)",email:"Email must be a valid email address",confirmEmail:"Email addresses must match",confirmPassword:"Passwords must match",currentPassword:"Your password is incorrect",cloudletName:"Minimum of 5 characters, only lowercase and numbers",phone:"e.g. 1111111111",subject:"2 to 30 letters, without special characters",message:"Message cannot be less than 3 characters",appNames:"Only lowercase alphanumeric characters, dot (.), - or _ please",appNamesWithUppercaseDot:"Only alphanumeric characters, dot (.), - or _ please",appNamesWithDot:"Only lowercase alphanumeric characters, and - or _ please",appNameWithUppercase:"Accepts alphanumeric characters and _",appNameWithUppercaseHyphen:"Accepts alphanumeric characters, - and _",domain:"Domain is not valid",backend:"Backend URL must contain http://",password:"Minimum 12 characters",recaptcha:"Not valid reCAPTCHA secret or key"}},8194:(f,l,t)=>{t.d(l,{g:()=>i});const i={phone:/^[0-9 ]*$/,name:/^[a-z0-9]{2,20}$/,subject:/^.{4,1000}$/,appNames:/^[a-z0-9_.-]+$/,appNamesWithDot:/^[a-z0-9_.-]+$/,appNamesWithUppercaseDot:/^[a-zA-Z0-9_.-]+$/,appNameWithUppercase:/^[a-zA-Z0-9_]+$/,appNameWithUppercaseHyphen:/^[a-zA-Z0-9_-]+$/,domain:/(^https?:\/\/)([\w\-])+\.{1}([a-zA-Z]{2,63})([\/\w-]*)*\/?\??([^#\n\r]*)?#?([^\n\r]*)/,backend:/^https?:\/\/([\w\-.])+(:[0-9]*)?(\.\w+)?$/,email:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,password:/^.{12,}$/,recaptcha:/^([a-zA-Z-_0-9]{20,100})$/}},7832:(f,l,t)=>{t.d(l,{K:()=>h});var i=t(6895),n=t(2278),d=t(4006),g=t(1103),c=t(4650);let h=(()=>{class m{}return m.\u0275fac=function(w){return new(w||m)},m.\u0275mod=c.oAB({type:m}),m.\u0275inj=c.cJS({imports:[i.ez,n.q,d.u5,d.UX,g.k]}),m})()},7585:(f,l,t)=>{t.r(l),t.d(l,{SetupModule:()=>E});var i=t(6895),n=t(4006),d=t(2278),g=t(7832),c=t(9132),h=t(9554),m=t(8194),e=t(4650),w=t(2729),T=t(3885),S=t(7392),b=t(4859),u=t(9549),y=t(4144),A=t(266),C=t(4385),U=t(3238),v=t(3546);function P(a,r){if(1&a&&(e.TgZ(0,"mat-option",34),e._uU(1),e.qZA()),2&a){const s=r.$implicit;e.Q6J("value",s.value),e.xp6(1),e.hij(" ",s.name," ")}}function x(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1,"Passwords must match"),e.qZA())}class M{isErrorState(r,s){return!(!r?.invalid||!r?.parent?.dirty)||!(!r?.parent?.invalid||!r?.parent?.dirty)}}const F=[{path:"",component:(()=>{class a{constructor(s,o,p,q){this.formBuilder=s,this.configService=o,this.generalService=p,this.router=q,this.matcher=new M,this.databaseTypes=[{name:"SQLite",value:"sqlite"},{name:"MySQL",value:"mysql"},{name:"PostgreSQL",value:"pgsql"},{name:"SQL Server",value:"mssql"}],this.checkPasswords=Z=>{const N=Z.get("password")?.value,_=Z.get("passwordRepeat")?.value;return N===_?null:{notSame:!0}},this.configForm=this.formBuilder.group({connectionString:["Data Source=files/data/{database}.db",[n.kI.required,n.kI.pattern(".*{database}.*")]],defaultTimeZone:["none",[n.kI.required]],selectedDatabaseType:["sqlite",[n.kI.required]],password:["",[n.kI.required,n.kI.pattern(".{12,}")]],passwordRepeat:[""],name:["",[n.kI.required]],email:["",[n.kI.required]]}),this.showPassword=!1,this.waiting=!1,this.CommonRegEx=m.g,this.CommonErrorMessages=h.v,this.configForm.addValidators(this.checkPasswords)}ngOnInit(){this.configForm.controls.password.valueChanges.subscribe(()=>{this.showPassword&&this.configForm.controls.passwordRepeat.setValue(this.configForm.controls.password.value)})}toggleShowPassword(){this.showPassword=!this.showPassword,this.showPassword?(this.configForm.controls.passwordRepeat.setValue(this.configForm.controls.password.value),this.configForm.controls.passwordRepeat.disable()):this.configForm.controls.passwordRepeat.enable()}selectedDatabaseTypeChanged(){switch(this.configForm.controls.selectedDatabaseType.value){case"sqlite":this.configForm.controls.connectionString.setValue("Data Source=files/data/{database}.db");break;case"mysql":this.configForm.controls.connectionString.setValue("Server=localhost;Database={database};Uid=root;Pwd=ThisIsNotAGoodPassword;SslMode=Preferred;Old Guids=true;");break;case"pgsql":this.configForm.controls.connectionString.setValue("User ID=postgres;Password=ThisIsNotAGoodPassword;Host=localhost;Port=5432;Database={database}");break;case"mssql":this.configForm.controls.connectionString.setValue("Server=localhost\\SQLEXPRESS;Database={database};Trusted_Connection=True;")}}submit(){this.configForm.invalid?this.generalService.showFeedback("Please provide all fields","errorMessage"):(this.generalService.showLoading(),this.waiting=!0,this.configService.setup({password:this.configForm.controls.password.value,connectionString:this.configForm.controls.connectionString.value,defaultTimeZone:this.configForm.controls.defaultTimeZone.value,databaseType:this.configForm.controls.selectedDatabaseType.value,name:this.configForm.controls.name.value,email:this.configForm.controls.email.value}).subscribe({next:()=>{this.waiting=!1,window.location.href="/",this.generalService.hideLoading()},error:o=>{this.generalService.showFeedback(o?.error?.message??o,"errorMessage"),this.generalService.hideLoading(),this.waiting=!1}}))}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(n.qu),e.Y36(w.E),e.Y36(T.m),e.Y36(c.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-setup"]],decls:95,vars:12,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-12"],[1,"my-0","fw-bold"],[1,"text-muted"],[1,"col-12","mt-4"],[1,"fw-bold"],[1,"col-xl-3","col-sm-6","col-12","order-1"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Default database type",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["formControlName","selectedDatabaseType",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-xl-3","col-sm-6","col-12","order-xl-3","order-2"],["matPrefix","","matTooltip","Default time zone",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["formControlName","defaultTimeZone"],["value","none"],["value","utc"],["value","local"],[1,"col-xl-6","col-sm-12","col-12","order-xl-2","order-3"],["matPrefix","","matTooltip","Default connection string",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","autocomplete","connectionString","placeholder","Connection string","formControlName","connectionString","name","connectionString"],[1,"col-xl-3","col-md-6","col-12"],["matPrefix","","matTooltip","Your full name",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","autocomplete","name","placeholder","Full name","formControlName","name","name","name"],["matPrefix","","matTooltip","Your email address",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","autocomplete","email","formControlName","email","placeholder","Your email address","name","email",3,"pattern"],["matPrefix","","matTooltip","Choose a password",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","autocomplete","new-password","formControlName","password","placeholder","Choose a password","name","password",3,"type","pattern"],["mat-icon-button","","type","button","matSuffix","","tabindex","-1",3,"click"],["matPrefix","","matTooltip","Repeat password",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","autocomplete","new-password","formControlName","passwordRepeat","placeholder","Repeat password","name","password",3,"type","errorStateMatcher"],[4,"ngIf"],[1,"col-12","d-flex","justify-content-end","mt-3"],["mat-flat-button","","type","submit","color","primary",1,"px-5",3,"disabled"],[3,"value"]],template:function(s,o){1&s&&(e.TgZ(0,"mat-card")(1,"mat-card-content")(2,"form",0),e.NdJ("ngSubmit",function(){return o.submit()}),e.TgZ(3,"div",1)(4,"div",2)(5,"h3",3),e._uU(6,"Setup"),e.qZA(),e.TgZ(7,"p",4),e._uU(8,"Initial settings for your account and the connected backend"),e.qZA()(),e.TgZ(9,"div",5)(10,"p",6),e._uU(11,"Default database configuration"),e.qZA(),e.TgZ(12,"div",1)(13,"div",7)(14,"mat-form-field",8)(15,"span",9)(16,"mat-icon"),e._uU(17,"database"),e.qZA(),e.TgZ(18,"span",4),e._uU(19,"|"),e.qZA()(),e.TgZ(20,"mat-select",10),e.NdJ("selectionChange",function(){return o.selectedDatabaseTypeChanged()}),e.YNc(21,P,2,2,"mat-option",11),e.qZA()()(),e.TgZ(22,"div",12)(23,"mat-form-field",8)(24,"span",13)(25,"mat-icon"),e._uU(26,"query_builder"),e.qZA(),e.TgZ(27,"span",4),e._uU(28,"|"),e.qZA()(),e.TgZ(29,"mat-select",14)(30,"mat-option",15),e._uU(31,"None"),e.qZA(),e.TgZ(32,"mat-option",16),e._uU(33,"UTC"),e.qZA(),e.TgZ(34,"mat-option",17),e._uU(35,"Local"),e.qZA()()()(),e.TgZ(36,"div",18)(37,"mat-form-field",8)(38,"span",19)(39,"mat-icon"),e._uU(40,"conversion_path"),e.qZA(),e.TgZ(41,"span",4),e._uU(42,"|"),e.qZA()(),e._UZ(43,"input",20),e.TgZ(44,"mat-error"),e._uU(45," Connection string in not valid "),e.qZA()()()()(),e.TgZ(46,"div",5)(47,"p",6),e._uU(48,"Default account configuration"),e.qZA(),e.TgZ(49,"div",1)(50,"div",21)(51,"mat-form-field",8)(52,"span",22)(53,"mat-icon"),e._uU(54,"person"),e.qZA(),e.TgZ(55,"span",4),e._uU(56,"|"),e.qZA()(),e._UZ(57,"input",23),e.TgZ(58,"mat-error"),e._uU(59," Name is required "),e.qZA()()(),e.TgZ(60,"div",21)(61,"mat-form-field",8)(62,"span",24)(63,"mat-icon"),e._uU(64,"mail"),e.qZA(),e.TgZ(65,"span",4),e._uU(66,"|"),e.qZA()(),e._UZ(67,"input",25),e.TgZ(68,"mat-error"),e._uU(69),e.qZA()()(),e.TgZ(70,"div",21)(71,"mat-form-field",8)(72,"span",26)(73,"mat-icon"),e._uU(74,"password"),e.qZA(),e.TgZ(75,"span",4),e._uU(76,"|"),e.qZA()(),e._UZ(77,"input",27),e.TgZ(78,"button",28),e.NdJ("click",function(){return o.toggleShowPassword()}),e.TgZ(79,"mat-icon"),e._uU(80),e.qZA()(),e.TgZ(81,"mat-error"),e._uU(82),e.qZA()()(),e.TgZ(83,"div",21)(84,"mat-form-field",8)(85,"span",29)(86,"mat-icon"),e._uU(87,"password"),e.qZA(),e.TgZ(88,"span",4),e._uU(89,"|"),e.qZA()(),e._UZ(90,"input",30),e.YNc(91,x,2,0,"mat-error",31),e.qZA()()()(),e.TgZ(92,"div",32)(93,"button",33),e._uU(94," Save "),e.qZA()()()()()()),2&s&&(e.xp6(2),e.Q6J("formGroup",o.configForm),e.xp6(19),e.Q6J("ngForOf",o.databaseTypes),e.xp6(46),e.Q6J("pattern",o.CommonRegEx.email),e.xp6(2),e.Oqu(o.CommonErrorMessages.email),e.xp6(8),e.Q6J("type",o.showPassword?"text":"password")("pattern",o.CommonRegEx.password),e.xp6(3),e.hij("visibility",o.showPassword?"_off":"",""),e.xp6(2),e.Oqu(o.CommonErrorMessages.password),e.xp6(8),e.Q6J("type",o.showPassword?"text":"password")("errorStateMatcher",o.matcher),e.xp6(1),e.Q6J("ngIf",o.configForm.hasError("notSame")),e.xp6(2),e.Q6J("disabled",o.waiting))},dependencies:[i.sg,i.O5,n._Y,n.Fj,n.JJ,n.JL,n.c5,n.sg,n.u,S.Hw,b.lW,u.TO,u.KE,u.qo,u.R9,y.Nt,A.gM,C.gD,U.ey,v.a8,v.dn],encapsulation:2}),a})()}];let D=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.Bz.forChild(F),c.Bz]}),a})(),E=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[i.ez,n.u5,n.UX,d.q,g.K,D]}),a})()}}]);