(self.webpackChunkmagic=self.webpackChunkmagic||[]).push([[6],{7832:(J,k,s)=>{"use strict";s.d(k,{K:()=>h});var i=s(6895),g=s(2278),c=s(4006),y=s(1103),A=s(4650);let h=(()=>{class f{}return f.\u0275fac=function(w){return new(w||f)},f.\u0275mod=A.oAB({type:f}),f.\u0275inj=A.cJS({imports:[i.ez,g.q,c.u5,c.UX,y.k]}),f})()},6996:(J,k,s)=>{"use strict";s.d(k,{z:()=>b});var i=s(4006),g=s(5938),c=s(4650),y=s(3885),A=s(6895),h=s(7392),f=s(4859),M=s(9549),w=s(4144),d=s(266);function e(v,O){if(1&v&&c._UZ(0,"p",8),2&v){const x=c.oxw();c.Q6J("innerHTML",x.data.description_extra,c.oJD)}}function m(v,O){if(1&v&&(c.TgZ(0,"mat-hint",14),c._uU(1),c.qZA()),2&v){const x=c.oxw(2);c.xp6(1),c.hij(" Inserted ",x.data.extra.fieldToBeTypedTitle," doesn't match. ")}}function p(v,O){if(1&v&&(c.ynx(0),c.TgZ(1,"mat-form-field",9)(2,"span",10)(3,"mat-icon"),c._uU(4),c.qZA(),c.TgZ(5,"span",11),c._uU(6,"|"),c.qZA()(),c._UZ(7,"input",12),c.YNc(8,m,2,1,"mat-hint",13),c.qZA(),c.BQk()),2&v){const x=c.oxw();c.xp6(2),c.MGl("matTooltip","Type in the ",x.data.extra.fieldToBeTypedTitle,""),c.xp6(2),c.Oqu(null==x.data||null==x.data.extra?null:x.data.extra.icon),c.xp6(3),c.MGl("placeholder","Type in the ",x.data.extra.fieldToBeTypedTitle,""),c.Q6J("formControl",x.inputValue),c.xp6(1),c.Q6J("ngIf",""!==x.inputValue.value&&x.data.extra.fieldToBeTypedValue!==x.inputValue.value)}}let b=(()=>{class v{constructor(x,S,F){this.generalService=x,this.dialogRef=S,this.data=F,this.inputValue=new i.NI("")}ngOnInit(){this.data.title=this.data.title??"Please confirm",this.data.description=this.data.description??"Are you sure?",this.data.action_btn_color=this.data.action_btn_color??"primary"}confirm(){!this.data.extra||!this.data.extra.details||this.inputValue.value===this.data.extra.fieldToBeTypedValue&&""!==this.inputValue.value?this.dialogRef.close("confirm"):this.generalService.showFeedback(this.data.extra.fieldToBeTypedTitle+" does not match","errorMessage",null,2e3)}}return v.\u0275fac=function(x){return new(x||v)(c.Y36(y.m),c.Y36(g.so),c.Y36(g.WI))},v.\u0275cmp=c.Xpm({type:v,selectors:[["app-confirmation-dialog"]],decls:13,vars:10,consts:[["mat-dialog-title",""],[3,"ngSubmit"],["mat-dialog-content",""],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close","","cdkFocusInitial",""],["mat-flat-button","",3,"color","click"],[3,"innerHTML"],[1,"w-100"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2",3,"matTooltip"],[1,"text-muted"],["cdkFocusInitial","","matInput","","autocomplete","off",3,"placeholder","formControl"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(x,S){1&x&&(c.TgZ(0,"h3",0),c._uU(1),c.qZA(),c.TgZ(2,"form",1),c.NdJ("ngSubmit",function(){return S.confirm()}),c.TgZ(3,"div",2)(4,"p"),c._uU(5),c.qZA(),c.YNc(6,e,1,1,"p",3),c.YNc(7,p,9,5,"ng-container",4),c.qZA(),c.TgZ(8,"div",5)(9,"button",6),c._uU(10),c.qZA(),c.TgZ(11,"button",7),c.NdJ("click",function(){return S.confirm()}),c._uU(12),c.qZA()()()),2&x&&(c.xp6(1),c.Oqu(S.data.title),c.xp6(3),c.ekj("fw-bold",S.data.bold_description),c.xp6(1),c.Oqu(S.data.description),c.xp6(1),c.Q6J("ngIf",S.data.description_extra),c.xp6(1),c.Q6J("ngIf",(null==S.data||null==S.data.extra?null:S.data.extra.details)&&"confirmInput"===(null==S.data||null==S.data.extra?null:S.data.extra.action)),c.xp6(1),c.Q6J("align","end"),c.xp6(2),c.hij(" ",S.data.close_btn||"Cancel"," "),c.xp6(1),c.s9C("color",S.data.action_btn_color),c.xp6(1),c.hij(" ",S.data.action_btn," "))},dependencies:[A.O5,h.Hw,f.lW,M.KE,M.bx,M.qo,w.Nt,g.ZT,g.uh,g.xY,g.H8,d.gM,i._Y,i.Fj,i.JJ,i.JL,i.F,i.oH],styles:["p[_ngcontent-%COMP%]{line-height:1.8}"]}),v})()},316:(J,k,s)=>{"use strict";s.d(k,{E:()=>N});var i=s(4650),g=s(4006),c=s(8372),y=s(1884),A=s(6895),h=s(7392),f=s(4859),M=s(9549),w=s(4144),d=s(6709),e=s(266),m=s(4385),p=s(3238);function b(C,Z){if(1&C){const _=i.EpF();i.TgZ(0,"mat-checkbox",10),i.NdJ("ngModelChange",function(D){i.CHM(_);const Q=i.oxw();return i.KtG(Q.checked=D)})("change",function(){i.CHM(_);const D=i.oxw();return i.KtG(D.filter())}),i._uU(1),i.qZA()}if(2&C){const _=i.oxw();i.Q6J("ngModel",_.checked),i.xp6(1),i.hij(" ",_.checkBoxText," ")}}function v(C,Z){if(1&C&&(i.TgZ(0,"mat-option",15)(1,"span",17),i._uU(2),i.qZA()()),2&C){const _=Z.$implicit;i.Q6J("value",_),i.xp6(2),i.Oqu(_)}}function O(C,Z){if(1&C){const _=i.EpF();i.TgZ(0,"mat-form-field",11)(1,"span",12)(2,"mat-icon"),i._uU(3,"filter_list"),i.qZA(),i.TgZ(4,"span",13),i._uU(5,"|"),i.qZA()(),i.TgZ(6,"mat-select",14),i.NdJ("ngModelChange",function(D){i.CHM(_);const Q=i.oxw();return i.KtG(Q.type=D)})("selectionChange",function(){i.CHM(_);const D=i.oxw();return D.filter(),i.KtG(D.typeChanged())}),i.TgZ(7,"mat-option",15),i._uU(8," Remove filter "),i.qZA(),i.YNc(9,v,3,2,"mat-option",16),i.qZA()()}if(2&C){const _=i.oxw();i.xp6(6),i.Q6J("ngModel",_.type),i.xp6(1),i.Q6J("value",null),i.xp6(2),i.Q6J("ngForOf",_.types)}}function x(C,Z){if(1&C){const _=i.EpF();i.TgZ(0,"button",18),i.NdJ("click",function(){i.CHM(_);const D=i.oxw();return i.KtG(D.removeSearchTerm())}),i.TgZ(1,"mat-icon"),i._uU(2,"close"),i.qZA()()}}function S(C,Z){if(1&C&&(i.TgZ(0,"mat-icon"),i._uU(1),i.qZA()),2&C){const _=i.oxw(2);i.xp6(1),i.Oqu(_.buttonIcon)}}function F(C,Z){if(1&C){const _=i.EpF();i.TgZ(0,"button",19),i.NdJ("click",function(){i.CHM(_);const D=i.oxw();return i.KtG(D.buttonClicked())}),i.YNc(1,S,2,1,"mat-icon",20),i._uU(2),i.qZA()}if(2&C){const _=i.oxw();i.Q6J("disabled",_.buttonDisabled),i.xp6(1),i.Q6J("ngIf",_.buttonIcon),i.xp6(1),i.hij(" ",_.buttonText," ")}}function L(C,Z){if(1&C){const _=i.EpF();i.TgZ(0,"button",19),i.NdJ("click",function(){i.CHM(_);const D=i.oxw();return i.KtG(D.button2Clicked())}),i._uU(1),i.qZA()}if(2&C){const _=i.oxw();i.Q6J("disabled",_.button2Disabled),i.xp6(1),i.hij(" ",_.button2Text," ")}}let N=(()=>{class C{constructor(){this.filterList=new i.vpe,this.buttonClick=new i.vpe,this.button2Click=new i.vpe,this.typeChange=new i.vpe,this.checkBoxText=null,this.buttonText=null,this.button2Text=null,this.buttonIcon=null,this.buttonDisabled=!1,this.button2Disabled=!1,this.checked=!1}ngOnInit(){this.filterControl=new g.NI(""),this.filterControl.valueChanges.pipe((0,c.b)(400),(0,y.x)()).subscribe(()=>{this.filter()})}removeSearchTerm(){this.filterControl.setValue("")}filter(){const _={};this.filterControl.value?.length>0&&(_.searchKey=this.filterControl.value),this.type&&(_.type=this.type),this.checkBoxText&&(_.checked=this.checked),this.filterList.emit(_)}typeChanged(){this.typeChange?.emit(this.type)}buttonClicked(){this.buttonClick.emit()}button2Clicked(){this.button2Click.emit()}}return C.\u0275fac=function(_){return new(_||C)},C.\u0275cmp=i.Xpm({type:C,selectors:[["app-searchbox"]],inputs:{types:"types",type:"type",checkBoxText:"checkBoxText",buttonText:"buttonText",button2Text:"button2Text",buttonIcon:"buttonIcon",buttonDisabled:"buttonDisabled",button2Disabled:"button2Disabled"},outputs:{filterList:"filterList",buttonClick:"buttonClick",button2Click:"button2Click",typeChange:"typeChange"},decls:14,vars:6,consts:[[1,"d-flex","justify-content-md-between","align-items-md-center","align-items-end","flex-md-row","w-100"],["color","primary","class","mt-md-0 mt-1 me-3",3,"ngModel","ngModelChange","change",4,"ngIf"],["class","w-100 standalone-field me-3",4,"ngIf"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Search for item(s)",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","placeholder","Search ...","autocomplete","off",3,"formControl"],["input",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","class","ms-3",3,"disabled","click",4,"ngIf"],["color","primary",1,"mt-md-0","mt-1","me-3",3,"ngModel","ngModelChange","change"],[1,"w-100","standalone-field","me-3"],["matPrefix","","matTooltip","Filter on type",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted","ms-1"],["placeholder","Type ...",3,"ngModel","ngModelChange","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"d-block","name-line"],["mat-icon-button","","matSuffix","",3,"click"],["mat-flat-button","","color","primary",1,"ms-3",3,"disabled","click"],[4,"ngIf"]],template:function(_,q){if(1&_&&(i.TgZ(0,"div",0),i.YNc(1,b,2,2,"mat-checkbox",1),i.YNc(2,O,10,3,"mat-form-field",2),i.TgZ(3,"mat-form-field",3)(4,"span",4)(5,"mat-icon"),i._uU(6,"search"),i.qZA(),i.TgZ(7,"span",5),i._uU(8,"|"),i.qZA()(),i._UZ(9,"input",6,7),i.YNc(11,x,3,0,"button",8),i.qZA(),i.YNc(12,F,3,3,"button",9),i.YNc(13,L,2,2,"button",9),i.qZA()),2&_){const D=i.MAs(10);i.xp6(1),i.Q6J("ngIf",q.checkBoxText),i.xp6(1),i.Q6J("ngIf",(null==q.types?null:q.types.length)>0),i.xp6(7),i.Q6J("formControl",q.filterControl),i.xp6(2),i.Q6J("ngIf",""!==D.value),i.xp6(1),i.Q6J("ngIf",q.buttonText||q.buttonIcon),i.xp6(1),i.Q6J("ngIf",q.button2Text)}},dependencies:[A.sg,A.O5,h.Hw,f.lW,M.KE,M.qo,M.R9,w.Nt,d.oG,e.gM,m.gD,p.ey,g.Fj,g.JJ,g.On,g.oH],encapsulation:2}),C})()},1565:(J,k,s)=>{"use strict";s.d(k,{Q:()=>c});var i=s(4650),g=s(9845);let c=(()=>{class y{constructor(h){this.httpService=h}list(h=null){let f="";return null!==h&&(f+="?limit="+h.limit,f+="&offset="+h.offset,h.filter&&""!==h.filter&&(f+="&filter="+encodeURIComponent(h.filter))),this.httpService.get("/magic/system/cache/list"+f)}count(h=null){let f="";return null!==h&&""!==h&&(f+="?filter="+encodeURIComponent(h)),this.httpService.get("/magic/system/cache/count"+f)}delete(h){return this.httpService.delete("/magic/system/cache/delete?id="+encodeURIComponent(h))}clear(h=null){let f="";return null!==h&&""!==h&&(f+="?filter="+encodeURIComponent(h)),this.httpService.delete("/magic/system/cache/empty"+f)}}return y.\u0275fac=function(h){return new(h||y)(i.LFG(g.O))},y.\u0275prov=i.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},9214:(J,k,s)=>{"use strict";s.d(k,{I:()=>M});var i=s(4327),c=s(9751),y=s(4650),A=s(9845),h=s(3885),f=s(1565);let M=(()=>{class w{constructor(e,m,p){this.httpService=e,this.generalService=m,this.cacheService=p}listFiles(e,m=null){let p="?folder="+encodeURIComponent(e);return m&&(p+="&filter="+encodeURIComponent(m)),this.httpService.get("/magic/system/file-system/list-files"+p)}listFilesRecursively(e,m){let p="?folder="+encodeURIComponent(e);return this.httpService.get("/magic/system/file-system/list-files-recursively"+p+"&sys="+m)}listFolders(e){return this.httpService.get("/magic/system/file-system/list-folders?folder="+encodeURIComponent(e))}listFoldersRecursively(e,m){return this.httpService.get("/magic/system/file-system/list-folders-recursively?folder="+encodeURIComponent(e)+"&sys="+m)}loadFile(e){return this.httpService.get("/magic/system/file-system/file?file="+encodeURIComponent(e),{responseType:"text"})}saveFile(e,m){const p=e.substring(0,e.lastIndexOf("/")+1),b=new FormData,v=new Blob([m],{type:"text/plain"});return b.append("file",v,e.substring(e.lastIndexOf("/")+1)),this.httpService.put("/magic/system/file-system/file?folder="+encodeURIComponent(p),b)}rename(e,m){return this.httpService.post("/magic/system/file-system/rename",{oldName:e,newName:m})}deleteFile(e){return this.httpService.delete("/magic/system/file-system/file?file="+encodeURIComponent(e))}downloadFile(e){this.httpService.download("/magic/system/file-system/file?file="+encodeURIComponent(e)).subscribe({next:m=>{let b=m.headers.get("Content-Disposition").split(";")[1].trim().split("=")[1].replace(/"/g,"");const v=new Blob([m.body]);(0,i.saveAs)(v,b)},error:m=>this.generalService.showFeedback(m?.error?.message??m,"errorMessage","Ok",4e3)})}uploadFile(e,m){const p=new FormData;return p.append("file",m),this.httpService.put("/magic/system/file-system/file?folder="+encodeURIComponent(e),p)}uploadDatabaseBackup(e){return new c.y(m=>{const p=new FormData;p.append("file",e),this.httpService.put("/magic/system/sql/backup",p).subscribe({next:b=>{this.cacheService.delete("magic.sql.databases.sqlite.*").subscribe({next:()=>{m.next(b),m.complete()},error:v=>{m.error(v),m.complete()}})},error:b=>{m.error(b),m.complete()}})})}importUsers(e){const m=new FormData;return m.append("file",e),this.httpService.put("/magic/system/auth/import-users",m)}uploadStaticWebsite(e){return this.httpService.put("/magic/system/file-system/overwrite-folder",e)}downloadFolder(e){this.httpService.download("/magic/system/file-system/download-folder?folder="+encodeURIComponent(e)).subscribe({next:m=>{const p=m.headers.get("Content-Disposition");let b=p.substring(p.indexOf("=")+1);b=b.substring(1,b.lastIndexOf('"'));const v=new Blob([m.body],{type:"application/zip"});(0,i.saveAs)(v,b)},error:m=>this.generalService.showFeedback(m?.error?.message??m,"errorMessage")})}createFolder(e){return this.httpService.put("/magic/system/file-system/folder",{folder:e})}deleteFolder(e){return this.httpService.delete("/magic/system/file-system/folder?folder="+encodeURIComponent(e))}getMacroDefinition(e){return this.httpService.get("/magic/system/ide/macro?macro="+encodeURIComponent(e))}executeMacro(e,m){return this.httpService.post("/magic/system/ide/execute-macro",{macro:e,args:m})}installModule(e){const m=new FormData;return m.append("file",e),this.httpService.put("/magic/system/file-system/install-module",m)}unzip(e){return this.httpService.put("/magic/system/file-system/unzip",{file:e,create_folder:!0})}}return w.\u0275fac=function(e){return new(e||w)(y.LFG(A.O),y.LFG(h.m),y.LFG(f.Q))},w.\u0275prov=y.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},3820:(J,k,s)=>{"use strict";s.r(k),s.d(k,{SqlStudioModule:()=>Xe});var i=s(6895),g=s(4006),c=s(1103),y=s(1717),A=s(2278),h=s(1075),f=s(7832),M=s(9132),w=s(4707),d=s(5938),e=s(4650),m=s(4859),p=s(9549),b=s(4144);let v=(()=>{class a{constructor(t,n){this.dialogRef=t,this.data=n,this.codemirrorReady=!1,this.options=null}create(){this.dialogRef.close({apply:!0})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.so),e.Y36(d.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-apply-migrate-script"]],decls:11,vars:2,consts:[["mat-dialog-title","",1,"mb-1"],["mat-dialog-content","",1,"new-field-dialog"],[1,"w-100","standalone-field","mt-2"],["disabled","","matInput","","rows","10",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",1,"px-4",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Apply migrate scripts?"),e.qZA(),e.TgZ(2,"div",1)(3,"mat-form-field",2)(4,"textarea",3),e.NdJ("ngModelChange",function(l){return n.data.sql=l}),e._uU(5,"    "),e.qZA()()(),e.TgZ(6,"div",4)(7,"button",5),e._uU(8," Cancel "),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return n.create()}),e._uU(10," Create "),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngModel",n.data.sql),e.xp6(2),e.Q6J("align","end"))},dependencies:[m.lW,p.KE,b.Nt,d.ZT,d.uh,d.xY,d.H8,g.Fj,g.JJ,g.On],encapsulation:2}),a})();var O=s(8588);function x(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ngx-codemirror",7),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.data.result=o)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngModel",t.data.result)("options",t.options)}}let F=(()=>{class a{constructor(t,n){this.data=t,this.codemirrorActionsService=n,this.options=null,this.codemirrorReady=!1}ngOnInit(){this.getCodeMirrorOptions()}getCodeMirrorOptions(){const t=this.codemirrorActionsService.getActions(null,"sql");this.options=t,setTimeout(()=>{this.codemirrorInit()},100)}codemirrorInit(){this.codemirrorReady=!0,setTimeout(()=>{const n=document.querySelector(".CodeMirror").CodeMirror;n.doc.markClean(),n.doc.clearHistory()},100)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.WI),e.Y36(O.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-export-ddl"]],decls:11,vars:4,consts:[["mat-dialog-title","",1,"mb-0"],[1,"text-muted","mb-4"],["mat-dialog-content","",1,"codemirror-dialog"],["name","content",3,"ngModel","options","ngModelChange",4,"ngIf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",1,"px-4",3,"mat-dialog-close"],["name","content",3,"ngModel","options","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Export DDL"),e.qZA(),e.TgZ(2,"p",1),e._uU(3),e.qZA(),e.TgZ(4,"div",2),e.YNc(5,x,1,2,"ngx-codemirror",3),e.qZA(),e.TgZ(6,"div",4)(7,"button",5),e._uU(8," Cancel "),e.qZA(),e.TgZ(9,"button",6),e._uU(10," Export to module "),e.qZA()()),2&t&&(e.xp6(3),e.hij(" Export ","table"===n.data.type?"table":"database"," to a module as DDL (Data Definition Language)\n"),e.xp6(2),e.Q6J("ngIf",n.codemirrorReady),e.xp6(1),e.Q6J("align","end"),e.xp6(3),e.Q6J("mat-dialog-close",n.data))},dependencies:[i.O5,m.lW,d.ZT,d.uh,d.xY,d.H8,c.C,g.JJ,g.On],styles:[".codemirror-dialog .CodeMirror{height:64vh}  .codemirror-dialog .CodeMirror-hscrollbar{left:0!important}"]}),a})();var L=s(3885),N=s(7392),C=s(266),Z=s(4385),_=s(3238);function q(a,r){if(1&a&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function D(a,r){if(1&a&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}let Q=(()=>{class a{constructor(t,n,o){this.generalService=t,this.dialogRef=n,this.data=o,this.formData={table1:"",table2:""}}secondTableList(){return""!==this.formData.table1?this.data.filter(t=>t.name!==this.formData.table1.name):[]}create(){""!==this.formData.table1&&""!==this.formData.table2?this.dialogRef.close(this.formData):this.generalService.showFeedback("Please select both tables.","errorMessage")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(L.m),e.Y36(d.so),e.Y36(d.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-link-table"]],decls:30,vars:7,consts:[["mat-dialog-title","",1,"mb-1"],[1,"text-muted","mb-4"],["mat-dialog-content","",1,"new-field-dialog"],[1,"w-100","standalone-field","mt-2"],["matPrefix","","matTooltip","Table 1",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["placeholder","Table 1",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Table 2",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Table 2",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",1,"px-4",3,"click"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Add link table"),e.qZA(),e.TgZ(2,"p",1),e._uU(3,"Create a link table connecting two tables together"),e.qZA(),e.TgZ(4,"div",2)(5,"mat-form-field",3)(6,"span",4)(7,"mat-icon"),e._uU(8,"conversion_path"),e.qZA(),e.TgZ(9,"span",5),e._uU(10,"|"),e.qZA()(),e.TgZ(11,"mat-select",6),e.NdJ("ngModelChange",function(l){return n.formData.table1=l}),e.TgZ(12,"mat-select-trigger"),e._uU(13),e.qZA(),e.YNc(14,q,2,2,"mat-option",7),e.qZA()(),e.TgZ(15,"mat-form-field",8)(16,"span",9)(17,"mat-icon"),e._uU(18,"conversion_path"),e.qZA(),e.TgZ(19,"span",5),e._uU(20,"|"),e.qZA()(),e.TgZ(21,"mat-select",10),e.NdJ("ngModelChange",function(l){return n.formData.table2=l}),e.TgZ(22,"mat-select-trigger"),e._uU(23),e.qZA(),e.YNc(24,D,2,2,"mat-option",7),e.qZA()()(),e.TgZ(25,"div",11)(26,"button",12),e._uU(27," Cancel "),e.qZA(),e.TgZ(28,"button",13),e.NdJ("click",function(){return n.create()}),e._uU(29," Create "),e.qZA()()),2&t&&(e.xp6(11),e.Q6J("ngModel",n.formData.table1),e.xp6(2),e.hij(" ",null==n.formData||null==n.formData.table1?null:n.formData.table1.name," "),e.xp6(1),e.Q6J("ngForOf",n.data),e.xp6(7),e.Q6J("ngModel",n.formData.table2),e.xp6(2),e.hij(" ",null==n.formData||null==n.formData.table2?null:n.formData.table2.name," "),e.xp6(1),e.Q6J("ngForOf",n.secondTableList()),e.xp6(1),e.Q6J("align","end"))},dependencies:[i.sg,N.Hw,m.lW,p.KE,p.qo,d.ZT,d.uh,d.xY,d.H8,C.gM,Z.gD,Z.$L,_.ey,g.JJ,g.On],encapsulation:2}),a})();var V=s(9554),Y=s(8194);function W(a,r){if(1&a&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}let H=(()=>{class a{constructor(t,n){this.generalService=t,this.dialogRef=n,this.data={name:"",pkName:"",pkType:"auto_increment",pkLength:10,pkDefault:""},this.primaryKeyTypeList=z,this.CommonRegEx=Y.g,this.CommonErrorMessages=V.v}nameChanged(){let t=this.data.name;t.endsWith("s")&&(t=t.substring(0,t.length-1)),this.data.pkName=""!==t?t+"_id":""}create(){this.validateName()?this.dialogRef.close(this.data):this.generalService.showFeedback("Invalid name of table or primary key","errorMessage")}validateName(){return this.CommonRegEx.appNameWithUppercase.test(this.data.name)&&this.CommonRegEx.appNameWithUppercase.test(this.data.pkName)&&this.data.pkLength>3}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(L.m),e.Y36(d.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-table"]],decls:37,vars:9,consts:[["mat-dialog-title","",1,"mb-1"],[1,"text-muted","mb-4"],[3,"ngSubmit"],["mat-dialog-content",""],[1,"w-100","standalone-field","mt-2"],["matPrefix","","matTooltip","Name of table",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","type","text","placeholder","Table name","name","table_name",3,"ngModel","pattern","ngModelChange"],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Name of primary key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","type","text","placeholder","Primary key name","name","pk_name",3,"ngModel","pattern","ngModelChange"],["matPrefix","","matTooltip","Type of primary key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Primary key type","name","pk_type",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary","type","submit",1,"px-4"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Add table"),e.qZA(),e.TgZ(2,"p",1),e._uU(3,"Create a new table and its primary key"),e.qZA(),e.TgZ(4,"form",2),e.NdJ("ngSubmit",function(){return n.create()}),e.TgZ(5,"div",3)(6,"mat-form-field",4)(7,"span",5)(8,"mat-icon"),e._uU(9,"edit"),e.qZA(),e.TgZ(10,"span",6),e._uU(11,"|"),e.qZA()(),e.TgZ(12,"input",7),e.NdJ("ngModelChange",function(l){return n.data.name=l})("ngModelChange",function(){return n.nameChanged()}),e.qZA(),e.TgZ(13,"mat-error"),e._uU(14),e.qZA()(),e.TgZ(15,"mat-form-field",8)(16,"span",9)(17,"mat-icon"),e._uU(18,"key"),e.qZA(),e.TgZ(19,"span",6),e._uU(20,"|"),e.qZA()(),e.TgZ(21,"input",10),e.NdJ("ngModelChange",function(l){return n.data.pkName=l}),e.qZA(),e.TgZ(22,"mat-error"),e._uU(23),e.qZA()(),e.TgZ(24,"mat-form-field",8)(25,"span",11)(26,"mat-icon"),e._uU(27,"dehaze"),e.qZA(),e.TgZ(28,"span",6),e._uU(29,"|"),e.qZA()(),e.TgZ(30,"mat-select",12),e.NdJ("ngModelChange",function(l){return n.data.pkType=l}),e.YNc(31,W,2,2,"mat-option",13),e.qZA()()(),e.TgZ(32,"div",14)(33,"button",15),e._uU(34," Cancel "),e.qZA(),e.TgZ(35,"button",16),e._uU(36," Create "),e.qZA()()()),2&t&&(e.xp6(12),e.Q6J("ngModel",n.data.name)("pattern",n.CommonRegEx.appNameWithUppercase),e.xp6(2),e.Oqu(n.CommonErrorMessages.appNameWithUppercase),e.xp6(7),e.Q6J("ngModel",n.data.pkName)("pattern",n.CommonRegEx.appNameWithUppercase),e.xp6(2),e.Oqu(n.CommonErrorMessages.appNameWithUppercase),e.xp6(7),e.Q6J("ngModel",n.data.pkType),e.xp6(1),e.Q6J("ngForOf",n.primaryKeyTypeList),e.xp6(1),e.Q6J("align","end"))},dependencies:[i.sg,N.Hw,m.lW,p.TO,p.KE,p.qo,b.Nt,d.ZT,d.uh,d.xY,d.H8,C.gM,Z.gD,_.ey,g._Y,g.Fj,g.JJ,g.JL,g.c5,g.On,g.F],encapsulation:2}),a})();const z=[{value:"auto_increment",name:"Auto increment"},{value:"varchar",name:"Varchar"}];var P=s(3280),$=s(1565),j=s(9311),R=s(8255),I=s(3546),B=s(455),G=s(6996),K=s(3848),X=s(6709);function ee(a,r){if(1&a&&(e.TgZ(0,"mat-option",31)(1,"span",32,33),e._uU(3),e.qZA(),e.TgZ(4,"span",34),e._uU(5),e.qZA()()),2&a){const t=r.$implicit;e.Q6J("value",t),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description)}}function te(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",10)(1,"span",35)(2,"mat-icon"),e._uU(3,"account_balance"),e.qZA(),e.TgZ(4,"span",7),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"input",36),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.formData.defaultValue=o)}),e.qZA(),e.TgZ(7,"mat-error"),e._uU(8),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.formData.defaultValue),e.xp6(2),e.Oqu(t.CommonErrorMessages.appNameWithUppercase)}}function ne(a,r){if(1&a&&(e.TgZ(0,"mat-hint",40),e._uU(1),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.hij(" ","Size between "+t.formData.fieldType.size.min+" and "+t.formData.fieldType.size.max," ")}}function ae(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",10)(1,"span",37)(2,"mat-icon"),e._uU(3,"format_size"),e.qZA(),e.TgZ(4,"span",7),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"input",38),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.formData.columnLength=o)}),e.qZA(),e.YNc(7,ne,2,1,"mat-hint",39),e.qZA()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("placeholder","Size between "+t.formData.fieldType.size.min+" and "+t.formData.fieldType.size.max)("ngModel",t.formData.columnLength)("pattern",t.CommonRegEx.appNameWithUppercase)("min",t.formData.fieldType.size.min)("max",t.formData.fieldType.size.max),e.xp6(1),e.Q6J("ngIf",t.formData.columnLength<t.formData.fieldType.size.min||t.formData.columnLength>t.formData.fieldType.size.max)}}function ie(a,r){if(1&a&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",null==t?null:t.name," ")}}function oe(a,r){if(1&a&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",null==t?null:t.name),e.xp6(1),e.hij(" ",null==t?null:t.name," ")}}let le=(()=>{class a{constructor(t,n,o){this.generalService=t,this.dialogRef=n,this.data=o,this.formData={columnName:"",fieldType:{},columnLength:void 0,defaultValue:"",nullable:!0,indexed:!1},this.fieldTypeList=se,this.CommonRegEx=Y.g,this.CommonErrorMessages=V.v}changeDefaultValue(){this.formData.defaultValue="";const t="mysql"===this.data.selectedDbType||"sqlite"===this.data.selectedDbType,n="mysql"===this.data.selectedDbType||"sqlite"===this.data.selectedDbType||"pgsql"===this.data.selectedDbType;this.formData.fieldType.size?this.formData.columnLength=this.formData?.fieldType?.size?.defaultSize:"date"===this.formData.fieldType.defaultValue&&n?this.formData.defaultValue="current_timestamp":"int"===this.formData.fieldType.defaultValue&&t&&(this.formData.defaultValue="auto_increment"),this.formData.columnType=this.formData.fieldType.name}changeTable(){this.formData.foreignField=this.data.tables.find(t=>t.name===this.formData.selectedTable.name).columns[0].name,this.changeColumnName()}changeColumnName(){this.formData.columnName=this.formData.foreignField}tabsChanged(t){let n={nullable:!1,indexed:!1};1===t.index&&(n.cascading=!1),this.formData=n}create(){if(!this.validateName())return void this.generalService.showFeedback("Invalid name","errorMessage");if(""!==this.formData.defaultValue&&!this.validateDefaultValue())return void this.generalService.showFeedback("Invalid default value","errorMessage");let t=!1;t=void 0!==this.formData?.cascading?this.formData.selectedTable&&this.formData.foreignField&&""!==this.formData.columnName:this.formData.fieldType.size?""!==this.formData.columnName&&this.formData.fieldType&&this.formData.columnLength&&this.formData.columnLength>=this.formData.fieldType.size.min&&this.formData.columnLength<=this.formData.fieldType.size.max:""!==this.formData.columnName&&this.formData.fieldType.name,t?this.dialogRef.close(this.formData):this.generalService.showFeedback("Please fill the required fields","errorMessage")}validateName(){return this.CommonRegEx.appNameWithUppercase.test(this.formData.columnName)}validateDefaultValue(){return this.CommonRegEx.appNameWithUppercase.test(this.formData.defaultValue)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(L.m),e.Y36(d.so),e.Y36(d.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-field-or-key"]],decls:71,vars:22,consts:[["mat-dialog-title",""],[3,"ngSubmit"],["mat-dialog-content","",1,"new-field-dialog"],["mat-stretch-tabs","","dynamicHeight","","animationDuration","0ms",3,"selectedTabChange"],["label","Column"],[1,"w-100","standalone-field","mt-4"],["matPrefix","","matTooltip","Name of column",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["matInput","","type","text","placeholder","Column name","name","column_name","autocomplete","off","cdkFocusInitial","",3,"ngModel","pattern","ngModelChange"],["name",""],[1,"w-100","standalone-field"],["matPrefix","","matTooltip","Type of column",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Column type","name","field_type",3,"ngModel","ngModelChange"],["class","multiline-mat-option",3,"value",4,"ngFor","ngForOf"],["class","w-100 standalone-field",4,"ngIf"],[1,"d-flex","justify-content-end","mt-2"],["color","primary","labelPosition","before","name","indexed",1,"me-3",3,"ngModel","ngModelChange"],["color","primary","labelPosition","before","name","nullable",3,"ngModel","ngModelChange"],["label","Foreign key"],["matPrefix","","matTooltip","Foreign table",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Foreign table","name","selected_table",3,"ngModel","ngModelChange","selectionChange"],["matPrefix","","matTooltip","Foreign column",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["placeholder","Foreign column","name","foreign_field",3,"ngModel","ngModelChange","selectionChange"],["matPrefix","","matTooltip","Name of foreign key",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","type","text","placeholder","Foreign key name","autocomplete","off","name","column_name",3,"value","ngModel","pattern","ngModelChange"],[1,"d-flex","justify-content-end"],["color","primary","name","nullable",1,"me-2",3,"ngModel","ngModelChange"],["color","primary","name","cascade",3,"ngModel","ngModelChange"],["mat-dialog-actions","",3,"align"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary","type","submit",1,"px-4"],[1,"multiline-mat-option",3,"value"],[1,"d-block","name-line"],["typeName",""],[1,"d-block","description-line"],["matPrefix","","matTooltip","Default value of column",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","type","text","placeholder","Default value","autocomplete","off","name","default_value",3,"ngModel","ngModelChange"],["matPrefix","","matTooltip","Maximum size of column",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],["matInput","","type","number","name","column_length","autocomplete","off","name","-",3,"placeholder","ngModel","pattern","min","max","ngModelChange"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"h3",0),e._uU(1,"Add field or foreign key"),e.qZA(),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return n.create()}),e.TgZ(3,"div",2)(4,"mat-tab-group",3),e.NdJ("selectedTabChange",function(l){return n.tabsChanged(l)}),e.TgZ(5,"mat-tab",4)(6,"mat-form-field",5)(7,"span",6)(8,"mat-icon"),e._uU(9,"edit"),e.qZA(),e.TgZ(10,"span",7),e._uU(11,"|"),e.qZA()(),e.TgZ(12,"input",8,9),e.NdJ("ngModelChange",function(l){return n.formData.columnName=l}),e.qZA(),e.TgZ(14,"mat-error"),e._uU(15),e.qZA()(),e.TgZ(16,"mat-form-field",10)(17,"span",11)(18,"mat-icon"),e._uU(19,"dehaze"),e.qZA(),e.TgZ(20,"span",7),e._uU(21,"|"),e.qZA()(),e.TgZ(22,"mat-select",12),e.NdJ("ngModelChange",function(l){return n.formData.fieldType=l})("ngModelChange",function(){return n.changeDefaultValue()}),e.TgZ(23,"mat-select-trigger"),e._uU(24),e.qZA(),e.YNc(25,ee,6,3,"mat-option",13),e.qZA()(),e.YNc(26,te,9,2,"mat-form-field",14),e.YNc(27,ae,8,6,"mat-form-field",14),e.TgZ(28,"p",15)(29,"mat-checkbox",16),e.NdJ("ngModelChange",function(l){return n.formData.indexed=l}),e._uU(30," Indexed "),e.qZA(),e.TgZ(31,"mat-checkbox",17),e.NdJ("ngModelChange",function(l){return n.formData.nullable=l}),e._uU(32," Nullable "),e.qZA()()(),e.TgZ(33,"mat-tab",18)(34,"mat-form-field",5)(35,"span",19)(36,"mat-icon"),e._uU(37,"conversion_path"),e.qZA(),e.TgZ(38,"span",7),e._uU(39,"|"),e.qZA()(),e.TgZ(40,"mat-select",20),e.NdJ("ngModelChange",function(l){return n.formData.selectedTable=l})("selectionChange",function(){return n.changeTable()}),e.TgZ(41,"mat-select-trigger"),e._uU(42),e.qZA(),e.YNc(43,ie,2,2,"mat-option",13),e.qZA()(),e.TgZ(44,"mat-form-field",10)(45,"span",21)(46,"mat-icon"),e._uU(47,"apps"),e.qZA(),e.TgZ(48,"span",7),e._uU(49,"|"),e.qZA()(),e.TgZ(50,"mat-select",22),e.NdJ("ngModelChange",function(l){return n.formData.foreignField=l})("selectionChange",function(){return n.changeColumnName()}),e.YNc(51,oe,2,2,"mat-option",13),e.qZA()(),e.TgZ(52,"mat-form-field",10)(53,"span",23)(54,"mat-icon"),e._uU(55,"edit"),e.qZA(),e.TgZ(56,"span",7),e._uU(57,"|"),e.qZA()(),e.TgZ(58,"input",24),e.NdJ("ngModelChange",function(l){return n.formData.columnName=l}),e.qZA(),e.TgZ(59,"mat-error"),e._uU(60),e.qZA()(),e.TgZ(61,"p",25)(62,"mat-checkbox",26),e.NdJ("ngModelChange",function(l){return n.formData.nullable=l}),e._uU(63," Nullable "),e.qZA(),e.TgZ(64,"mat-checkbox",27),e.NdJ("ngModelChange",function(l){return n.formData.cascading=l}),e._uU(65," Cascade "),e.qZA()()()()(),e.TgZ(66,"div",28)(67,"button",29),e._uU(68," Cancel "),e.qZA(),e.TgZ(69,"button",30),e._uU(70," Add "),e.qZA()()()),2&t&&(e.xp6(12),e.Q6J("ngModel",n.formData.columnName)("pattern",n.CommonRegEx.appNameWithUppercase),e.xp6(3),e.Oqu(n.CommonErrorMessages.appNameWithUppercase),e.xp6(7),e.Q6J("ngModel",n.formData.fieldType),e.xp6(2),e.hij(" ",null==n.formData||null==n.formData.fieldType?null:n.formData.fieldType.name," "),e.xp6(1),e.Q6J("ngForOf",n.fieldTypeList[n.data.selectedDbType]),e.xp6(1),e.Q6J("ngIf",null==n.formData||null==n.formData.fieldType?null:n.formData.fieldType.defaultValue),e.xp6(1),e.Q6J("ngIf",null==n.formData||null==n.formData.fieldType?null:n.formData.fieldType.size),e.xp6(2),e.Q6J("ngModel",n.formData.indexed),e.xp6(2),e.Q6J("ngModel",n.formData.nullable),e.xp6(9),e.Q6J("ngModel",n.formData.selectedTable),e.xp6(2),e.hij(" ",null==n.formData||null==n.formData.selectedTable?null:n.formData.selectedTable.name," "),e.xp6(1),e.Q6J("ngForOf",n.data.tables),e.xp6(7),e.Q6J("ngModel",n.formData.foreignField),e.xp6(1),e.Q6J("ngForOf",null==n.formData.selectedTable?null:n.formData.selectedTable.columns),e.xp6(7),e.Q6J("value",n.formData.foreignField?n.formData.foreignField+"_column":"")("ngModel",n.formData.columnName)("pattern",n.CommonRegEx.appNameWithUppercase),e.xp6(2),e.Oqu(n.CommonErrorMessages.appNameWithUppercase),e.xp6(2),e.Q6J("ngModel",n.formData.nullable),e.xp6(2),e.Q6J("ngModel",n.formData.cascading),e.xp6(2),e.Q6J("align","end"))},dependencies:[i.sg,i.O5,N.Hw,m.lW,K.SP,K.uX,p.TO,p.KE,p.bx,p.qo,b.Nt,X.oG,d.ZT,d.uh,d.xY,d.H8,C.gM,Z.gD,Z.$L,_.ey,g._Y,g.Fj,g.wV,g.JJ,g.JL,g.c5,g.qQ,g.Fd,g.On,g.F],styles:[".new-field-dialog .mat-tab-label{font-weight:400}"]}),a})();const se={mysql:[{name:"int",description:"A whole number with no decimals that can be positive, negative, or zero.",defaultValue:"number"},{name:"varchar",description:"A variable character field of indeterminate length, which can hold letters and numbers.",size:{min:0,max:16383},defaultValue:"string"},{name:"mediumtext",description:"Strings up to 16MB for longer text fields and / or images and files.",defaultValue:"string"},{name:"bool",description:"A binary variable that can have one of two possible values, True and False.",defaultValue:"bool"},{name:"decimal",description:"A whole number with decimals."},{name:"datetime",description:"A variable that can hold both date and time.",defaultValue:"date"}],sqlite:[{name:"integer",description:"A whole number with no decimals that can be positive, negative, or zero.",defaultValue:"int"},{name:"numeric",description:"A whole number with decimals.",defaultValue:"decimal"},{name:"text",description:"A variable character field of indeterminate length, which can hold letters and numbers.",defaultValue:"string"},{name:"timestamp",description:"A variable that can hold both date and time.",defaultValue:"date"}],pgsql:[{name:"integer",description:"A whole number with no decimals that can be positive, negative, or zero.",defaultValue:"numeric"},{name:"numeric",description:"A whole number with decimals.",defaultValue:"numeric"},{name:"text",description:"A variable character field of indeterminate length, which can hold letters and numbers.",defaultValue:"string"},{name:"boolean",description:"A binary variable that can have one of two possible values, True and False.",defaultValue:"bool"},{name:"timestamptz",description:"A variable that can hold both date and time.",defaultValue:"date"}],mssql:[{name:"int",description:"A whole number with no decimals that can be positive, negative, or zero.",defaultValue:"integer"},{name:"decimal",description:"A whole number with decimals.",defaultValue:"decimal"},{name:"datetime2",description:"A variable that can hold both date and time.",defaultValue:"date"},{name:"nvarchar",description:"Strings with length of up to 2GB (4,000).",size:{min:0,max:4e3},defaultValue:!1},{name:"ntext",description:"Strings with length of up to 1,073,741,823 bytes for longer text fields and / or images and files.",defaultValue:"string"}]};function re(a,r){1&a&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",2),e.BQk())}function ce(a,r){1&a&&(e.TgZ(0,"mat-icon",26),e._uU(1," key "),e.qZA())}function de(a,r){1&a&&(e.TgZ(0,"mat-icon",27),e._uU(1," motion_photos_off "),e.qZA())}function me(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"p",19),e.YNc(3,ce,2,0,"mat-icon",20),e.YNc(4,de,2,0,"mat-icon",21),e._uU(5),e.qZA()(),e.TgZ(6,"div",22)(7,"p",23),e._uU(8),e.qZA()(),e.TgZ(9,"div",24)(10,"button",25),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw().$implicit,T=e.oxw(2);return e.KtG(T.dropItem(l,"column",u.foreign_keys,u.name,u))}),e.TgZ(11,"mat-icon"),e._uU(12,"delete"),e.qZA()()()()}if(2&a){const t=r.$implicit;e.xp6(3),e.Q6J("ngIf",t.primary),e.xp6(1),e.Q6J("ngIf",!0===(null==t?null:t.nullable)&&!t.primary),e.xp6(1),e.hij(" ",t.name," "),e.xp6(3),e.hij(" ",t.db," ")}}function pe(a,r){1&a&&e._UZ(0,"hr",28)}function ue(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",31),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(4);return e.KtG(u.scrollTableIntoView(l))}),e.TgZ(1,"div",32)(2,"p",33),e._uU(3),e.TgZ(4,"mat-icon",34),e._uU(5,"trending_flat"),e.qZA(),e._uU(6),e.qZA()()()}if(2&a){const t=r.$implicit;e.ekj("mb-2",!r.last),e.xp6(3),e.hij(" ",null==t?null:t.column," "),e.xp6(3),e.AsE(" ",null==t?null:t.foreign_table,".",t.foreign_column," ")}}function ge(a,r){if(1&a&&(e.TgZ(0,"div",29),e.YNc(1,ue,7,5,"div",30),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.foreign_keys)}}function _e(a,r){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=r.$implicit,n=r.last;e.xp6(1),e.Oqu(t+(n?"":", "))}}function fe(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",36)(1,"div",32)(2,"p",33),e._uU(3),e.TgZ(4,"mat-icon",34),e._uU(5,"swap_horiz"),e.qZA(),e.YNc(6,_e,2,1,"span",37),e.qZA(),e.TgZ(7,"button",38),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(2).$implicit,T=e.oxw(2);return e.KtG(T.dropItem(l,"index",u.foreign_keys,u.name))}),e.TgZ(8,"mat-icon"),e._uU(9,"delete"),e.qZA()()()()}if(2&a){const t=r.$implicit;e.ekj("mb-2",!r.last),e.xp6(3),e.hij(" ",null==t?null:t.name," "),e.xp6(3),e.Q6J("ngForOf",t.columns)}}function he(a,r){if(1&a&&(e.TgZ(0,"div",29),e.YNc(1,fe,10,4,"div",35),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.indexes)}}function be(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",5)(1,"mat-card",6)(2,"mat-card-content")(3,"div",7)(4,"p",8),e._uU(5),e.qZA(),e.TgZ(6,"div",9)(7,"button",10),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.addColumnOrKey(l))}),e.TgZ(8,"mat-icon"),e._uU(9,"add"),e.qZA()(),e._UZ(10,"div",11),e.TgZ(11,"button",12),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.viewTableDDL(l.name))}),e.TgZ(12,"mat-icon"),e._uU(13,"file_download"),e.qZA()(),e._UZ(14,"div",11),e.TgZ(15,"button",13),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.dropItem(l,"table"))}),e.TgZ(16,"mat-icon"),e._uU(17,"delete"),e.qZA()()()(),e.YNc(18,me,13,4,"div",14),e.YNc(19,pe,1,0,"hr",15),e.YNc(20,ge,2,1,"div",16),e.YNc(21,he,2,1,"div",16),e.qZA()()()}if(2&a){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Tol(n.activeTable===t.name?"active":""),e.Q6J("id",t.name),e.xp6(4),e.Oqu(t.name),e.xp6(13),e.Q6J("ngForOf",t.columns),e.xp6(1),e.Q6J("ngIf",t.foreign_keys&&t.foreign_keys.length>0||t.indexes&&t.indexes.length>0),e.xp6(1),e.Q6J("ngIf",t.foreign_keys&&t.foreign_keys.length>0),e.xp6(1),e.Q6J("ngIf",t.indexes&&t.indexes.length>0)}}function Te(a,r){if(1&a&&(e.TgZ(0,"div",3),e.YNc(1,be,22,8,"div",4),e.ALo(2,"async"),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t.tables))}}let ve=(()=>{class a{constructor(t,n,o){this.dialog=t,this.sqlService=n,this.generalService=o,this.tablesList=[],this.selectedDatabase="",this.selectedDbType="",this.selectedConnectionString="",this.getDatabases=new e.vpe,this.activeTable=null}ngOnInit(){this.tableSubscription=this.tables.subscribe(t=>{this.tablesList=t})}addColumnOrKey(t){this.dialog.open(le,{width:"500px",data:{table:t,tables:this.tablesList,databases:this.databases,selectedDbType:this.selectedDbType}}).afterClosed().subscribe(n=>{n&&(n.selectedTable?this.addForeignKey(n,t):this.addColumn(n,t))})}scrollTableIntoView(t){document.getElementById(t.foreign_table).scrollIntoView(),this.activeTable=t.foreign_table,setTimeout(()=>{this.activeTable=null},2e3)}dropItem(t,n,o,l,u){let T=null;if("column"===n&&o&&(o?.filter(E=>E.column===t.name)||[]).length>0){if("sqlite"===this.selectedDbType)return void this.generalService.showFeedback("SQLite doesn't allow for deleting columns with foreign keys","errorMessage","Ok",5e3);T=o?.filter(E=>E.column===t.name)[0].name}this.dialog.open(G.z,{width:"500px",data:{title:`Delete ${n} ${t?.name}`,description_extra:`This action is permanent and you will lose all data in your ${n}.<br/><br/>Please type in the <span class="fw-bold">${n} name</span> below.`,action_btn:`Delete ${n}`,action_btn_color:"warn",bold_description:!0,extra:{details:t,action:"confirmInput",fieldToBeTypedTitle:`${n} name`,fieldToBeTypedValue:t.name,icon:"table"}}}).afterClosed().subscribe(E=>{"confirm"===E&&("table"===n?this.deleteTable(t):"column"===n?this.deleteColumn(t,l,T,u):"index"===n&&this.deleteIndex(t,l))})}viewTableDDL(t){"mssql"!==this.selectedDbType?(this.generalService.showLoading(),this.sqlService.exportDdl(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,[t],!1).subscribe({next:n=>{this.generalService.hideLoading(),this.dialog.open(F,{width:"80vw",panelClass:"light",data:{result:n.result,full:!1,module:this.selectedDatabase,type:"table"}}).afterClosed().subscribe(o=>{o&&(this.generalService.showLoading(),this.sqlService.exportToModule(this.selectedDbType,this.selectedDatabase,o.result).subscribe({next:()=>{this.generalService.showFeedback("Table successfully exported","successMessage"),this.generalService.hideLoading()},error:l=>{this.generalService.hideLoading(),this.generalService.showFeedback(l?.error?.message??l,"errorMessage","Ok",5e3)}}))})},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage","Ok",5e3)}})):this.generalService.showFeedback("SQL Server does not allow us to easily view DDL")}ngOnDestroy(){this.tableSubscription?.unsubscribe()}deleteTable(t){this.generalService.showLoading(),this.sqlService.dropTable(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,t.name).subscribe({next:n=>{this.generalService.hideLoading(),this.generalService.showFeedback("Table was successfully deleted","successMessage"),this.getDatabases.emit(!0),this.applyMigration(n.sql)},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage","Ok",5e3)}})}deleteColumn(t,n,o,l){if(l?.indexes)for(const u of l.indexes)if(u.columns.filter(T=>T===t.name).length>0)return void this.generalService.showFeedback("You need to drop indexes referencing column first","errorMessage");o?(this.generalService.showLoading(),this.sqlService.deleteFk(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,n,o).subscribe({next:()=>{this.generalService.hideLoading(),this.deleteColumn(t,n,null)},error:u=>{this.generalService.hideLoading(),this.generalService.showFeedback(u?.error?.message??u,"errorMessage","Ok",5e3)}})):(this.generalService.showLoading(),this.sqlService.deleteColumn(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,n,t.name).subscribe({next:u=>{this.generalService.hideLoading(),this.generalService.showFeedback("Column successfully deleted","successMessage"),this.getDatabases.emit(!0),this.applyMigration(u.sql)},error:u=>{this.generalService.hideLoading(),this.generalService.showFeedback(u?.error?.message??u,"errorMessage","Ok",5e3)}}))}deleteIndex(t,n){this.generalService.showLoading(),this.sqlService.deleteIndex(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,n,t.name).subscribe({next:o=>{this.generalService.hideLoading(),this.generalService.showFeedback("Index successfully deleted","successMessage"),this.getDatabases.emit(!0),this.applyMigration(o.sql)},error:o=>{this.generalService.hideLoading(),this.generalService.showFeedback(o?.error?.message??o,"errorMessage","Ok",5e3)}})}applyMigration(t){!this.migrate||this.dialog.open(v,{width:"80vw",data:{sql:t}}).afterClosed().subscribe(n=>{n&&(this.generalService.showLoading(),this.sqlService.createMigrationScript(this.selectedDbType,this.selectedDatabase,t).subscribe({next:()=>{this.generalService.hideLoading(),this.generalService.showFeedback("Migration script successfully applied","successMessage")},error:()=>{this.generalService.hideLoading(),this.generalService.showFeedback("Something went wrong as we tried to apply migration script","errorMessage")}}))})}addColumn(t,n){let o=null;t.defaultValue&&""!==t.defaultValue&&(o="string"===t.fieldType.defaultValue?"'"+t.defaultValue+"'":t.defaultValue),this.generalService.showLoading(),this.sqlService.addColumn(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,n.name,t.columnName,t.columnType,o,t.nullable,t.indexed,t.columnLength).subscribe({next:l=>{this.generalService.hideLoading(),this.generalService.showFeedback("Column successfully added to table","successMessage"),this.getDatabases.emit(!0),this.applyMigration(l.sql)},error:l=>{this.generalService.hideLoading(),this.generalService.showFeedback(l?.error?.message??l,"errorMessage","Ok",5e3)}})}addForeignKey(t,n){const o=t.selectedTable.columns.find(l=>l.name===t?.foreignField);this.generalService.showLoading(),this.sqlService.addReferencedColumn(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,n.name,t.columnName,o.db,t.selectedTable.name,t.foreignField,t.nullable,t.columnLength,t.cascading).subscribe({next:l=>{this.generalService.hideLoading(),this.generalService.showFeedback("Foreign key successfully added to table.","successMessage"),this.getDatabases.emit(!0),this.applyMigration(l.sql)},error:l=>{this.generalService.hideLoading(),this.generalService.showFeedback(l?.error?.message??l,"errorMessage","Ok",5e3)}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.uw),e.Y36(P.a),e.Y36(L.m))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-tables-view"]],inputs:{dbLoading:"dbLoading",tables:"tables",databases:"databases",selectedDatabase:"selectedDatabase",selectedDbType:"selectedDbType",selectedConnectionString:"selectedConnectionString",migrate:"migrate"},outputs:{getDatabases:"getDatabases"},decls:2,vars:2,consts:[[4,"ngIf"],["class","masonry",4,"ngIf"],["amount","3","colClass","col-4","blockHeight","250px","hasShadow","true"],[1,"masonry"],["class","grid py-3",4,"ngFor","ngForOf"],[1,"grid","py-3"],[3,"id"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"fw-bold","mb-0","table-title","mx-3"],[1,"d-flex","align-items-center","justify-content-between","action-btn"],["mat-icon-button","","color","primary","title","Add field or foreign key ...",3,"click"],[1,"me-1"],["mat-icon-button","","color","primary","title","Export table ...",3,"click"],["mat-icon-button","","color","warn","title","Drop table ...",3,"click"],["class","row hoverable-row py-1 align-items-center",4,"ngFor","ngForOf"],["class","mt-4 divider",4,"ngIf"],["class","row mt-4",4,"ngIf"],[1,"row","hoverable-row","py-1","align-items-center"],[1,"col-lg-6","col-5"],[1,"text-truncate","my-0","table-icons"],["title","Primary key",4,"ngIf"],["class","flipped text-muted","title","Nullable",4,"ngIf"],[1,"col-5"],[1,"small","text-muted","my-0"],[1,"col-lg-1","col-2","action-btn","d-flex","justify-content-end"],["mat-icon-button","","color","warn","title","Drop column ...",3,"click"],["title","Primary key"],["title","Nullable",1,"flipped","text-muted"],[1,"mt-4","divider"],[1,"row","mt-4"],["class","col-12 bg-light action-btn pointer py-0 small ps-3 py-1",3,"mb-2","click",4,"ngFor","ngForOf"],[1,"col-12","bg-light","action-btn","pointer","py-0","small","ps-3","py-1",3,"click"],[1,"d-flex","justify-content-between","align-items-center"],[1,"my-0","d-flex","justify-content-between","align-items-center","text-muted"],[1,"mx-2"],["class","col-12 bg-light action-btn py-0 small ps-3 py-1",3,"mb-2",4,"ngFor","ngForOf"],[1,"col-12","bg-light","action-btn","py-0","small","ps-3","py-1"],[4,"ngFor","ngForOf"],["mat-icon-button","","color","warn","title","Drop index ...",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,re,2,0,"ng-container",0),e.YNc(1,Te,3,3,"div",1)),2&t&&(e.Q6J("ngIf",n.dbLoading),e.xp6(1),e.Q6J("ngIf",!n.dbLoading))},dependencies:[i.sg,i.O5,j.J,N.Hw,m.lW,I.a8,I.dn,i.Ov],styles:[".action-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:18px;height:18px;line-height:18px}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:15px;height:15px;line-height:15px;font-size:15px}@keyframes flash{0%{background-color:#ffff80}to{background-color:#fff}}.active[_ngcontent-%COMP%]{animation-name:flash;animation-duration:2s}.masonry[_ngcontent-%COMP%]{width:100%;-webkit-column-gap:25px;-moz-column-count:3;-moz-column-gap:25px;column-count:3;column-gap:25px}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{page-break-inside:avoid;break-inside:avoid}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .hoverable-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-left:15px}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{border-top:solid 1px rgba(0,0,0,.1)}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:11px;word-break:break-all}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{max-width:80%;word-break:break-all}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .table-icons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;line-height:14px;margin-right:2px;vertical-align:bottom;position:absolute;left:18px}.masonry[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   .table-icons[_ngcontent-%COMP%]   mat-icon.flipped[_ngcontent-%COMP%]{transform:rotate(90deg)}@media (min-width: 680px) and (max-width: 1100px){.masonry[_ngcontent-%COMP%]{column-count:2}}@media (max-width: 679px){.masonry[_ngcontent-%COMP%]{column-count:1}}"]}),a})();var Ce=s(2168),xe=s(4327),ye=s(1172),Se=s(5746),we=s(7856),U=s(671),Me=s(59);let De=(()=>{class a{transform(t){return t.indexOf&&-1===t.indexOf("+")&&!t.endsWith("Z")&&(t+="+00:00"),new Date(t).toLocaleString()}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=e.Yjl({name:"date",type:a,pure:!0}),a})();function Ze(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-codemirror-sql",17),e.NdJ("modelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.input=o)}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("model",t.input)}}function Ae(a,r){if(1&a&&(e.TgZ(0,"th",32),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t," ")}}function qe(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const t=e.oxw().$implicit,n=e.oxw().$implicit;let o;e.xp6(1),e.hij(" ",null!==(o=t[n])&&void 0!==o?o:"[null]"," ")}}function ke(a,r){if(1&a&&(e._uU(0),e.ALo(1,"date")),2&a){const t=e.oxw().$implicit,n=e.oxw().$implicit;e.hij(" ",e.lcZ(1,1,t[n])," ")}}function Le(a,r){if(1&a&&(e.TgZ(0,"td",33),e.YNc(1,qe,2,1,"ng-container",34),e.YNc(2,ke,2,3,"ng-template",null,35,e.W1O),e.qZA()),2&a){const t=e.MAs(3),n=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","created"!==n)("ngIfElse",t)}}function Oe(a,r){1&a&&(e.ynx(0,29),e.YNc(1,Ae,2,1,"th",30),e.YNc(2,Le,4,2,"td",31),e.BQk()),2&a&&e.Q6J("matColumnDef",r.$implicit)}function Fe(a,r){1&a&&e._UZ(0,"tr",36)}function Ue(a,r){1&a&&e._UZ(0,"tr",37)}function Ee(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",19)(1,"mat-card",20)(2,"mat-card-content",21)(3,"div",22)(4,"table",23),e.YNc(5,Oe,3,1,"ng-container",24),e.YNc(6,Fe,1,0,"tr",25),e.YNc(7,Ue,1,0,"tr",26),e.qZA()(),e.TgZ(8,"div",27)(9,"button",28),e.NdJ("click",function(){const l=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.exportAsCsv(l))}),e._uU(10," Export as CSV "),e.qZA()()()()()}if(2&a){const t=r.$implicit,n=r.index,o=e.oxw(2);e.xp6(4),e.Q6J("dataSource",t),e.xp6(1),e.Q6J("ngForOf",o.displayedColumns[n]),e.xp6(1),e.Q6J("matHeaderRowDef",o.displayedColumns[n])("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns[n])}}function Je(a,r){if(1&a&&(e.ynx(0),e.YNc(1,Ee,11,5,"div",18),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.queryResult)}}let Ne=(()=>{class a{constructor(t,n,o,l){this.dialog=t,this.sqlService=n,this.generalService=o,this.codemirrorActionsService=l,this.selectedSnippet="",this.tablesList=null,this.selectedDatabase="",this.selectedDbType="",this.selectedConnectionString="",this.getDatabases=new e.vpe,this.input=null,this.queryResult=[],this.displayedColumns=[],this.executingSql=!1,this.safeMode=!0}ngOnInit(){this.codeMirrorInit(),this.watchForActions(),this.tableSubscription=this.hintTables.subscribe(t=>{this.tablesList=t,this.input&&(this.input.options.hintOptions={tables:this.tablesList})})}codeMirrorInit(){this.input={databaseType:this.selectedDatabase,connectionString:this.selectedConnectionString,database:this.selectedDatabase,options:this.getCodeMirrorOptions(),sql:""},this.input.options.hintOptions={tables:this.tablesList},this.input.options.autofocus=!0}loadSnippet(){this.dialog.open(ye.$,{width:"550px",data:this.selectedDbType}).afterClosed().subscribe(t=>{t&&(this.selectedSnippet=t,this.generalService.showLoading(),this.sqlService.loadSnippet(this.selectedDbType,t).subscribe({next:n=>{this.generalService.hideLoading(),this.input.sql=n},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}}))})}save(){this.input?.sql||""!==this.input.sql?this.dialog.open(Se.t,{width:"550px",data:this.selectedSnippet}).afterClosed().subscribe(t=>{t&&(this.generalService.showLoading(),this.sqlService.saveSnippet(this.selectedDbType,t,this.input.sql).subscribe({next:()=>{this.generalService.showFeedback("SQL snippet successfully saved.","successMessage"),this.selectedSnippet=t,this.generalService.hideLoading()},error:n=>{this.generalService.showFeedback(n?.error?.message??n,"errorMessage"),this.generalService.hideLoading()}}))}):this.generalService.showFeedback("Write some SQL first, then save it","errorMessage","Ok",5e3)}insertFromOpenAI(t){this.input.sql=t}execute(){if(this.input.sql||""!==this.input.sql){if(this.input&&this.input.editor){this.executingSql=!0;const t=this.input.editor.getSelection(),n=""==t?this.input.sql:t,o="mssql"===this.selectedDbType&&n.includes("go");this.generalService.showLoading(),this.sqlService.executeSql(this.selectedDbType,"["+this.selectedConnectionString+"|"+this.selectedDatabase+"]",n,this.safeMode,o).subscribe({next:l=>{if(l){let T=0;for(var u of l)T+=(u||[]).length;200===T?this.generalService.showFeedback("First 200 records returned. Turn off safe mode to return all records.","successMessage"):this.generalService.showFeedback(`${T} records returned`)}else this.generalService.showFeedback("SQL successfully executed, but returned no result","successMessage","Ok",5e3);this.queryResult=l||[],this.buildTable(),this.generalService.hideLoading(),this.executingSql=!1},error:l=>{this.executingSql=!1,this.generalService.hideLoading(),l.error&&l?.error?.message&&l?.error?.message&&-1!==l?.error?.message.toLowerCase().indexOf("incorrect syntax near 'go'")?this.generalService.showFeedback("Turn ON batch mode to execute this SQL","errorMessage","Ok",5e3):this.generalService.showFeedback(l?.error?.message??l,"errorMessage","Ok",5e3)}})}}else this.generalService.showFeedback("Write some SQL first, then execute it","errorMessage","Ok",5e3)}importSqlFile(t){this.sqlFile=t.target.files[0];let n=new FileReader;n.onload=o=>{this.input.sql=n.result},n.readAsText(this.sqlFile),this.sqlFile=""}exportAsCsv(t){let n="",o=!0;for(const u in t[0])o?o=!1:n+=",",n+=u;n+="\r\n";for(const u of t){let T=!0;for(const E in u)if(T?T=!1:n+=",","string"==typeof u[E]){for(var l=u[E];-1!==l.indexOf('"');)l=l.replace('"','""');n+='"'+l+'"'}else n+=u[E];n+="\r\n"}this.saveAsFile(n,"sql-export.csv","text/csv")}viewShortkeys(){this.dialog.open(Ce.r,{width:"900px",data:{type:["save","execute","insertSnippet"]}})}ngOnDestroy(){this.tableSubscription?.unsubscribe(),this.actionSubscription?.unsubscribe()}saveAsFile(t,n,o){const l=new Blob([t],{type:o});(0,xe.saveAs)(l,n)}buildTable(){this.queryResult&&this.queryResult.length>0&&(this.displayedColumns=[],this.queryResult.forEach((t,n)=>{this.displayedColumns[n]=Object.keys(t[0])}))}watchForActions(){this.actionSubscription=this.codemirrorActionsService.action.subscribe(t=>{switch(t){case"save":this.save();break;case"insertSnippet":this.loadSnippet();break;case"execute":this.execute()}})}getCodeMirrorOptions(){return this.codemirrorActionsService.getActions(null,"sql")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.uw),e.Y36(P.a),e.Y36(L.m),e.Y36(O.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-sql-view"]],inputs:{hintTables:"hintTables",selectedDatabase:"selectedDatabase",selectedDbType:"selectedDbType",selectedConnectionString:"selectedConnectionString"},outputs:{getDatabases:"getDatabases"},decls:28,vars:5,consts:[[1,"row","sql-editor"],[1,"col-12","sql-input"],[1,"h-100","py-3"],[1,"h-100","d-flex","flex-column","w-100"],[1,"d-flex","justify-content-between","align-items-center"],[1,"my-0","fw-bold"],["mat-button","","color","primary",1,"mat-caption",3,"click"],["labelPosition","before",1,"mat-caption",3,"ngModel","ngModelChange"],[1,"row","mt-3","mb-4","h-100"],[1,"col-12"],[4,"ngIf"],[1,"d-flex","justify-content-end","align-items-center"],["fileType","sql","callbackText","Use",1,"w-100",3,"callback"],["mat-button","","color","primary",3,"click"],["mat-flat-button","","color","primary",1,"px-4",3,"disabled","click"],["type","file","name","sqlFile","id","sqlFile","accept",".sql",1,"d-none",3,"ngModel","ngModelChange","change"],["sqlFileImport",""],[3,"model","modelChange"],["class","col-12 mt-3",4,"ngFor","ngForOf"],[1,"col-12","mt-3"],[1,"pt-3"],[1,"h-100","max-height-full"],[1,"table-responsive","w-100"],["mat-table","",1,"w-100","borderless","hoverable",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"text-end"],["mat-button","",3,"click"],[3,"matColumnDef"],["mat-header-cell","","class","ps-3 text-nowrap",4,"matHeaderCellDef"],["mat-cell","","class","ps-3 text-truncate",4,"matCellDef"],["mat-header-cell","",1,"ps-3","text-nowrap"],["mat-cell","",1,"ps-3","text-truncate"],[4,"ngIf","ngIfElse"],["dateColumn",""],["mat-header-row",""],["mat-row",""]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-content",3)(4,"div",4)(5,"h3",5),e._uU(6,"SQL"),e.qZA(),e.TgZ(7,"div")(8,"button",6),e.NdJ("click",function(){return n.viewShortkeys()}),e._uU(9," Shortkeys "),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){e.CHM(o);const u=e.MAs(26);return e.KtG(u.click())}),e._uU(11," Import "),e.qZA(),e.TgZ(12,"mat-slide-toggle",7),e.NdJ("ngModelChange",function(u){return n.safeMode=u}),e._uU(13," Safe mode "),e.qZA()()(),e.TgZ(14,"div",8)(15,"div",9),e.YNc(16,Ze,2,1,"ng-container",10),e.qZA()(),e.TgZ(17,"div",11)(18,"app-openai-prompt",12),e.NdJ("callback",function(u){return n.insertFromOpenAI(u)}),e.qZA(),e.TgZ(19,"button",13),e.NdJ("click",function(){return n.loadSnippet()}),e._uU(20," Snippets "),e.qZA(),e.TgZ(21,"button",13),e.NdJ("click",function(){return n.save()}),e._uU(22," Save "),e.qZA(),e.TgZ(23,"button",14),e.NdJ("click",function(){return n.execute()}),e._uU(24," Execute "),e.qZA(),e.TgZ(25,"input",15,16),e.NdJ("ngModelChange",function(u){return n.sqlFile=u})("change",function(u){return n.importSqlFile(u)}),e.qZA()()()()(),e.YNc(27,Je,2,1,"ng-container",10),e.qZA()}2&t&&(e.xp6(12),e.Q6J("ngModel",n.safeMode),e.xp6(4),e.Q6J("ngIf",null==n.input?null:n.input.options),e.xp6(7),e.Q6J("disabled",n.executingSql),e.xp6(2),e.Q6J("ngModel",n.sqlFile),e.xp6(2),e.Q6J("ngIf",n.queryResult&&n.queryResult.length>0))},dependencies:[i.sg,i.O5,we.j,m.lW,U.BZ,U.fO,U.as,U.w1,U.Dz,U.nj,U.ge,U.ev,U.XQ,U.Gk,I.a8,I.dn,B.Rr,g.Fj,g.JJ,g.On,Me.O,De],styles:[".sql-editor .sql-input{min-height:500px}  .sql-editor .sql-input .CodeMirror:not(.CodeMirror-fullscreen){height:100%}.table-responsive[_ngcontent-%COMP%]{max-height:50vh}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 6px #f5f5f5;-webkit-box-shadow:inset 0 0 6px #f5f5f5;background-color:#f5f5f5}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px;background-color:#f5f5f5}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#bdbdbd;border-radius:10px}.table-responsive[_ngcontent-%COMP%]   .text-truncate[_ngcontent-%COMP%]{max-width:25vw}"]}),a})();var Ie=s(4428);function Qe(a,r){1&a&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",21),e.BQk())}function Pe(a,r){if(1&a&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t.type),e.xp6(1),e.Oqu(t.name)}}function Re(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",22)(1,"span",23)(2,"mat-icon"),e._uU(3,"database"),e.qZA(),e.TgZ(4,"span",24),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"mat-select",25),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedDbType=o)})("selectionChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getConnectionStrings(o.selectedDbType))}),e.YNc(7,Pe,2,2,"mat-option",26),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.selectedDbType),e.xp6(1),e.Q6J("ngForOf",t.databaseTypes)}}function Ve(a,r){1&a&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",21),e.BQk())}function Ye(a,r){if(1&a&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t.key),e.xp6(1),e.Oqu(t.key)}}function je(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",22)(1,"span",23)(2,"mat-icon"),e._uU(3,"conversion_path"),e.qZA(),e.TgZ(4,"span",24),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"mat-select",28),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedConnectionString=o)})("selectionChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getDatabases(o.selectedDbType,o.selectedConnectionString))}),e.YNc(7,Ye,2,2,"mat-option",26),e.ALo(8,"keyvalue"),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.selectedConnectionString),e.xp6(1),e.Q6J("ngForOf",e.lcZ(8,2,t.connectionStrings))}}function Be(a,r){1&a&&(e.ynx(0),e._UZ(1,"app-loading-skeleton",21),e.BQk())}function Ke(a,r){if(1&a&&(e.TgZ(0,"mat-option",27),e._uU(1),e.TgZ(2,"span",30),e._uU(3),e.qZA()()),2&a){const t=r.$implicit;let n;e.Q6J("value",t.name),e.xp6(1),e.hij("",t.name," "),e.xp6(2),e.hij("",null!==(n=null==t||null==t.tables?null:t.tables.length)&&void 0!==n?n:0," table(s)")}}function We(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-form-field",22)(1,"span",23)(2,"mat-icon"),e._uU(3,"database"),e.qZA(),e.TgZ(4,"span",24),e._uU(5,"|"),e.qZA()(),e.TgZ(6,"mat-select",29),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedDatabase=o)})("selectionChange",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.changeDatabase())}),e.YNc(7,Ke,4,3,"mat-option",26),e.ALo(8,"sortBy"),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.selectedDatabase),e.xp6(1),e.Q6J("ngForOf",e.xi3(8,2,t.databases,"name"))}}function He(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"app-tables-view",31),e.NdJ("getDatabases",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.getDatabases(o))}),e.ALo(1,"async"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("migrate",t.migrate)("dbLoading",e.lcZ(1,7,t.dbLoading))("tables",t.tables)("databases",t.databases)("selectedDatabase",t.selectedDatabase)("selectedDbType",t.selectedDbType)("selectedConnectionString",t.selectedConnectionString)}}function ze(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"app-sql-view",32),e.NdJ("getDatabases",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.getDatabases(o))}),e.ALo(1,"async"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("dbLoading",e.lcZ(1,6,t.dbLoading))("hintTables",t.hintTables)("databases",t.databases)("selectedDatabase",t.selectedDatabase)("selectedDbType",t.selectedDbType)("selectedConnectionString",t.selectedConnectionString)}}const $e=[{path:"",component:(()=>{class a{constructor(t,n,o,l,u){this.dialog=t,this.sqlService=n,this.cacheService=o,this.activatedRoute=l,this.generalService=u,this._tables=new w.t,this._hintTables=new w.t,this._dbLoading=new w.t,this.databaseTypes=[]=[{type:"sqlite",name:"SQLite"},{type:"mysql",name:"MySQL"},{type:"mssql",name:"SQL Server"},{type:"pgsql",name:"PostgreSQL"}],this.selectedDbType="",this.migrate=!1,this.connectionStrings=[],this.selectedConnectionString="",this.databases=[],this.selectedDatabase="",this.sqlView=!1,this.tables=this._tables.asObservable(),this.hintTables=this._hintTables.asObservable(),this.dbLoading=this._dbLoading.asObservable()}ngOnInit(){this.activatedRoute.queryParams.subscribe(t=>{this.selectedConnectionString=t.dbCString??"generic",this.selectedDatabase=t.dbName??"magic",this._dbLoading.next(!0),this.generalService.showLoading(),this.sqlService.defaultDatabaseType().subscribe({next:n=>{this.databaseTypes=this.databaseTypes.filter(o=>n.options.includes(o.type)),this.selectedDbType=t.dbType??n.default,this.getConnectionStrings(this.selectedDbType,this.selectedConnectionString)},error:n=>{this.generalService.hideLoading(),this.generalService.showFeedback(n?.error?.message??n,"errorMessage")}})})}getConnectionStrings(t,n){this._dbLoading.next(!0),this.selectedDbType=t,this.connectionStrings=[],this.selectedConnectionString=n??"",this.sqlService.connectionStrings(t).subscribe({next:o=>{this.connectionStrings=o,o?(this.selectedConnectionString=n||(Object.keys(o).indexOf("generic")>-1?"generic":Object.keys(o)[0]),this.getDatabases()):(this._dbLoading.next(!1),this.generalService.hideLoading(),this.databases=[],this._tables.next([]),this._hintTables.next({}))},error:o=>{this.generalService.hideLoading(),this.generalService.showFeedback(o?.error?.message??o,"errorMessage")}})}getDatabases(){this.generalService.showLoading(),this.databases=[],this.sqlService.getDatabaseMetaInfo(this.selectedDbType,this.selectedConnectionString).subscribe({next:t=>{this.databases=t.databases||[],""===this.selectedDatabase&&(this.selectedDatabase=this.databases[0].name);const n=this.databases.find(l=>l.name===this.selectedDatabase)?.tables||[];this._tables.next(n);let o=this.databases.find(l=>l.name===this.selectedDatabase)?.tables||[];o=o.map(l=>[l.name,l.columns.map(u=>u.name)]),this._hintTables.next(Object.fromEntries(o)),this._dbLoading.next(!1),this.generalService.hideLoading()},error:t=>{this._dbLoading.next(!1),this.generalService.hideLoading(),this.generalService.showFeedback(t?.error?.message,"errorMessage","Ok",5e3)}})}addNewTable(){this.dialog.open(H,{width:"500px"}).afterClosed().subscribe(t=>{t&&this.sqlService.addTable(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,t.name,t.pkName,t.pkType,t.pkLength,t.pkDefault).subscribe({next:n=>{this.generalService.showFeedback("Table successfully added","successMessage"),this.getDatabases(),this.applyMigration(n.sql)},error:n=>this.generalService.showFeedback(n?.error?.message??n,"errorMessage","Ok",4e3)})})}createNewLinkTable(){const t=this.databases.find(n=>n.name===this.selectedDatabase).tables||[];0!==t.length?this.dialog.open(Q,{width:"500px",data:t}).afterClosed().subscribe(n=>{if(n){const o=n.table1.columns.filter(T=>T.primary),l=n.table2.columns.filter(T=>T.primary),u={name:n.table1.name.replace(".","_")+"_"+n.table2.name.replace(".","_"),table1:n.table1.name,table2:n.table2.name,table1pk:o.map(T=>({type:T.db,name:T.name})),table2pk:l.map(T=>({type:T.db,name:T.name}))};this.sqlService.addLinkTable(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,u).subscribe({next:T=>{this.generalService.showFeedback("Link table successfully created","successMessage"),this.getDatabases(),this.applyMigration(T.sql)},error:T=>this.generalService.showFeedback(T?.error?.message??T,"errorMessage","Ok",5e3)})}}):this.generalService.showFeedback("This database doesn't have tables.","errorMessage")}viewDatabaseDDL(){if(""===this.selectedDatabase)return;if("mssql"===this.selectedDbType)return void this.generalService.showFeedback("SQL Server does not allow us to easily view DDL");let t=this.databases.find(n=>n.name===this.selectedDatabase).tables||[];0!==t.length?(t=t.sort((n,o)=>n.foreign_keys?.filter(l=>l.foreign_table===o.name)?1:o.foreign_keys?.filter(l=>l.foreign_table===n.name)?-1:0),this.sqlService.exportDdl(this.selectedDbType,this.selectedConnectionString,this.selectedDatabase,t.map(n=>n.name),!0).subscribe({next:n=>{this.dialog.open(F,{width:"80vw",panelClass:"light",data:{result:n.result,full:!0,module:this.selectedDatabase}}).afterClosed().subscribe(l=>{l&&this.sqlService.exportToModule(this.selectedDbType,this.selectedDatabase,l.result).subscribe({next:()=>{this.generalService.showFeedback("Database successfully exported","successMessage")},error:u=>this.generalService.showFeedback(u?.error?.message??u,"errorMessage","Ok",5e3)})})},error:n=>this.generalService.showFeedback(n?.error?.message??n,"errorMessage","Ok",5e3)})):this.generalService.showFeedback("This database doesn't have tables.")}changeDatabase(){const t=this.databases.find(o=>o.name===this.selectedDatabase)?.tables||[];this._tables.next(t);let n=this.databases.find(o=>o.name===this.selectedDatabase)?.tables||[];n=n.map(o=>[o.name,o.columns.map(l=>l.name)]),this._hintTables.next(Object.fromEntries(n))}clearServerCache(){this.generalService.showLoading(),this.cacheService.delete("magic.sql.databases.*").subscribe({next:()=>{window.location.href=window.location.href,this.generalService.hideLoading()},error:t=>{this.generalService.hideLoading(),this.generalService.showFeedback(t?.error?.message??t,"errorMessage","Ok",5e3)}})}applyMigration(t){!this.migrate||this.dialog.open(v,{width:"80vw",data:{sql:t}}).afterClosed().subscribe(n=>{n&&this.sqlService.createMigrationScript(this.selectedDbType,this.selectedDatabase,t).subscribe({next:()=>this.generalService.showFeedback("Migration script successfully applied"),error:o=>this.generalService.showFeedback(o?.error?.message??o,"errorMessage","Ok",5e3)})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.uw),e.Y36(P.a),e.Y36($.Q),e.Y36(M.gz),e.Y36(L.m))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-sql-studio"]],decls:50,vars:48,consts:[[1,"py-3"],[1,"row","align-items-stretch"],[1,"col-lg-auto","col-12","align-self-center"],[1,"fw-bold","mb-lg-0"],[1,"col-md","col-sm-6","col-12"],[4,"ngIf"],["class","w-100 standalone-field mb-lg-0 mb-2",4,"ngIf"],[1,"col","align-self-center"],[1,"d-flex","justify-content-end","flex-sm-nowrap","flex-wrap","mt-xl-0","mt-3"],["mat-button","","color","primary",1,"mat-caption",3,"disabled","click"],["mat-button","","color","primary",1,"mat-caption",3,"disabled","matMenuTriggerFor"],["mat-button","","color","primary",1,"mat-caption",3,"click"],["menu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"click"],[1,"m-3"],["labelPosition","before",3,"disabled","ngModel","ngModelChange"],[1,"row","mt-4"],[1,"col-12"],[3,"migrate","dbLoading","tables","databases","selectedDatabase","selectedDbType","selectedConnectionString","getDatabases",4,"ngIf"],[3,"dbLoading","hintTables","databases","selectedDatabase","selectedDbType","selectedConnectionString","getDatabases",4,"ngIf"],["amount","1","colClass","col-12","blockHeight","45px","hasShadow","false"],[1,"w-100","standalone-field","mb-lg-0","mb-2"],["matPrefix","",1,"d-flex","flex-nowrap","align-items-center","justify-content-between","me-2"],[1,"text-muted"],["placeholder","Database type",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","Connection string",3,"ngModel","ngModelChange","selectionChange"],["placeholder","Databases",3,"ngModel","ngModelChange","selectionChange"],[1,"ms-2","mat-caption","text-muted"],[3,"migrate","dbLoading","tables","databases","selectedDatabase","selectedDbType","selectedConnectionString","getDatabases"],[3,"dbLoading","hintTables","databases","selectedDatabase","selectedDbType","selectedConnectionString","getDatabases"]],template:function(t,n){if(1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-content")(2,"div",1)(3,"div",2)(4,"p",3),e._uU(5,"Select a database"),e.qZA()(),e.TgZ(6,"div",4),e.ALo(7,"async"),e.YNc(8,Qe,2,0,"ng-container",5),e.ALo(9,"async"),e.YNc(10,Re,8,2,"mat-form-field",6),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"div",4),e.ALo(13,"async"),e.YNc(14,Ve,2,0,"ng-container",5),e.ALo(15,"async"),e.YNc(16,je,9,4,"mat-form-field",6),e.ALo(17,"async"),e.qZA(),e.TgZ(18,"div",4),e.ALo(19,"async"),e.YNc(20,Be,2,0,"ng-container",5),e.ALo(21,"async"),e.YNc(22,We,9,5,"mat-form-field",6),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"div",7)(25,"div",8)(26,"button",9),e.NdJ("click",function(){return n.addNewTable()}),e.ALo(27,"async"),e._uU(28," New table "),e.qZA(),e.TgZ(29,"button",9),e.NdJ("click",function(){return n.createNewLinkTable()}),e.ALo(30,"async"),e._uU(31," Link table "),e.qZA(),e.TgZ(32,"button",10),e.ALo(33,"async"),e._uU(34," More "),e.qZA(),e.TgZ(35,"button",11),e.NdJ("click",function(){return n.sqlView=!n.sqlView}),e._uU(36),e.qZA(),e.TgZ(37,"mat-menu",null,12)(39,"button",13),e.NdJ("click",function(){return n.viewDatabaseDDL()}),e._uU(40," Database DDL "),e.qZA(),e.TgZ(41,"button",14),e.NdJ("click",function(){return n.clearServerCache()}),e._uU(42," Clear server cache "),e.qZA(),e.TgZ(43,"div",15)(44,"mat-slide-toggle",16),e.NdJ("ngModelChange",function(l){return n.migrate=l}),e._uU(45," Auto migrate "),e.qZA()()()()()()()(),e.TgZ(46,"div",17)(47,"div",18),e.YNc(48,He,2,9,"app-tables-view",19),e.YNc(49,ze,2,8,"app-sql-view",20),e.qZA()()),2&t){const o=e.MAs(38);e.xp6(6),e.ekj("col-md-3",e.lcZ(7,24,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,26,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(11,28,n.dbLoading)),e.xp6(2),e.ekj("col-md-2",e.lcZ(13,30,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(15,32,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(17,34,n.dbLoading)),e.xp6(2),e.ekj("col-md-2",e.lcZ(19,36,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",e.lcZ(21,38,n.dbLoading)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(23,40,n.dbLoading)),e.xp6(4),e.Q6J("disabled",n.sqlView)("disabled",e.lcZ(27,42,n.dbLoading)||n.sqlView),e.xp6(3),e.Q6J("disabled",n.sqlView)("disabled",e.lcZ(30,44,n.dbLoading)||n.sqlView),e.xp6(3),e.Q6J("disabled",e.lcZ(33,46,n.dbLoading))("matMenuTriggerFor",o),e.xp6(4),e.hij(" ",n.sqlView?"Table view":"SQL view"," "),e.xp6(3),e.Q6J("disabled",n.sqlView),e.xp6(5),e.Q6J("disabled",n.sqlView)("ngModel",n.migrate),e.xp6(4),e.Q6J("ngIf",!1===n.sqlView),e.xp6(1),e.Q6J("ngIf",!0===n.sqlView)}},dependencies:[i.sg,i.O5,j.J,N.Hw,m.lW,p.KE,p.qo,R.VK,R.OP,R.p6,Z.gD,_.ey,I.a8,I.dn,B.Rr,g.JJ,g.On,ve,Ne,i.Ov,i.Nd,Ie.W],encapsulation:2}),a})()}];let Ge=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[M.Bz.forChild($e),M.Bz]}),a})(),Xe=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[i.ez,Ge,f.K,A.q,c.k,g.u5,h.m,y.h]}),a})()},4327:function(J,k){var g;void 0!==(g=function(){"use strict";function y(d,e,m){var p=new XMLHttpRequest;p.open("GET",d),p.responseType="blob",p.onload=function(){w(p.response,e,m)},p.onerror=function(){console.error("could not download file")},p.send()}function A(d){var e=new XMLHttpRequest;e.open("HEAD",d,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function h(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(e)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,M=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),w=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!M?function(d,e,m){var p=f.URL||f.webkitURL,b=document.createElement("a");b.download=e=e||d.name||"download",b.rel="noopener","string"==typeof d?(b.href=d,b.origin===location.origin?h(b):A(b.href)?y(d,e,m):h(b,b.target="_blank")):(b.href=p.createObjectURL(d),setTimeout(function(){p.revokeObjectURL(b.href)},4e4),setTimeout(function(){h(b)},0))}:"msSaveOrOpenBlob"in navigator?function(d,e,m){if(e=e||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function c(d,e){return typeof e>"u"?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,m),e);else if(A(d))y(d,e,m);else{var p=document.createElement("a");p.href=d,p.target="_blank",setTimeout(function(){h(p)})}}:function(d,e,m,p){if((p=p||open("","_blank"))&&(p.document.title=p.document.body.innerText="downloading..."),"string"==typeof d)return y(d,e,m);var b="application/octet-stream"===d.type,v=/constructor/i.test(f.HTMLElement)||f.safari,O=/CriOS\/[\d]+/.test(navigator.userAgent);if((O||b&&v||M)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var L=x.result;L=O?L:L.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=L:location=L,p=null},x.readAsDataURL(d)}else{var S=f.URL||f.webkitURL,F=S.createObjectURL(d);p?p.location=F:location.href=F,p=null,setTimeout(function(){S.revokeObjectURL(F)},4e4)}});f.saveAs=w.saveAs=w,J.exports=w}.apply(k,[]))&&(J.exports=g)}}]);